<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>表格选中添加背景色</title>
    <link href="/2022/11/28/2022/2022-11/%E8%A1%A8%E6%A0%BC%E9%80%89%E4%B8%AD%E6%B7%BB%E5%8A%A0%E8%83%8C%E6%99%AF%E8%89%B2/"/>
    <url>/2022/11/28/2022/2022-11/%E8%A1%A8%E6%A0%BC%E9%80%89%E4%B8%AD%E6%B7%BB%E5%8A%A0%E8%83%8C%E6%99%AF%E8%89%B2/</url>
    
    <content type="html"><![CDATA[<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><pre><code>   今天有个小伙伴问我一个需求，迭代需要给表格点击项单元格添加背景色功能。vue + element架构。   了解了一下，他的想法当是当点击某个单元格的时候，获取当前 dom ，添加样式。后来写了很多代码，实现效果不好，添加和移除的时候不太行。   听完他的设计方案，我想的是功能不难做，只是小伙伴掉入了他自己的思想误区。     </code></pre><h2 id="实现方案"><a href="#实现方案" class="headerlink" title="实现方案"></a>实现方案</h2><ol><li>首先 Vue MVVM设计模式，本身是以数据驱动视图的实现方式，我们只需要关心数据的逻辑处理，数据的变化就能够自然的通知页面进行页面的重新渲染。</li><li>那么功能就很好做了，element table 组件排列是有对应的 row/column数据，利用slot 获取信息 </li><li>单击某个单元格 。获取点击的对应单元格的 xy信息，与之比对，true/false 添加样式/移除</li></ol><h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs typescript">&lt;el-table<br>            :data=<span class="hljs-string">&quot;tableData&quot;</span><br>            <span class="hljs-meta">@cell</span>-click=<span class="hljs-string">&quot;handler&quot;</span><br>            border<br>            style=<span class="hljs-string">&quot;width: 100%&quot;</span><br>        &gt;<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">&quot;date&quot;</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;日期&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;180&quot;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">slot-scope</span>=<span class="hljs-string">&quot;scope&quot;</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><br><span class="hljs-tag"><span class="language-xml">                        <span class="hljs-attr">:class</span>=<span class="hljs-string">&quot;</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                            scope.$index === xIndex &amp;&amp;</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                            scope.column.index === yIndex</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                                ? &#x27;bg&#x27;</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                                : &#x27;&#x27;</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                        &quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    &gt;</span></span><br><span class="language-xml">                        &#123;&#123; scope.row.date &#125;&#125;</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">el-table-column</span>&gt;</span></span><br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;姓名&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;180&quot;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">slot-scope</span>=<span class="hljs-string">&quot;scope&quot;</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><br><span class="hljs-tag"><span class="language-xml">                        <span class="hljs-attr">:class</span>=<span class="hljs-string">&quot;</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                            scope.$index === xIndex &amp;&amp;</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                            scope.column.index === yIndex</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                                ? &#x27;bg&#x27;</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                                : &#x27;&#x27;</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                        &quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    &gt;</span></span><br><span class="language-xml">                        &#123;&#123; scope.row.name &#125;&#125;</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">el-table-column</span>&gt;</span></span><br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">&quot;address&quot;</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;地址&quot;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">slot-scope</span>=<span class="hljs-string">&quot;scope&quot;</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><br><span class="hljs-tag"><span class="language-xml">                        <span class="hljs-attr">:class</span>=<span class="hljs-string">&quot;</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                            scope.$index === xIndex &amp;&amp;</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                            scope.column.index === yIndex</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                                ? &#x27;bg&#x27;</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                                : &#x27;&#x27;</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                        &quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    &gt;</span></span><br><span class="language-xml">                        &#123;&#123; scope.row.address &#125;&#125;</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">el-table-column</span>&gt;</span></span><br>        &lt;/el-table&gt;<br><br> <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> &#123;<br>            <span class="hljs-attr">tableData</span>: [<br>                &#123;<br>                    <span class="hljs-attr">date</span>: <span class="hljs-string">&#x27;2016-05-02&#x27;</span>,<br>                    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;王小虎&#x27;</span>,<br>                    <span class="hljs-attr">address</span>: <span class="hljs-string">&#x27;上海市普陀区金沙江路 1518 弄&#x27;</span>,<br>                &#125;,<br>                &#123;<br>                    <span class="hljs-attr">date</span>: <span class="hljs-string">&#x27;2016-05-04&#x27;</span>,<br>                    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;王小虎&#x27;</span>,<br>                    <span class="hljs-attr">address</span>: <span class="hljs-string">&#x27;上海市普陀区金沙江路 1517 弄&#x27;</span>,<br>                &#125;,<br>                &#123;<br>                    <span class="hljs-attr">date</span>: <span class="hljs-string">&#x27;2016-05-01&#x27;</span>,<br>                    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;王小虎&#x27;</span>,<br>                    <span class="hljs-attr">address</span>: <span class="hljs-string">&#x27;上海市普陀区金沙江路 1519 弄&#x27;</span>,<br>                &#125;,<br>                &#123;<br>                    <span class="hljs-attr">date</span>: <span class="hljs-string">&#x27;2016-05-03&#x27;</span>,<br>                    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;王小虎&#x27;</span>,<br>                    <span class="hljs-attr">address</span>: <span class="hljs-string">&#x27;上海市普陀区金沙江路 1516 弄&#x27;</span>,<br>                &#125;,<br>            ],<br>            <span class="hljs-attr">xIndex</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>            <span class="hljs-attr">yIndex</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>        &#125;;<br>    &#125;,<br><span class="hljs-attr">methods</span>: &#123;<br>        <span class="hljs-title function_">handler</span>(<span class="hljs-params">row, column, cell, event</span>) &#123;<br>   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(row[column.<span class="hljs-property">property</span>], row);<br>   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(row[column.<span class="hljs-property">property</span>], column);<br>   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(row[column.<span class="hljs-property">property</span>], cell);<br>   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(row[column.<span class="hljs-property">property</span>], event);<br>        &#125;,<br>       <br>    &#125;,<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> &gt;</span><span class="language-css"></span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.bg</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">background-color</span>: orange;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p><img src="/img/2022/bjs_1.png" alt="bjs_2"></p><h6 id="打印的四个数据中后两个是节点信息"><a href="#打印的四个数据中后两个是节点信息" class="headerlink" title="打印的四个数据中后两个是节点信息"></a>打印的四个数据中后两个是节点信息</h6><p><img src="/img/2022/bjs_2.png" alt="bjs_2"><br><img src="/img/2022/bjs_3.png" alt="bjs_2"></p><h6 id="前两个是我们需要用的信息-并且有cloSpan-rowSpan-这是不是需要用的数据，仔细看并不难发现不是响应值，并且值都一样这里面好像没有用的数据"><a href="#前两个是我们需要用的信息-并且有cloSpan-rowSpan-这是不是需要用的数据，仔细看并不难发现不是响应值，并且值都一样这里面好像没有用的数据" class="headerlink" title="前两个是我们需要用的信息 并且有cloSpan/rowSpan 这是不是需要用的数据，仔细看并不难发现不是响应值，并且值都一样这里面好像没有用的数据"></a>前两个是我们需要用的信息 并且有cloSpan/rowSpan 这是不是需要用的数据，仔细看并不难发现不是响应值，并且值都一样这里面好像没有用的数据</h6><h2 id="第三步，单击某个单元格-。获取点击的对应单元格的-xy信息-并不能直接获取到，"><a href="#第三步，单击某个单元格-。获取点击的对应单元格的-xy信息-并不能直接获取到，" class="headerlink" title="第三步，单击某个单元格 。获取点击的对应单元格的 xy信息 并不能直接获取到，"></a>第三步，单击某个单元格 。获取点击的对应单元格的 xy信息 并不能直接获取到，</h2><ol><li>怎么获取table 索引 x/y数据<br><img src="/img/2022/bjs_4.png" alt="bjs_2"><br>table提供了这个可以获取组件rowIndex/columnIndex <figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">&lt;el-<span class="hljs-keyword">table</span><br>    :data=&quot;tableData&quot;<br>    @cell-click=&quot;handler&quot;<br>    border<br>    style=&quot;width: 100%&quot;<br>  :cell-<span class="hljs-keyword">class</span>-<span class="hljs-type">name</span>=&quot;className&quot;<br>&gt;<br><br><br> <span class="hljs-keyword">handler</span>(<span class="hljs-keyword">row</span>, <span class="hljs-keyword">column</span>, cell, event) &#123;<br>            this.xIndex = <span class="hljs-keyword">row</span>.<span class="hljs-keyword">index</span>;<br>            this.yIndex = <span class="hljs-keyword">column</span>.<span class="hljs-keyword">index</span>;<br>        &#125;,<br> className(&#123; <span class="hljs-keyword">row</span>, <span class="hljs-keyword">column</span>, rowIndex, columnIndex &#125;) &#123;<br>            console.log(<br>                <span class="hljs-keyword">row</span>[<span class="hljs-keyword">column</span>.property],<br>                <span class="hljs-keyword">row</span>,<br>                <span class="hljs-keyword">column</span>,<br>                rowIndex,<br>                columnIndex<br>            );<br>  // 将获取到的x/y 数据信息存储<br>            <span class="hljs-keyword">row</span>.<span class="hljs-keyword">index</span> = rowIndex;<br>            <span class="hljs-keyword">column</span>.<span class="hljs-keyword">index</span> = columnIndex;<br>        &#125;,<br><br></code></pre></td></tr></table></figure><img src="/img/2022/bjs_5.png" alt="bjs_2"><h2 id="点击背景色加上。功能实现"><a href="#点击背景色加上。功能实现" class="headerlink" title="点击背景色加上。功能实现"></a>点击背景色加上。功能实现</h2><img src="/img/2022/bjs_6.png" alt="bjs_2"></li></ol>]]></content>
    
    
    <categories>
      
      <category>vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Element</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>小程序、公众号、视频号跳转</title>
    <link href="/2022/10/28/2022/2022-10/10-28%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%B7%B3%E8%BD%AC%E5%85%AC%E4%BC%97%E5%8F%B7%E8%A7%86%E9%A2%91%E5%8F%B7/"/>
    <url>/2022/10/28/2022/2022-10/10-28%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%B7%B3%E8%BD%AC%E5%85%AC%E4%BC%97%E5%8F%B7%E8%A7%86%E9%A2%91%E5%8F%B7/</url>
    
    <content type="html"><![CDATA[<h3 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h3><p>小程序开发过程中，难免会需要一些扩展功能。记录一下 小程序中，使用跳转到公众号、视频号的功能。</p><h4 id="小程序中跳转到相关微信公众号"><a href="#小程序中跳转到相关微信公众号" class="headerlink" title="小程序中跳转到相关微信公众号"></a>小程序中跳转到相关微信公众号</h4><ol><li> 首先在后台登陆 <a href="https://mp.weixin.qq.com/">微信公众平台</a> 选择进行开发的公众号进入</li><li> 在左侧菜单里点击进入小程序管理画面</li><li> 直接点击关联小程序即可，如果关联过其他小程序点击添加即可（该操作可由公众号管理员权限完成）</li><li> 退出重新登陆 选择进行开发的小程序进入</li><li> 在左侧菜单里点击 设置 进入</li><li> 选择关注公众号，关注公众号，可通过公众号的名字关联。</li></ol><p>在小程序组件代码 可以使用 <a href="https://developers.weixin.qq.com/miniprogram/dev/component/web-view.html">web-view</a> 打开<br>这个路径可以是公众号引导文章，也可以直接是公众号的地址，</p><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cos">&lt;web-<span class="hljs-keyword">view</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;page_c&quot;</span> :src=<span class="hljs-string">&quot;path&quot;</span>  &gt;&lt;/web-<span class="hljs-keyword">view</span>&gt;<br></code></pre></td></tr></table></figure><h4 id="小程序中打开相关视频号链接数据"><a href="#小程序中打开相关视频号链接数据" class="headerlink" title="小程序中打开相关视频号链接数据"></a>小程序中打开相关视频号链接数据</h4><p>打开<a href="https://channels.weixin.qq.com/platform/login">视频号助手</a> 进行视频号认证 （企业认证）视频号的相关流程略过</p><p>在小程序组件代码 使用 相关对应 api 进行触发 <a href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/channels/wx.openChannelsUserProfile.html">微信开放文档-视频号</a> 打开小程序关联视频号</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">wx.<span class="hljs-keyword">open</span><span class="hljs-constructor">ChannelsUserProfile(Object <span class="hljs-params">object</span>)</span> <span class="hljs-comment">// 打开视频号主页</span><br> wx.<span class="hljs-keyword">open</span><span class="hljs-constructor">ChannelsLive(Object <span class="hljs-params">object</span>)</span> <span class="hljs-comment">// 打开视频号直播</span><br> wx.<span class="hljs-keyword">open</span><span class="hljs-constructor">ChannelsActivity(Object <span class="hljs-params">object</span>)</span> <span class="hljs-comment">// 打开某条视频</span><br></code></pre></td></tr></table></figure><p>将小程序、公众号、视频号相互关联认证 就可以进行对应的打开</p><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原生</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>element表格简易封装</title>
    <link href="/2022/09/22/2022/2022-09/09-22%E8%A1%A8%E6%A0%BC%E7%AE%80%E6%98%93%E5%B0%81%E8%A3%85/"/>
    <url>/2022/09/22/2022/2022-09/09-22%E8%A1%A8%E6%A0%BC%E7%AE%80%E6%98%93%E5%B0%81%E8%A3%85/</url>
    
    <content type="html"><![CDATA[<h3 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h3><p>实现 table 表格的简单封装 带操作栏的（slot）、可多选的表格 <a href="https://v2.cn.vuejs.org/v2/api/#slot">slot</a><br><img src="/img/2022_bg1.png"></p><h4 id="封装组件"><a href="#封装组件" class="headerlink" title="封装组件"></a>封装组件</h4><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">ez-table</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;tab-ml-30&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">:header-cell-style</span>=<span class="hljs-string">&quot;&#123; background: &#x27;#F8F8F8&#x27; &#125;&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">:data</span>=<span class="hljs-string">&quot;tabData&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;tableData&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 100%&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">max-height</span>=<span class="hljs-string">&quot;400&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            @<span class="hljs-attr">selection-change</span>=<span class="hljs-string">&quot;handleSelectionChange&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        &gt;</span></span><br><span class="language-xml">            &gt;</span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">ez-table-column</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;indexShow&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;序号&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;index&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;50&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            &gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">ez-table-column</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">ez-table-column</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;selShow&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;selection&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">:selectable</span>=<span class="hljs-string">&quot;selectTabFn&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;50&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            &gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">ez-table-column</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">ez-table-column</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;operateShow&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;操作&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;200&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            &gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">slot-scope</span>=<span class="hljs-string">&quot;scope&quot;</span>&gt;</span></span><br><span class="language-xml">   //默认插槽展示operate</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">v-bind</span>=<span class="hljs-string">&quot;scope&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">ez-table-column</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;(item, index) in titles&quot;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ez-table-column</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;item.stacks&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">:label</span>=<span class="hljs-string">&quot;item.label&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;&#x27;GTba&#x27; + index&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                &gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;(child, childIndex) in item.stacks&quot;</span>&gt;</span></span><br><span class="language-xml">                        <span class="hljs-tag">&lt;<span class="hljs-name">ez-table-column</span></span></span><br><span class="hljs-tag"><span class="language-xml">                            <span class="hljs-attr">:prop</span>=<span class="hljs-string">&quot;child.prop&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                            <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                            <span class="hljs-attr">show-overflow-tooltip</span></span></span><br><span class="hljs-tag"><span class="language-xml">                            <span class="hljs-attr">:width</span>=<span class="hljs-string">&quot;child.width || &#x27;&#x27;&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                            <span class="hljs-attr">:label</span>=<span class="hljs-string">&quot;child.label&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                            <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;&#x27;GTbaChild&#x27; + childIndex&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                        &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ez-table-column</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">ez-table-column</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ez-table-column</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">v-else</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">:prop</span>=<span class="hljs-string">&quot;item.prop&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">show-overflow-tooltip</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">:width</span>=<span class="hljs-string">&quot;item.width || &#x27;&#x27;&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">:label</span>=<span class="hljs-string">&quot;item.label&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;&#x27;GTba&#x27; + index&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                &gt;</span></span><br><span class="language-xml">   //具名插槽用来展示自定义项数据</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">slot-scope</span>=<span class="hljs-string">&quot;scope&quot;</span>&gt;</span></span><br><span class="language-xml">                        <span class="hljs-tag">&lt;<span class="hljs-name">slot</span></span></span><br><span class="hljs-tag"><span class="language-xml">                            <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;item.deal&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                            <span class="hljs-attr">:name</span>=<span class="hljs-string">&quot;item.prop&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                            <span class="hljs-attr">v-bind</span>=<span class="hljs-string">&quot;scope&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                        &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span></span><br><span class="language-xml">                        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-else</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">scope.row</span>[item.prop] &#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">ez-table-column</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">ez-table</span>&gt;</span></span><br><span class="language-xml">        // 因为更利于复用组件 将页码进行了封装</span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">Pagination</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;pageInfo.totalCount &amp;&amp; pageShow&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            @<span class="hljs-attr">onPageChange</span>=<span class="hljs-string">&quot;onPageChange&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            @<span class="hljs-attr">onSizeChange</span>=<span class="hljs-string">&quot;onSizeChange&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">:pageInfo</span>=<span class="hljs-string">&quot;pageInfo&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Pagination</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-comment">/**</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">     * pageInfo 页码 pageNum页数  pageSize 数量 totalCount 总数</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">     * pageShow  页码显示</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">     * tabData 表格数据</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">     * titles 表头依赖数据  label名字 prop显示源 stacks 二级表头数据</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">     * operateShow 是否需要操作栏 // 这边也可以用$slots.default 做判断</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">     * selShow 多选</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">     * selFnShow 是否添加 某项是否可选择</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">     * <span class="hljs-doctag">@selectTabFn</span>  selections 过滤 需要在父组件配置 返回fasle/true</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">     *  默认插槽展示operate 具名插槽用来展示自定义项数据</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">     */</span></span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;;</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">props</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">pageInfo</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Object</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-attr">pageNum</span>: <span class="hljs-number">1</span>,</span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-attr">pageSize</span>: <span class="hljs-number">10</span>,</span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-attr">totalCount</span>: <span class="hljs-number">0</span>,</span></span><br><span class="language-javascript"><span class="language-xml">                &#125;;</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">pageShow</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">default</span>: <span class="hljs-literal">true</span>,</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">selShow</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span>,</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">selFnShow</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span>,</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">operateShow</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span>,</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">tabData</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Array</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> [],</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">titles</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Array</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> &#123;&#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">indexShow</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span>,</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">methods</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">onPageChange</span>(<span class="hljs-params">val</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&#x27;onPageChange&#x27;</span>, val);</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">onSizeChange</span>(<span class="hljs-params">val</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&#x27;onSizeChange&#x27;</span>, val);</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">handleSelectionChange</span>(<span class="hljs-params">val</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&#x27;selectChange&#x27;</span>, val);</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">selectTabFn</span>(<span class="hljs-params">row, index</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">selFnShow</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</span></span><br><span class="language-javascript"><span class="language-xml">   <span class="hljs-comment">// 需要父组件提供select方法对每一项数据做可选控制 false 不可选 true可选</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">$parent</span>.<span class="hljs-title function_">selectTabFn</span>(row, index);</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">&#125;;</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;scss&quot;</span> <span class="hljs-attr">scoped</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h4 id="父组件中调用"><a href="#父组件中调用" class="headerlink" title="父组件中调用"></a>父组件中调用</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs css">   &lt;Gtable<br>       :titles=<span class="hljs-string">&quot;titles&quot;</span><br>       :tabData=<span class="hljs-string">&quot;tabData&quot;</span><br>       @onPageChange=<span class="hljs-string">&quot;onPageChange&quot;</span><br>       @onSizeChange=<span class="hljs-string">&quot;onSizeChange&quot;</span><br>       :pageInfo=<span class="hljs-string">&quot;pageInfo&quot;</span><br>       operateShow<br>   &gt;<br>       &lt;template slot-scope=<span class="hljs-string">&quot;scope&quot;</span>&gt;<br>           &lt;ez-button size=<span class="hljs-string">&quot;mini&quot;</span> @click=<span class="hljs-string">&quot;handleEdit(scope)&quot;</span><br>               &gt;Edit&lt;/ez-button<br>           &gt;<br>           &lt;ez-button<br>               size=<span class="hljs-string">&quot;mini&quot;</span><br>               type=<span class="hljs-string">&quot;danger&quot;</span><br>               @click=<span class="hljs-string">&quot;handleEdit(scope.$index, scope.row)&quot;</span><br>               &gt;Delete&lt;/ez-button<br>           &gt;<br>       &lt;/template&gt;<br>       &lt;template slot=<span class="hljs-string">&quot;ysxmSf&quot;</span> slot-scope=<span class="hljs-string">&quot;scope&quot;</span>&gt;<br>           &#123;&#123; scope<span class="hljs-selector-class">.row</span><span class="hljs-selector-class">.prop</span> &#125;&#125;<br>       &lt;/template&gt;<br>   &lt;/Gtable&gt;<br>// 提供data 数据<br>  titles: [ //表头数据 stacks二级表头<br>    &#123; prop: <span class="hljs-string">&#x27;xm&#x27;</span>, label: <span class="hljs-string">&#x27;姓名&#x27;</span> &#125;,<br>    &#123; prop: <span class="hljs-string">&#x27;zjhm&#x27;</span>, label: <span class="hljs-string">&#x27;身份证&#x27;</span>, width: <span class="hljs-string">&#x27;200&#x27;</span> &#125;,<br>    &#123; prop: <span class="hljs-string">&#x27;jgmc&#x27;</span>, label: <span class="hljs-string">&#x27;管理社区&#x27;</span>, width: <span class="hljs-string">&#x27;150&#x27;</span> &#125;,<br>    &#123; prop: <span class="hljs-string">&#x27;gldxlx&#x27;</span>, label: <span class="hljs-string">&#x27;病种&#x27;</span>, width: <span class="hljs-string">&#x27;120&#x27;</span> &#125;,<br>    &#123; prop: <span class="hljs-string">&#x27;sfrq&#x27;</span>, label: <span class="hljs-string">&#x27;随访日期&#x27;</span> &#125;,<br>    &#123;prop: <span class="hljs-string">&#x27;glztGlk&#x27;</span>, label: <span class="hljs-string">&#x27;管理卡状态&#x27;</span>, width: <span class="hljs-string">&#x27;100&#x27;</span> &#125;,<br>    &#123; prop: <span class="hljs-string">&#x27;glztSfk&#x27;</span>, label: <span class="hljs-string">&#x27;随访卡状态&#x27;</span> &#125;,<br>    &#123; prop: <span class="hljs-string">&#x27;ysxmZr&#x27;</span>, label: <span class="hljs-string">&#x27;责任医生&#x27;</span> &#125;,<br>    &#123; prop: <span class="hljs-string">&#x27;ysxmSf&#x27;</span>, deal: true, label: <span class="hljs-string">&#x27;随访医生&#x27;</span> &#125;,<br>    &#123; prop: <span class="hljs-string">&#x27;lczz&#x27;</span>, label: <span class="hljs-string">&#x27;糖尿病患者临床状态&#x27;</span>, width: <span class="hljs-string">&#x27;150&#x27;</span> &#125;,<br>    &#123;<br>        prop: <span class="hljs-string">&#x27;sfrq&#x27;</span>,<br>        label: <span class="hljs-string">&#x27;足背动脉搏动&#x27;</span>,<br>        stacks: [<br>            &#123;prop: <span class="hljs-string">&#x27;jcrq&#x27;</span>, label: <span class="hljs-string">&#x27;检查日期&#x27;</span>, width: <span class="hljs-string">&#x27;120&#x27;</span> &#125;,<br>            &#123; prop: <span class="hljs-string">&#x27;zbdmbdZ&#x27;</span>, label: <span class="hljs-string">&#x27;左足&#x27;</span> &#125;,<br>            &#123; prop: <span class="hljs-string">&#x27;zbdmbdY&#x27;</span>, label: <span class="hljs-string">&#x27;右足&#x27;</span> &#125;,<br>        ],<br>    &#125;,<br>    ],<br>tabData:[],表格数据<br>pageInfo: &#123;//页码<br>    totalCount: <span class="hljs-number">0</span>,<br>    pageNum: <span class="hljs-number">1</span>,<br>    pageSize: <span class="hljs-number">10</span>,<br>&#125;,<br></code></pre></td></tr></table></figure><h5 id="页码封装"><a href="#页码封装" class="headerlink" title="页码封装"></a>页码封装</h5><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs elixir">        &lt;ez-pagination<br>            <span class="hljs-variable">@size</span>-change=<span class="hljs-string">&quot;handleSizeChange&quot;</span><br>            <span class="hljs-variable">@current</span>-change=<span class="hljs-string">&quot;handleCurrentPageChange&quot;</span><br>            <span class="hljs-symbol">:current-page=<span class="hljs-string">&quot;pageInfo.pageNum&quot;</span></span><br>            <span class="hljs-symbol">:page-sizes=<span class="hljs-string">&quot;[ 10, 20, 50, 200]&quot;</span></span><br>            <span class="hljs-symbol">:page-size=<span class="hljs-string">&quot;pageInfo.pageSize&quot;</span></span><br>            layout=<span class="hljs-string">&quot;total, sizes, prev, pager, next, jumper&quot;</span><br>            <span class="hljs-symbol">:total=<span class="hljs-string">&quot;pageInfo.totalCount&quot;</span></span><br>        &gt;<br>        &lt;/ez-pagination&gt;<br><br><br><span class="hljs-symbol">props:</span> &#123;<br>    <span class="hljs-symbol">pageInfo:</span> &#123;<br>        <span class="hljs-symbol">type:</span> <span class="hljs-title class_">Object</span>,<br>        <span class="hljs-symbol">default:</span> () =&gt; &#123;<br>            return &#123;<br>                <span class="hljs-symbol">pageNum:</span> <span class="hljs-number">1</span>,<br>                <span class="hljs-symbol">pageSize:</span> <span class="hljs-number">10</span>,<br>                <span class="hljs-symbol">totalCount:</span> <span class="hljs-number">0</span>,<br>            &#125;;<br>        &#125;,<br>    &#125;,<br>&#125;,<br><br><br><span class="hljs-symbol">methods:</span> &#123;<br>    handleCurrentPageChange(val) &#123;<br>        this.<span class="hljs-variable">$emit</span>(<span class="hljs-string">&#x27;onPageChange&#x27;</span>, val);<br>    &#125;,<br>    handleSizeChange(val) &#123;<br>        this.<span class="hljs-variable">$emit</span>(<span class="hljs-string">&#x27;onSizeChange&#x27;</span>, val);<br>    &#125;,<br>&#125;,<br></code></pre></td></tr></table></figure><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>Element</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Element-ui 表格合并行</title>
    <link href="/2022/09/13/2022/2022-09/09-13table%E8%A1%A8%E6%A0%BC%E5%90%88%E5%B9%B6%E8%A1%8C/"/>
    <url>/2022/09/13/2022/2022-09/09-13table%E8%A1%A8%E6%A0%BC%E5%90%88%E5%B9%B6%E8%A1%8C/</url>
    
    <content type="html"><![CDATA[<h3 id="实现-element-table-表格合并"><a href="#实现-element-table-表格合并" class="headerlink" title="实现 element table 表格合并"></a>实现 element table 表格合并</h3><p><img src="/img/2022/E_J_tableHb_1.png" alt="E_J_tableHb_1"><br>饿了么框架介绍的基础，合并的主要属性是 span-method 方法 返回的 rowspan，colspan 值是做依赖合并的依据</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">&lt;ez-<span class="hljs-keyword">table</span><br>     :data=&quot;tableData&quot;<br>     :span-<span class="hljs-keyword">method</span>=&quot;objectSpanMethod&quot;<br>     border<br>     style=&quot;width: 100%; margin-top: 20px&quot;&gt;<br>     &lt;ez-<span class="hljs-keyword">table</span>-<span class="hljs-keyword">column</span><br>       prop=&quot;id&quot;<br>       label=&quot;ID&quot;<br>       width=&quot;180&quot;&gt;<br>     &lt;/ez-<span class="hljs-keyword">table</span>-<span class="hljs-keyword">column</span>&gt;<br>     &lt;ez-<span class="hljs-keyword">table</span>-<span class="hljs-keyword">column</span><br>       prop=&quot;name&quot;<br>       label=&quot;姓名&quot;&gt;<br>     &lt;/ez-<span class="hljs-keyword">table</span>-<span class="hljs-keyword">column</span>&gt;<br>     &lt;ez-<span class="hljs-keyword">table</span>-<span class="hljs-keyword">column</span><br>       prop=&quot;amount1&quot;<br>       label=&quot;数值 1（元）&quot;&gt;<br>     &lt;/ez-<span class="hljs-keyword">table</span>-<span class="hljs-keyword">column</span>&gt;<br>     &lt;ez-<span class="hljs-keyword">table</span>-<span class="hljs-keyword">column</span><br>       prop=&quot;amount2&quot;<br>       label=&quot;数值 2（元）&quot;&gt;<br>     &lt;/ez-<span class="hljs-keyword">table</span>-<span class="hljs-keyword">column</span>&gt;<br>     &lt;ez-<span class="hljs-keyword">table</span>-<span class="hljs-keyword">column</span><br>       prop=&quot;amount3&quot;<br>       label=&quot;数值 3（元）&quot;&gt;<br>     &lt;/ez-<span class="hljs-keyword">table</span>-<span class="hljs-keyword">column</span>&gt;<br>   &lt;/ez-<span class="hljs-keyword">table</span>&gt;<br><br>data()&#123;<br><span class="hljs-keyword">return</span> &#123;<br> tableData: [&#123;<br>         id: <span class="hljs-string">&#x27;12987122&#x27;</span>,<br>         <span class="hljs-type">name</span>: <span class="hljs-string">&#x27;王小虎&#x27;</span>,<br>         amount1: <span class="hljs-string">&#x27;234&#x27;</span>,<br>         amount2: <span class="hljs-string">&#x27;3.2&#x27;</span>,<br>         amount3: <span class="hljs-number">10</span><br>       &#125;, &#123;<br>         id: <span class="hljs-string">&#x27;12987123&#x27;</span>,<br>         <span class="hljs-type">name</span>: <span class="hljs-string">&#x27;王小虎&#x27;</span>,<br>         amount1: <span class="hljs-string">&#x27;165&#x27;</span>,<br>         amount2: <span class="hljs-string">&#x27;4.43&#x27;</span>,<br>         amount3: <span class="hljs-number">12</span><br>       &#125;, &#123;<br>         id: <span class="hljs-string">&#x27;12987124&#x27;</span>,<br>         <span class="hljs-type">name</span>: <span class="hljs-string">&#x27;王小虎&#x27;</span>,<br>         amount1: <span class="hljs-string">&#x27;324&#x27;</span>,<br>         amount2: <span class="hljs-string">&#x27;1.9&#x27;</span>,<br>         amount3: <span class="hljs-number">9</span><br>       &#125;, &#123;<br>         id: <span class="hljs-string">&#x27;12987125&#x27;</span>,<br>         <span class="hljs-type">name</span>: <span class="hljs-string">&#x27;王小虎&#x27;</span>,<br>         amount1: <span class="hljs-string">&#x27;621&#x27;</span>,<br>         amount2: <span class="hljs-string">&#x27;2.2&#x27;</span>,<br>         amount3: <span class="hljs-number">17</span><br>       &#125;, &#123;<br>         id: <span class="hljs-string">&#x27;12987126&#x27;</span>,<br>         <span class="hljs-type">name</span>: <span class="hljs-string">&#x27;王小虎&#x27;</span>,<br>         amount1: <span class="hljs-string">&#x27;539&#x27;</span>,<br>         amount2: <span class="hljs-string">&#x27;4.1&#x27;</span>,<br>         amount3: <span class="hljs-number">15</span><br>       &#125;]<br>&#125;<br>&#125;,<br> methods: &#123;<br>    objectSpanMethod(&#123; <span class="hljs-keyword">row</span>, <span class="hljs-keyword">column</span>, rowIndex, columnIndex &#125;) &#123;<br>         <span class="hljs-keyword">if</span> (columnIndex === <span class="hljs-number">0</span>) &#123;<br>          <span class="hljs-keyword">if</span> (rowIndex % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>) &#123;<br>           <span class="hljs-keyword">return</span> &#123;<br>             rowspan: <span class="hljs-number">2</span>,<br>             colspan: <span class="hljs-number">1</span><br>           &#125;;<br>          &#125; <span class="hljs-keyword">else</span> &#123;<br>           <span class="hljs-keyword">return</span> &#123;<br>             rowspan: <span class="hljs-number">0</span>,<br>             colspan: <span class="hljs-number">0</span><br>           &#125;;<br>         &#125;<br>       &#125;<br>     &#125;<br> &#125;<br></code></pre></td></tr></table></figure><h4 id="主要问题-解决方案"><a href="#主要问题-解决方案" class="headerlink" title="主要问题/解决方案"></a>主要问题/解决方案</h4><ol><li>当数据执行时，怎么动态判断需要合并或者合并行的行数，给 rowspan，colspan 做依据</li><li>当需要合并时的依据 识别 ID 条件是什么？</li></ol><p>判断首先合并的场景，是相邻的某个 key 值相同的情况下，进行合并。可以理解为当前这一条与上一条数据 是否相同进行合并<br>（PS：首先确保数据是否排序过或者一样的不在一起需不需要合并，注意处理边界线）<br>那么我们可以 给 数据加一个 count 值 去动态计算合并的行数，当满足条件给数值进行累加</p><h4 id="功能实现"><a href="#功能实现" class="headerlink" title="功能实现"></a>功能实现</h4><h5 id="常规表格数据"><a href="#常规表格数据" class="headerlink" title="常规表格数据"></a>常规表格数据</h5><p><img src="/img/2022/E_J_tableHb_3.png" alt="E_J_tableHb_3"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//实际业务，以‘adviceNo’做识别key值比对，数据中只需要相邻的‘adviceNo’值一致的合并。</span><br>&lt;ez-table<br>        border<br>        size=<span class="hljs-string">&quot;mini&quot;</span><br>        :data=<span class="hljs-string">&quot;tabdata&quot;</span><br>        :span-method=<span class="hljs-string">&quot;objectSpanMethod&quot;</span><br>        ref=<span class="hljs-string">&quot;tableData&quot;</span><br>        style=<span class="hljs-string">&quot;width: 100%&quot;</span><br>        max-height=<span class="hljs-string">&quot;450px&quot;</span><br>    &gt;<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ez-table-column</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">prop</span>=<span class="hljs-string">&quot;adviceNo&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;医嘱编号&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;90&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        &gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">ez-table-column</span>&gt;</span></span><br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ez-table-column</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">prop</span>=<span class="hljs-string">&quot;medicalTechName&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;项目&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;120&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        &gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">ez-table-column</span>&gt;</span></span><br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ez-table-column</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">prop</span>=<span class="hljs-string">&quot;name&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;部位&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        &gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">ez-table-column</span>&gt;</span></span><br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ez-table-column</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">prop</span>=<span class="hljs-string">&quot;technique&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;方法&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ez-table-column</span>&gt;</span></span><br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ez-table-column</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;100&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">prop</span>=<span class="hljs-string">&quot;duration&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;时间&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ez-table-column</span>&gt;</span></span><br>    &lt;/ez-table&gt;<br><span class="hljs-attr">methods</span>:&#123;<br><span class="hljs-keyword">async</span> <span class="hljs-title function_">getDetailInfo</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">let</span> res = <span class="hljs-keyword">await</span> ****api***<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">tabdata</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">mergeTableData</span>([<span class="hljs-string">&#x27;adviceNo&#x27;</span>],res)<br>&#125;,<br> <span class="hljs-comment">/** 处理合并行数据  */</span><br>        <span class="hljs-title function_">mergeTableData</span>(<span class="hljs-params">mergeVals, tabs</span>) &#123;<br>            <span class="hljs-keyword">let</span> spanArr = [],<br>                indexArr = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">let</span> tabData = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(tabs));<br>            mergeVals.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">val</span>) =&gt;</span> &#123;<br>                tabData.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> &#123;<br>                    <span class="hljs-keyword">if</span> (index === <span class="hljs-number">0</span>) &#123;<br>                        spanArr.<span class="hljs-title function_">push</span>(<span class="hljs-number">1</span>);<br>                        indexArr = <span class="hljs-number">0</span>;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        <span class="hljs-comment">// 判断是否与上一行数据相同</span><br>                        <span class="hljs-keyword">if</span> (tabData[index][val] === tabData[index - <span class="hljs-number">1</span>][val]) &#123;<br>                            spanArr[indexArr] += <span class="hljs-number">1</span>;<br>                            spanArr.<span class="hljs-title function_">push</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">//合并的当前数据</span><br>                        &#125; <span class="hljs-keyword">else</span> &#123;<br>                            spanArr.<span class="hljs-title function_">push</span>(<span class="hljs-number">1</span>);<br>                            indexArr = index;<br>                        &#125;<br>                    &#125;<br>                &#125;);<br>            &#125;);<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">spanArr</span> = spanArr;<br>            <span class="hljs-keyword">return</span> tabData;<br>        &#125;,<br>        <span class="hljs-comment">/** 合并方法 */</span><br>        <span class="hljs-title function_">objectSpanMethod</span>(<span class="hljs-params">&#123; row, column, rowIndex, columnIndex &#125;</span>) &#123;<br>            <span class="hljs-keyword">if</span> (columnIndex === <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">const</span> _row = <span class="hljs-variable language_">this</span>.<span class="hljs-property">spanArr</span>[rowIndex];<span class="hljs-comment">// 这里获取拿到的处理好数据进行赋值</span><br>                <span class="hljs-keyword">const</span> _col = _row &gt; <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">return</span> &#123;<br>                    <span class="hljs-attr">rowspan</span>: _row,<br>                    <span class="hljs-attr">colspan</span>: _col,<br>                &#125;;<br>            &#125;<br>        &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="嵌套数据结构"><a href="#嵌套数据结构" class="headerlink" title="嵌套数据结构"></a>嵌套数据结构</h5><p>相比比之前的常规的多一层数据嵌套，处理方式大致一样，赋值方面稍作处理，将值放到对应的数据中<br> <img src="/img/2022/E_J_tableHb_2.png" alt="E_J_tableHb_2"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><code class="hljs javascript">   <span class="hljs-comment">//实际业务，以‘serialNo’做识别key值比对，数据中只需要相邻的‘serialNo’值一致的合并。数据结构是多个表格  [&#123;[]&#125;,&#123;[]&#125;]</span><br>    &lt;div v-<span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;(item, index) in detaildata&quot;</span> :key=<span class="hljs-string">&quot;index&quot;</span>&gt;<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ez-table</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">:header-cell-style</span>=<span class="hljs-string">&quot;&#123;</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                    background: &#x27;#E4E8EF&#x27;,</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                    color: &#x27;#333&#x27;,</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                    fontWeight: 500,</span></span></span><br><span class="hljs-string"><span class="hljs-tag"><span class="language-xml">                &#125;&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">border</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;mini&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">:data</span>=<span class="hljs-string">&quot;item.treatmentList&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;tableData&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 100%&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">max-height</span>=<span class="hljs-string">&quot;450px&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">:span-method</span>=<span class="hljs-string">&quot;objectSpanMethod&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            &gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ez-table-column</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">prop</span>=<span class="hljs-string">&quot;serialNo&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;序号&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;60&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                &gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">ez-table-column</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ez-table-column</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">prop</span>=<span class="hljs-string">&quot;date&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;日期&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;120&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                &gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">ez-table-column</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ez-table-column</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">prop</span>=<span class="hljs-string">&quot;adviceNo&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;医嘱编号&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;100&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                &gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">ez-table-column</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ez-table-column</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">prop</span>=<span class="hljs-string">&quot;startTime&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;开始时间&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;100&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ez-table-column</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ez-table-column</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">prop</span>=<span class="hljs-string">&quot;remark&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;180&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;hh_txt&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;备注&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ez-table-column</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ez-table-column</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">prop</span>=<span class="hljs-string">&quot;therapistName&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;center&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;100&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;治疗者&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ez-table-column</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">ez-table</span>&gt;</span></span><br>        &lt;/div&gt;<br><span class="hljs-attr">methods</span>:&#123;<br><br><span class="hljs-keyword">async</span> <span class="hljs-title function_">getDetailInfo</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">let</span> res = <span class="hljs-keyword">await</span> ****api***<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">detaildata</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">filterData</span>(<span class="hljs-string">&#x27;serialNo&#x27;</span>,res)<br>&#125;,<br> <span class="hljs-comment">/** 处理合并行数据 */</span><br>        <span class="hljs-title function_">filterData</span>(<span class="hljs-params">key,data</span>) &#123;<br>            <span class="hljs-keyword">let</span> spanArr = [];<br>            <span class="hljs-keyword">let</span> indexArr = [];<br>            <span class="hljs-keyword">let</span> _sort = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">let</span> <span class="hljs-title class_">Data</span> = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>; index &lt; <span class="hljs-title class_">Data</span>.<span class="hljs-property">length</span>; index++) &#123;<br>                <span class="hljs-keyword">let</span> tableDate = <span class="hljs-title class_">Data</span>[index].<span class="hljs-property">treatmentList</span>;<span class="hljs-comment">// 需要处理的表格数据</span><br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; tableDate.<span class="hljs-property">length</span>; i++) &#123;<br>                    <span class="hljs-keyword">if</span> (i === <span class="hljs-number">0</span>) &#123; <span class="hljs-comment">// 处理第一条数据没有前一项内容</span><br>                        spanArr[index] = [];<br>                        indexArr[index] = [];<br>                        spanArr[index].<span class="hljs-title function_">push</span>(<span class="hljs-number">1</span>);<br>                        indexArr[index].<span class="hljs-title function_">push</span>(<span class="hljs-number">1</span>);<br>                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">pos</span> = <span class="hljs-number">0</span>;<br>                        _sort = <span class="hljs-number">1</span>;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        <span class="hljs-comment">// 判断当前元素与上一个元素是否相同;key为识别id</span><br>                        <span class="hljs-keyword">if</span> (tableDate[i][key] === tableDate[i - <span class="hljs-number">1</span>][key]) &#123;<br>                            spanArr[index][<span class="hljs-variable language_">this</span>.<span class="hljs-property">pos</span>] += <span class="hljs-number">1</span>;<br>                            spanArr[index].<span class="hljs-title function_">push</span>(<span class="hljs-number">0</span>);<br>                            _sort = indexArr[index][i - <span class="hljs-number">1</span>];<br>                            indexArr[index].<span class="hljs-title function_">push</span>(_sort);<br>                        &#125; <span class="hljs-keyword">else</span> &#123;<br>                            spanArr[index].<span class="hljs-title function_">push</span>(<span class="hljs-number">1</span>);<br>                            <span class="hljs-variable language_">this</span>.<span class="hljs-property">pos</span> = i;<br>                            _sort += <span class="hljs-number">1</span>;<br>                            indexArr[index].<span class="hljs-title function_">push</span>(_sort);<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br><span class="hljs-comment">// 将值放入对应的数据中进行返回</span><br>            <span class="hljs-title class_">Data</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> &#123;<br>                item.<span class="hljs-property">treatmentList</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">val, k</span>) =&gt;</span> &#123;<br>                    <span class="hljs-title class_">Data</span>[index].<span class="hljs-property">treatmentList</span>[k].<span class="hljs-property">_row</span> = spanArr[index][k];<br>                    <span class="hljs-title class_">Data</span>[index].<span class="hljs-property">treatmentList</span>[k].<span class="hljs-property">_sort</span> = indexArr[index][k];<br>                &#125;);<br>            &#125;);<br>            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Data</span>;<br>        &#125;,<br><span class="hljs-comment">/** 合并方法 */</span><br>        <span class="hljs-title function_">objectSpanMethod</span>(<span class="hljs-params">&#123; row, column, rowIndex, columnIndex &#125;</span>) &#123;<br>            <span class="hljs-keyword">if</span> (columnIndex === <span class="hljs-number">0</span>) &#123; <span class="hljs-comment">// columnIndex需要合并的那个列索引</span><br>                <span class="hljs-keyword">const</span> _row = row.<span class="hljs-property">_row</span>;<br>                onst _col = _row &gt; <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">return</span> &#123;<br>                    <span class="hljs-attr">rowspan</span>: _row,<br>                    <span class="hljs-attr">colspan</span>: _col,<br>                &#125;;<br>            &#125;<br>        &#125;,<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Element</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>form表单简单封装</title>
    <link href="/2022/08/10/2022/2022-08/08-10form%E8%A1%A8%E5%8D%95%E5%B0%81%E8%A3%85/"/>
    <url>/2022/08/10/2022/2022-08/08-10form%E8%A1%A8%E5%8D%95%E5%B0%81%E8%A3%85/</url>
    
    <content type="html"><![CDATA[<h3 id="初始需求分析"><a href="#初始需求分析" class="headerlink" title="初始需求分析"></a>初始需求分析</h3><p>日常开发中特别是做后台管理系统需要开发⼤量类似的表单页⾯，每次的表单页面很长，有相似有不同。重复的逻辑、重复的代码。<br>CV 对于后期的维护、新页⾯的开发仍旧需要⼤量的时间去完成重复的⼯作。为了提升开发效率，便于开发学习(摸鱼)，对代码封装进行抽离、整合、优化相对应逻辑<br><img src="/img/2022/form1.png" alt="表单1"></p><h3 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h3><ol><li>要能⽣成不同类型的表单元素</li><li>通过简单的配置可以定位或者栅格布局元素</li><li>能⽀持表单提交后的回调函数获取数据</li><li>更易维护核⼼代码编写⽅式【因为任何组件⼯具都不可能⼀次设计完美】</li></ol><p>思考：数据结构<br>需求有： 表单行数、 colspan 栅格跨度 每项 key 识别(表单校验 prop) 名字(label) 默认值(value) 类型（type）额外原生属性配置</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">const form = <span class="hljs-keyword">Object</span>.<span class="hljs-keyword">freeze</span>(&#123;<br> title: <span class="hljs-string">&#x27;注册⽤户&#x27;</span>,<br> items: [<br> [ &#123; label:<span class="hljs-string">&#x27;⽤户名&#x27;</span>,<span class="hljs-keyword">type</span>: <span class="hljs-string">&#x27;input&#x27;</span>, key: <span class="hljs-string">&#x27;username&#x27;</span>, col: <span class="hljs-number">2</span>,<span class="hljs-keyword">value</span>:<span class="hljs-number">12</span> ],<br> [ &#123; label:<span class="hljs-string">&#x27;性别&#x27;</span>,<span class="hljs-keyword">type</span>: <span class="hljs-string">&#x27;select&#x27;</span>, key: <span class="hljs-string">&#x27;gender&#x27;</span>, <span class="hljs-keyword">option</span> &#123; label: <span class="hljs-string">&#x27;男&#x27;</span>, <span class="hljs-keyword">value</span>: <span class="hljs-number">1</span> &#125;, &#123; label: <span class="hljs-string">&#x27;⼥&#x27;</span>, <span class="hljs-keyword">value</span>: <span class="hljs-number">0</span> &#125; ] &#125;, ]<br> ]<br>&#125;);<br><br><span class="hljs-keyword">Object</span>.<span class="hljs-keyword">freeze</span>是可以冻结对象，对于不需要改变的对象使⽤，可以提升性能 item的每一项是表的每一行<br></code></pre></td></tr></table></figure><h4 id="使用组件-这边使用的是-vue2-element-用-jsx-写法"><a href="#使用组件-这边使用的是-vue2-element-用-jsx-写法" class="headerlink" title="使用组件(这边使用的是 vue2 + element 用 jsx 写法)"></a>使用组件(这边使用的是 vue2 + element 用 jsx 写法)</h4><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir">&lt;<span class="hljs-title class_">Gform</span> <span class="hljs-symbol">:conf=<span class="hljs-string">&quot;form.items&quot;</span></span> <span class="hljs-symbol">:rules=<span class="hljs-string">&quot;form.rules&quot;</span></span> <span class="hljs-variable">@submit</span>=<span class="hljs-string">&quot;submit&quot;</span> &gt; &lt;/<span class="hljs-title class_">Gform</span>&gt;<br></code></pre></td></tr></table></figure><h4 id="form-组件"><a href="#form-组件" class="headerlink" title="form 组件"></a>form 组件</h4><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-comment">// import Rows from &#x27;./rows.vue&#x27;;</span></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> columsItem <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./columsItem.vue&#x27;</span>;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Gorm&#x27;</span>,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">componensts</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// Rows,</span></span></span><br><span class="language-javascript"><span class="language-xml">        columsItem,</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">props</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">conf</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Array</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">rules</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Object</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> &#123;&#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">form</span>: &#123;&#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;;</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">computed</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">items</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">conf</span>;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">rulesForm</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">rules</span>;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">watch</span>: &#123;&#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">reaciveData</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>);</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">rulesHandler</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">rulesForm</span>);</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;&#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">methods</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 获取提交数据函数 */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">submit</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> &#123; submit &#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$listeners</span>;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">validate</span>(submit);</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 请空值校验 */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">reset</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">form</span>.<span class="hljs-title function_">resetFields</span>();</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 获取form值 */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">getData</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">deepClone</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">form</span>);</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 深拷贝 */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">deepClone</span>(<span class="hljs-params">data</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 校验 */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">validate</span>(<span class="hljs-params">fn</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// 1. 先验证， 验证通过 调用this.getData()作为参数给fn</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// 2. 验证失败 返回false或者null给外部</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">form</span>.<span class="hljs-title function_">validate</span>(<span class="hljs-function">(<span class="hljs-params">valid</span>) =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">if</span> (valid) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-title function_">fn</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getData</span>());</span></span><br><span class="language-javascript"><span class="language-xml">                &#125; <span class="hljs-keyword">else</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-title function_">fn</span>(<span class="hljs-literal">false</span>);</span></span><br><span class="language-javascript"><span class="language-xml">                &#125;</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 列 */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">renderColums</span>(<span class="hljs-params">rowArr</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">return</span> rowArr.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">return</span> (</span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">el-col</span></span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript"><span class="language-xml">                        <span class="hljs-attr">xl</span>=<span class="hljs-string">&#123;item.colspan&#125;</span></span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript"><span class="language-xml">                        <span class="hljs-attr">lg</span>=<span class="hljs-string">&#123;item.colspan&#125;</span></span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript"><span class="language-xml">                        <span class="hljs-attr">md</span>=<span class="hljs-string">&#123;12&#125;</span></span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript"><span class="language-xml">                        <span class="hljs-attr">sm</span>=<span class="hljs-string">&#123;24&#125;</span></span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript"><span class="language-xml">                        <span class="hljs-attr">xs</span>=<span class="hljs-string">&#123;24&#125;</span></span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript"><span class="language-xml">                    &gt;</span></span></span></span><br><span class="language-xml"><span class="language-javascript"><span class="language-xml">                        <span class="hljs-tag">&lt;<span class="hljs-name">el-form-item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&#123;item.label&#125;</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">&#123;item.key&#125;</span>&gt;</span></span></span></span><br><span class="language-xml"><span class="language-javascript"><span class="language-xml">                            <span class="hljs-tag">&lt;<span class="hljs-name">columsItem</span></span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript"><span class="language-xml">                                <span class="hljs-attr">v-model</span>=<span class="hljs-string">&#123;this.form[item.key]&#125;</span></span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript"><span class="language-xml">                                <span class="hljs-attr">columsData</span>=<span class="hljs-string">&#123;item&#125;</span></span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript"><span class="language-xml">                            /&gt;</span></span></span></span><br><span class="language-xml"><span class="language-javascript"><span class="language-xml">                        <span class="hljs-tag">&lt;/<span class="hljs-name">el-form-item</span>&gt;</span></span></span></span><br><span class="language-xml"><span class="language-javascript"><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">el-col</span>&gt;</span></span></span></span><br><span class="language-javascript"><span class="language-xml">                );</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 行 */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">rederRows</span>(<span class="hljs-params">rows</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">return</span> rows.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">rowArr</span>) =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">el-row</span>&gt;</span> &#123;this.renderColums(rowArr)&#125; <span class="hljs-tag">&lt;/<span class="hljs-name">el-row</span>&gt;</span></span>;</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 设置响应值 */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">reaciveData</span>(<span class="hljs-params">data</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            data.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">row</span>) =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                row.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-variable language_">this</span>.$set(<span class="hljs-variable language_">this</span>.<span class="hljs-property">form</span>, item.<span class="hljs-property">key</span>, item.<span class="hljs-property">value</span> || <span class="hljs-string">&#x27;&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">                &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 改变自定义验证器的this指向 */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">rulesHandler</span>(<span class="hljs-params">rules</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> rules) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">let</span> valArr = rules[key];</span></span><br><span class="language-javascript"><span class="language-xml">                valArr.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-keyword">if</span> (item.<span class="hljs-property">validator</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                        item.<span class="hljs-property">validator</span> = item.<span class="hljs-property">validator</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);</span></span><br><span class="language-javascript"><span class="language-xml">                    &#125;</span></span><br><span class="language-javascript"><span class="language-xml">                &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">return</span> (</span></span><br><span class="language-javascript"><span class="language-xml">            &lt;div class=&quot;form-box&quot;&gt;</span></span><br><span class="language-javascript"><span class="language-xml">                &lt;el-form</span></span><br><span class="language-javascript"><span class="language-xml">                    ref=&quot;form&quot;</span></span><br><span class="language-javascript"><span class="language-xml">                    rules=&#123;this.rulesForm&#125;</span></span><br><span class="language-javascript"><span class="language-xml">                    attrs=</span></span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">model:</span> this.form &#125;&#125;</span><span class="language-xml"><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml">                    label-width=<span class="hljs-string">&quot;80px&quot;</span></span></span><br><span class="language-javascript"><span class="language-xml">                &gt;</span></span><br><span class="language-javascript"><span class="language-xml">                    &#123;<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">rederRows</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>)&#125;</span></span><br><span class="language-javascript"><span class="language-xml">                    &lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;btns clear-fix&quot;</span>&gt;</span></span><br><span class="language-javascript"><span class="language-xml">                        &#123;<span class="hljs-comment">/* 没有默认插槽时 DOM */</span>&#125;</span></span><br><span class="language-javascript"><span class="language-xml">                        &#123;<span class="hljs-variable language_">this</span>.<span class="hljs-property">$slots</span>.<span class="hljs-property">default</span> ? (</span></span><br><span class="language-javascript"><span class="language-xml">                            <span class="hljs-variable language_">this</span>.<span class="hljs-property">$slots</span>.<span class="hljs-property">default</span></span></span><br><span class="language-javascript"><span class="language-xml">                        ) : (</span></span><br><span class="language-javascript"><span class="language-xml">                            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span></span></span><br><span class="language-xml"><span class="language-javascript"><span class="language-xml">                                <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span></span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript"><span class="language-xml">                                    <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;success&quot;</span></span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript"><span class="language-xml">                                    <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> this.submit()&#125;</span></span></span><br><span class="language-xml"><span class="language-javascript"><span class="language-xml">                                &gt;</span></span></span><br><span class="language-xml"><span class="language-javascript"><span class="language-xml">                                    提交</span></span></span><br><span class="language-xml"><span class="language-javascript"><span class="language-xml">                                <span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span></span></span></span><br><span class="language-xml"><span class="language-javascript"><span class="language-xml">                                <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> this.reset()&#125;&gt;</span></span></span><br><span class="language-xml"><span class="language-javascript"><span class="language-xml">                                    重置</span></span></span><br><span class="language-xml"><span class="language-javascript"><span class="language-xml">                                <span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span></span></span></span><br><span class="language-xml"><span class="language-javascript"><span class="language-xml">                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></span></span><br><span class="language-javascript"><span class="language-xml">                        )&#125;</span></span><br><span class="language-javascript"><span class="language-xml">                        &#123;<span class="hljs-comment">/* 仅仅填DOM,给父传递参数this.$scopedSlots.default(data) */</span>&#125;</span></span><br><span class="language-javascript"><span class="language-xml">                    &lt;/div&gt;</span></span><br><span class="language-javascript"><span class="language-xml">                &lt;/el-form&gt;</span></span><br><span class="language-javascript"><span class="language-xml">            &lt;/div&gt;</span></span><br><span class="language-javascript"><span class="language-xml">        );</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">&#125;;</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;scss&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br></code></pre></td></tr></table></figure><ol><li>需要将外部传递初始数据进行数据劫持 使用 <a href="https://v2.cn.vuejs.org/v2/api/#Vue-set">Vue.set</a></li><li>将传递校验属性 this 指向改变</li><li>注意一些值的改变影响做深拷贝 以免一些不必要的情况出现</li></ol><h4 id="基础组件"><a href="#基础组件" class="headerlink" title="基础组件"></a>基础组件</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;columsItem&#x27;</span>,</span><br><span class="language-javascript">    <span class="hljs-attr">components</span>: &#123;&#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">props</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-attr">columsData</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Object</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-attr">value</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">model</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-attr">prop</span>: <span class="hljs-string">&#x27;value&#x27;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">event</span>: <span class="hljs-string">&#x27;changeVal&#x27;</span>,</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">val</span>: <span class="hljs-string">&#x27;&#x27;</span>,</span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">computed</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-title function_">span</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">columsData</span>;</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">watch</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-attr">val</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>,</span><br><span class="language-javascript">            <span class="hljs-title function_">handler</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">changeVal</span>();</span><br><span class="language-javascript">            &#125;,</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;&#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(this.value, 11, &#x27;columsData&#x27;, this.columsData);</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">val</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">deepClone</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">/** 深拷贝 */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">deepClone</span>(<span class="hljs-params">data</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/** 双向绑定事件 */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">changeVal</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 反馈事件名称与model 中事件名称一致</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&#x27;changeVal&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">val</span>);</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/** 渲染当前表单元素 */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">renderItem</span>(<span class="hljs-params">item</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">switch</span> (item.<span class="hljs-property">type</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;input&#x27;</span>:</span><br><span class="language-javascript">                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;password&#x27;</span>:</span><br><span class="language-javascript">                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;textarea&#x27;</span>:</span><br><span class="language-javascript">                    <span class="hljs-keyword">return</span> (</span><br><span class="language-javascript">                        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">el-input</span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript">                            <span class="hljs-attr">type</span>=<span class="hljs-string">&#123;item.type&#125;</span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript">                            <span class="hljs-attr">v-model</span>=<span class="hljs-string">&#123;this.val&#125;</span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript">                            <span class="hljs-attr">attrs</span>=<span class="hljs-string">&#123;item.attrs&#125;</span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript">                        &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-input</span>&gt;</span></span></span><br><span class="language-javascript">                    );</span><br><span class="language-javascript">                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;radio&#x27;</span>:</span><br><span class="language-javascript">                    <span class="hljs-keyword">return</span> (</span><br><span class="language-javascript">                        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">el-radio-group</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&#123;this.val&#125;</span>&gt;</span></span></span><br><span class="language-xml"><span class="language-javascript">                            &#123;item.options.map((opt, i) =&gt; &#123;</span></span><br><span class="language-xml"><span class="language-javascript">                                return (</span></span><br><span class="language-xml"><span class="language-javascript">                                    <span class="hljs-tag">&lt;<span class="hljs-name">el-radio</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;i&#125;</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&#123;opt.label&#125;</span>&gt;</span></span></span><br><span class="language-xml"><span class="language-javascript">                                        &#123;opt.text&#125;</span></span><br><span class="language-xml"><span class="language-javascript">                                    <span class="hljs-tag">&lt;/<span class="hljs-name">el-radio</span>&gt;</span></span></span><br><span class="language-xml"><span class="language-javascript">                                );</span></span><br><span class="language-xml"><span class="language-javascript">                            &#125;)&#125;</span></span><br><span class="language-xml"><span class="language-javascript">                        <span class="hljs-tag">&lt;/<span class="hljs-name">el-radio-group</span>&gt;</span></span></span><br><span class="language-javascript">                    );</span><br><span class="language-javascript"></span><br><span class="language-javascript">                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;select&#x27;</span>:</span><br><span class="language-javascript">                    <span class="hljs-keyword">return</span> (</span><br><span class="language-javascript">                        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">el-select</span> <span class="hljs-attr">attrs</span>=<span class="hljs-string">&#123;item.attrs&#125;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&#123;this.val&#125;</span>&gt;</span></span></span><br><span class="language-xml"><span class="language-javascript">                            &#123;item.options.map((opt) =&gt; &#123;</span></span><br><span class="language-xml"><span class="language-javascript">                                return (</span></span><br><span class="language-xml"><span class="language-javascript">                                    <span class="hljs-tag">&lt;<span class="hljs-name">el-option</span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript">                                        <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;opt.value&#125;</span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript">                                        <span class="hljs-attr">label</span>=<span class="hljs-string">&#123;opt.label&#125;</span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript">                                        <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;opt.value&#125;</span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript">                                    &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-option</span>&gt;</span></span></span><br><span class="language-xml"><span class="language-javascript">                                );</span></span><br><span class="language-xml"><span class="language-javascript">                            &#125;)&#125;</span></span><br><span class="language-xml"><span class="language-javascript">                        <span class="hljs-tag">&lt;/<span class="hljs-name">el-select</span>&gt;</span></span></span><br><span class="language-javascript">                    );</span><br><span class="language-javascript">                <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;datetime&#x27;</span>:</span><br><span class="language-javascript">                    <span class="hljs-keyword">return</span> (</span><br><span class="language-javascript">                        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">el-date-picker</span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript">                            <span class="hljs-attr">attrs</span>=<span class="hljs-string">&#123;item.attrs&#125;</span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript">                            <span class="hljs-attr">v-model</span>=<span class="hljs-string">&#123;this.val&#125;</span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript">                            <span class="hljs-attr">value-format</span>=<span class="hljs-string">&#123;item.valueFormat&#125;</span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript">                            <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;date&quot;</span></span></span></span><br><span class="hljs-tag"><span class="language-xml"><span class="language-javascript">                        &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-date-picker</span>&gt;</span></span></span><br><span class="language-javascript">                    );</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>&#123;this.renderItem(this.span)&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;scss&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><br></code></pre></td></tr></table></figure><ol><li>renderItem 做种 type 渲染 单项数据在这里维护</li><li>attrs 调用原声属性 在这里做扩展口子</li><li>做组件的 model 双向数据绑定写法</li></ol><h3 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h3><p><img src="/img/2022/form3.png" alt="表单1"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs php">export <span class="hljs-keyword">default</span> &#123;<br>    items: Object.<span class="hljs-title function_ invoke__">freeze</span>([<br>        [<br>            &#123;<br>                <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;input&#x27;</span>,<br>                <span class="hljs-attr">label</span>: <span class="hljs-string">&#x27;用户名&#x27;</span>,<br>                <span class="hljs-attr">colspan</span>: <span class="hljs-number">12</span>,<br>                <span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;2222&#x27;</span>,<br>                <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;username&#x27;</span>,<br>                <span class="hljs-attr">show</span>: <span class="hljs-literal">true</span>,<br>            &#125;,<br>        ],<br>        [&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;password&#x27;</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">&#x27;密码&#x27;</span>, <span class="hljs-attr">colspan</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;password&#x27;</span>, <span class="hljs-attr">attrs</span>: &#123; <span class="hljs-attr">placeholder</span>:<span class="hljs-string">&#x27;请输入密码&#x27;</span>,&#125; &#125;],<br>        [&#123;<br>                <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;password&#x27;</span>,<br>                <span class="hljs-attr">label</span>: <span class="hljs-string">&#x27;确认密码&#x27;</span>,<br>                <span class="hljs-attr">colspan</span>: <span class="hljs-number">12</span>,<br>                <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;confirmPwd&#x27;</span>,<br>         &#125;],<br>        [&#123;<br>                <span class="hljs-attr">colspan</span>: <span class="hljs-number">8</span>,<br>                <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;radio&#x27;</span>,<br>                <span class="hljs-attr">label</span>: <span class="hljs-string">&#x27;权限分配&#x27;</span>,<br>                <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;permission&#x27;</span>,<br>                <span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;2&#x27;</span>,<br>                <span class="hljs-attr">options</span>: Dic.RY_TY,<br>        &#125;],<br>    ]),<br>    rules: &#123;<br>        username: [&#123; required: <span class="hljs-literal">true</span>, message: <span class="hljs-string">&#x27;输入用户名&#x27;</span> &#125;],<br>        password: [&#123; required: <span class="hljs-literal">true</span>, message: <span class="hljs-string">&#x27;输入密码&#x27;</span> &#125;],<br>        confirmPwd: [&#123; validator: validatePass2, trigger: <span class="hljs-string">&#x27;blur&#x27;</span> &#125;],<br>        permission: [&#123; required: <span class="hljs-literal">true</span> &#125;],<br>    &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vue router axios 用户的三级权限</title>
    <link href="/2022/07/10/2022/2022-07/07-10%E4%B8%89%E7%BA%A7%E6%9D%83%E9%99%90/"/>
    <url>/2022/07/10/2022/2022-07/07-10%E4%B8%89%E7%BA%A7%E6%9D%83%E9%99%90/</url>
    
    <content type="html"><![CDATA[<h3 id="Vue-项目中的权限识别"><a href="#Vue-项目中的权限识别" class="headerlink" title="Vue 项目中的权限识别"></a>Vue 项目中的权限识别</h3><p>在很多后台管理系统中，常常需要很多的权限设置 以下以几点介绍常规的权限设置</p><ol><li>登陆权限</li><li>页面级权限</li><li>功能按钮级权限</li></ol><h4 id="登陆用户权限"><a href="#登陆用户权限" class="headerlink" title="登陆用户权限"></a>登陆用户权限</h4><p>需要将用户的账户密码提交后台，换取 token 值 放入 vuex 中进行状态储存 进行项目内的数据请求获取/提交 (与后台交互省略) 一般在请求中 授权信息没有登陆获取不到内容</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-comment">// 在axios 业务封装中 将token 添加至请求中</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">getToken</span>())&#123;<br> httpConfig.headers[&#x27;access-<span class="hljs-keyword">token</span>&#x27;] = <span class="hljs-keyword">getToken</span>();<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/img/2022_qx1.png"></p><h4 id="路由页面级权限"><a href="#路由页面级权限" class="headerlink" title="路由页面级权限"></a>路由页面级权限</h4><pre><code>做路由的渲染的一般两种方式1. 本地静态路由加载方式2. 有后台返回路由表数据渲染，使用addRoutes/addRoute加载 (返回的路由表一般在sso配置返回)</code></pre><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-comment">//路由钩子</span><br>router.before<span class="hljs-constructor">Each(<span class="hljs-params">async</span> (<span class="hljs-params">to</span>, <span class="hljs-params">from</span>, <span class="hljs-params">next</span>)</span> =&gt; &#123;<br>    const token = get<span class="hljs-constructor">Token()</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">to</span>?.query?.token) &#123;<br>        set<span class="hljs-constructor">CasToken(<span class="hljs-params">to</span>?.<span class="hljs-params">query</span>?.<span class="hljs-params">token</span>)</span>;<br>    &#125;<br>    <span class="hljs-keyword">let</span> casToken = get<span class="hljs-constructor">CasToken()</span><span class="hljs-operator"> || </span><span class="hljs-keyword">to</span>?.query?.token<span class="hljs-operator"> || </span>&#x27;&#x27;;<br>    <span class="hljs-keyword">if</span> (token) &#123;<br>        <span class="hljs-keyword">if</span> (store.getters<span class="hljs-literal">[&#x27;<span class="hljs-identifier">common</span><span class="hljs-operator">/</span><span class="hljs-identifier">userMenus</span>&#x27;]</span>.length<span class="hljs-operator"> === </span><span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">if</span> (casToken) &#123;<br>                await get<span class="hljs-constructor">UserInfo(&#123; <span class="hljs-params">token</span>: <span class="hljs-params">casToken</span> &#125;, <span class="hljs-params">next</span>)</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                remove<span class="hljs-constructor">Token()</span>;<br>                window.location.href = LOGINURL;<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            next<span class="hljs-literal">()</span>;<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">if</span> (casToken) &#123;<br>            await get<span class="hljs-constructor">UserInfo(&#123; <span class="hljs-params">token</span>: <span class="hljs-params">casToken</span> &#125;, <span class="hljs-params">next</span>)</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            remove<span class="hljs-constructor">Token()</span>;<br>            window.location.href = LOGINURL;<br>        &#125;<br>    &#125;<br>&#125;);<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 获取用户信息</span><br><span class="hljs-comment"> * @param &#123;*&#125;</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">function</span> get<span class="hljs-constructor">UserInfo(<span class="hljs-params">params</span>, <span class="hljs-params">next</span>)</span> &#123;<br>    store<br>        .dispatch(&#x27;common/getUserInfo&#x27;, params)<br>        .<span class="hljs-keyword">then</span>(async<span class="hljs-function"> (<span class="hljs-params">res</span>) =&gt;</span> &#123;<br>            store.commit(&#x27;common/SETTREEMENUS&#x27;, res.user.menus<span class="hljs-literal">[<span class="hljs-number">0</span>]</span>.children);<br>            const accessRoutes = await store.dispatch(<br>                &#x27;permission/generateRoutes&#x27;,<br>                res.user.permissions<br>            );<br>            reset<span class="hljs-constructor">Router()</span>;<br>            router.add<span class="hljs-constructor">Routes(<span class="hljs-params">accessRoutes</span>)</span>;<br>            next<span class="hljs-literal">()</span>;<br>        &#125;)<br>        .catch((errItem) =&gt; &#123;<br>            console.log(&#x27;getUserInfo-error: &#x27;, errItem);<br>        &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="功能按钮级权限"><a href="#功能按钮级权限" class="headerlink" title="功能按钮级权限"></a>功能按钮级权限</h4><p>我们可以使用 v-if 来实现，不过这样做，每个页面都要获取一次权限信息，代码往往很冗余。项目中我们一般通过 封装自定义指令，来实现按钮级的权限控制。</p><h6 id="获取监测权限的数据处理"><a href="#获取监测权限的数据处理" class="headerlink" title="获取监测权限的数据处理"></a>获取监测权限的数据处理</h6><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-comment">// 自定义指令函数</span><br><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Vue</span>.</span></span>directive(&#x27;has&#x27;, &#123;<br>    inserted: <span class="hljs-keyword">function</span>(el, binding) &#123;<br>        <span class="hljs-keyword">if</span> (permission<span class="hljs-constructor">Judge(<span class="hljs-params">binding</span>.<span class="hljs-params">value</span>)</span>) &#123;<br>            el.parentNode.remove<span class="hljs-constructor">Child(<span class="hljs-params">el</span>)</span>;<br>        &#125;<br>&#125;<br><span class="hljs-keyword">function</span> permission<span class="hljs-constructor">Judge(<span class="hljs-params">value</span>)</span> &#123;<br>        <span class="hljs-comment">// 此处代表vuex中储存的按钮菜单数据</span><br>        <span class="hljs-keyword">let</span> <span class="hljs-built_in">list</span> = store.getters<span class="hljs-literal">[&#x27;<span class="hljs-identifier">common</span><span class="hljs-operator">/</span><span class="hljs-identifier">permissionList</span>&#x27;]</span>;<br>        <span class="hljs-keyword">let</span> flag = <span class="hljs-literal">true</span>;<br>        <span class="hljs-built_in">list</span>.<span class="hljs-keyword">for</span><span class="hljs-constructor">Each((<span class="hljs-params">item</span>)</span> =&gt; &#123;<br>            <span class="hljs-keyword">if</span> (item<span class="hljs-operator"> == </span>value) &#123;<br>                flag = <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;);<br>        return flag;<br>    &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><h6 id="封装-放到-单独的自定义指令文件夹中-在-main-文件中引入"><a href="#封装-放到-单独的自定义指令文件夹中-在-main-文件中引入" class="headerlink" title="封装 放到 单独的自定义指令文件夹中 在 main 文件中引入"></a>封装 放到 单独的自定义指令文件夹中 在 main 文件中引入</h6><p>####页面使用</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;ez-button <span class="hljs-attribute">size</span>=<span class="hljs-string">&#x27;mini&#x27;</span>  plain <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;primary&quot;</span> <span class="hljs-attribute">v-has</span>=<span class="hljs-string">&quot;&#x27;school:add&#x27;&quot;</span>  @<span class="hljs-attribute">click</span>=<span class="hljs-string">&quot;onSubmit(&#x27;3&#x27;)&quot;</span>&gt;新增&lt;/ez-button&gt;<br></code></pre></td></tr></table></figure><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>webpack配置学习</title>
    <link href="/2022/06/25/2022/2022-06/06-25webpack%E9%85%8D%E7%BD%AE%E5%AD%A6%E4%B9%A01/"/>
    <url>/2022/06/25/2022/2022-06/06-25webpack%E9%85%8D%E7%BD%AE%E5%AD%A6%E4%B9%A01/</url>
    
    <content type="html"><![CDATA[<h2 id="认识-webpack"><a href="#认识-webpack" class="headerlink" title="认识 webpack"></a>认识 <a href="https://webpack.docschina.org/">webpack</a></h2><p>webpack 是前端一直流行很火的打包，构建工具。 所需要 node 环境 ，今天从零开始学习</p><ul><li>  entry 入口</li><li>  output 出口</li><li>  mode 环境 process.env.NODE_ENV 生产环境还是开发环境等等</li><li>  loader 老生常谈的 用于各源代码进行转换 加载 引用等等</li><li>  plugins 是我们在配置插件的地方。一般用来解决 loader 实现不了的工作</li></ul><h2 id="创建-webpack-工程"><a href="#创建-webpack-工程" class="headerlink" title="创建 webpack 工程"></a>创建 webpack 工程</h2><ol><li>生成 package.json 文件<br>npm init -y</li></ol><p>2.安装 webpack webpack-cli</p><p>npm i -D webpack webpack-cli</p><p>-S 需要发布的<br>—D 不需要发布</p><h2 id="webpack-零配置-默认打包"><a href="#webpack-零配置-默认打包" class="headerlink" title="webpack 零配置 默认打包"></a>webpack 零配置 默认打包</h2><p>只打包 js 压缩 生成 main.js<br>默认出口 dist/main.js<br>默认出口 src/index.js</p><h2 id="安装-webpack-脚手架"><a href="#安装-webpack-脚手架" class="headerlink" title="安装 webpack 脚手架"></a>安装 webpack 脚手架</h2><p>npm i -D webpack-dev-server</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk">devServer: &#123;<br>       <span class="hljs-regexp">//</span> 配置webpack-dev-server<br>       port: <span class="hljs-number">8083</span>, <span class="hljs-regexp">//</span>配置服务器端口<br>       open: true, <span class="hljs-regexp">//</span> 自动打开浏览器<br>       progress: true, <span class="hljs-regexp">//</span>进度<br>       contentBase: <span class="hljs-string">&#x27;./dist&#x27;</span>, <span class="hljs-regexp">//</span>指定的web服务器根目录<br>   &#125;<br></code></pre></td></tr></table></figure><h2 id="css"><a href="#css" class="headerlink" title="css"></a>css</h2><p>webpack 默认只加载 js 不支持 css 加载<br>需要 css 装载器 css-loader style-loader 把 css 直接添加到 Html style 标签中</p><h2 id="装载器执行顺序"><a href="#装载器执行顺序" class="headerlink" title="装载器执行顺序"></a>装载器执行顺序</h2><p>先加载 css 后整合到 html style 标签中 数组从后至前执行</p><h2 id="less-装载器"><a href="#less-装载器" class="headerlink" title="less 装载器"></a>less 装载器</h2><p>npm i -D less-loader</p><h2 id="css-抽取器"><a href="#css-抽取器" class="headerlink" title="css 抽取器"></a>css 抽取器</h2><p>npm i -D mini-css-extract-plugin<br>便于 css 压缩合并 处理缓存<br>npm i -D optimize-css-assets-webpack-plugin<br>js: terser-webpack-plugin</p><h2 id="Es6-Es7-转-Es5"><a href="#Es6-Es7-转-Es5" class="headerlink" title="Es6 Es7 转 Es5"></a>Es6 Es7 转 Es5</h2><p>npm i -D babel-loader<br>@babel/core<br>@babel/preset-env 转换 Es5<br>@babel/plugin-proposal-decorators //装饰器</p><h2 id="js-模块化"><a href="#js-模块化" class="headerlink" title="js 模块化"></a>js 模块化</h2><p>commonjs:<br>导出： module.exports 导入：require()<br>导出： export default xxx 导入 import xx from xxx</p><h1 id="tree-shaking-去掉无引用代码"><a href="#tree-shaking-去掉无引用代码" class="headerlink" title="tree shaking(去掉无引用代码)"></a>tree shaking(去掉无引用代码)</h1><p>webpack4 有这个功能 支持当前 js 中无用的代码<br>webpack5 加强这个功能<br>a.js （有 无引用代码 ）去掉<br>只在生产模式下才会清掉</p><h1 id="打包生成的-dist"><a href="#打包生成的-dist" class="headerlink" title="打包生成的 dist"></a>打包生成的 dist</h1><p>没有分类存储 js css 这些文件<br>在配置中分别输出的 filename 项中 配置 输出路径 js/index.js || css/index.css</p><p>灵活配置 不同的 css /js 文件 将 js/index.js =&gt; js/[name].[hash].js</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">output: &#123;<br>      path: path.resolve(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>), <span class="hljs-regexp">//</span>出口<br>      filename: <span class="hljs-string">&#x27;js/[name].[hash].js&#x27;</span>, <span class="hljs-regexp">//</span>出口名称<br>  &#125;,<br></code></pre></td></tr></table></figure><p>因为浏览器的缓存机制 加上 hash 值 每次改动后的文件长度不一致 所以每次文件都会 确认使用的最新文件</p><h1 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h1><p>使用 improt 引入的文件需要在使用的地方都要做一次引入</p><p>使用 webpack 自带插件 webpack.ProvidepPlugin 可以设置全局变量<br>如 jq 类似第三方包项目中引用</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs actionscript">plugins: [<br>       <span class="hljs-keyword">new</span> webpack.ProvidePlugin(&#123;<br>           $: <span class="hljs-string">&#x27;jqery&#x27;</span>,<br>       &#125;),<br>   ],<br></code></pre></td></tr></table></figure><h2 id="配置后，文件可以不用引入-，但打包体积不会变小"><a href="#配置后，文件可以不用引入-，但打包体积不会变小" class="headerlink" title="配置后，文件可以不用引入 ，但打包体积不会变小"></a>配置后，文件可以不用引入 ，但打包体积不会变小</h2><p>配置 externals 使用 不打包 文件</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">externals :&#123; <span class="hljs-regexp">//</span>排除第三方<br>   jqery :<span class="hljs-string">&#x27;$&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="图片导入"><a href="#图片导入" class="headerlink" title="图片导入"></a>图片导入</h1><p>使用装载器 引入 file-loader | url-loader<br>npm i -D file-loader url-loader<br>在 module 中配置</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs css">module :&#123;<br>    rules:[<br>         &#123;<br>                test: /\.(jpg|png|jpeg)$/,<br>                use: &#123;<br>                    loader: <span class="hljs-string">&#x27;file-loader&#x27;</span>,<br>                    options: &#123; esModule: false&#125;,//使用common<span class="hljs-selector-class">.js</span> 方式<br>                &#125;,<br>            &#125;,<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="使用-html-withimg-loader"><a href="#使用-html-withimg-loader" class="headerlink" title="使用 html-withimg-loader"></a>使用 html-withimg-loader</h2><p>在 html 中加载图片</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs css">module :&#123;<br>    rules:[<br>         &#123;<br>                test: /\.html$/,<br>                use: &#123; loader: <span class="hljs-string">&#x27;html-with-loader&#x27;</span> &#125;,<br>            &#125;,<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="图片加载-url-loader"><a href="#图片加载-url-loader" class="headerlink" title="图片加载 url-loader"></a>图片加载 url-loader</h1><ol><li>对图片小的 做 base64 转换</li><li>对较大的图片 直接提供 url 下载 可以使用 cdn 优化 ，页面请求过多 减少请求次数</li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs awk">module :&#123;<br>    rules:[<br>         &#123;<br>                test: <span class="hljs-regexp">/\.(jpg|png|jpeg)$/</span>,<br>                use: &#123;<br>                    loader: <span class="hljs-string">&#x27;url-loader&#x27;</span>,<br>                    options: &#123; esModule: false,<br>                    limt:<span class="hljs-number">100</span>*<span class="hljs-number">1024</span>,<span class="hljs-regexp">//</span>指小于<span class="hljs-number">100</span>KB的图片自动转换base64<br>                    &#125;,<span class="hljs-regexp">//</span>使用common.js 方式<br>                &#125;,<br>            &#125;,<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="样式兼容"><a href="#样式兼容" class="headerlink" title="样式兼容"></a>样式兼容</h1><p>因为浏览器厂商不一致 导致样式的适配不一致<br>一些 c3 新属性 兼容程度不一致<br>npm i -D outoprefixer postcss-loader</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span> 新建postcss.config.js<br><br><span class="hljs-regexp">//</span>在 page.json 文件中配置<br><span class="hljs-string">&quot;browserslist&quot;</span>:[<br>    <span class="hljs-string">&quot;&gt; 1%&quot;</span>, <span class="hljs-regexp">//</span>使用率大于<span class="hljs-number">1</span>/<span class="hljs-number">100</span><br>    <span class="hljs-string">&quot;last 100 versions&quot;</span>, <span class="hljs-regexp">//</span>对当前浏览器<span class="hljs-number">100</span>个版本转换<br>    <span class="hljs-string">&quot;not ie &lt;= 8&quot;</span> <span class="hljs-regexp">//</span>不转换ie8以下<br>]<br><span class="hljs-regexp">//</span> webpack.config.js 中配置<br>&#123;<br>    test: <span class="hljs-regexp">/\.less$/</span>,<br>    use: [<br>        MiniCssExtractPlugin.loader,<br>        <span class="hljs-string">&#x27;css-loader&#x27;</span>,<br>        <span class="hljs-string">&#x27;less-loader&#x27;</span>,<br>        <span class="hljs-string">&#x27;postcss-loader&#x27;</span>,<br>    ], <span class="hljs-regexp">//</span>从后至前加载<br>&#125;,<br></code></pre></td></tr></table></figure><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>webpack</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原生</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>实现一个阿拉伯数字转中文数字的方法</title>
    <link href="/2022/02/10/2022/2022-02/02-10%E5%B0%81%E8%A3%85%E6%95%B0%E5%AD%97%E8%BD%AC%E5%A4%A7%E5%86%99%E7%9A%84%E6%96%B9%E6%B3%95/"/>
    <url>/2022/02/10/2022/2022-02/02-10%E5%B0%81%E8%A3%85%E6%95%B0%E5%AD%97%E8%BD%AC%E5%A4%A7%E5%86%99%E7%9A%84%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h3 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h3><p>实现一个阿拉伯数字转中文数字的方法</p><h4 id="主要"><a href="#主要" class="headerlink" title="主要"></a>主要</h4><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">function</span> <span class="hljs-title function_">NoToChinese</span>(<span class="hljs-params">num</span>) &#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/^\d*(\.\d*)?$/</span>.test(num)) &#123;<br>        alert(<span class="hljs-string">&quot;Number is wrong!&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Number is wrong!&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">var</span> AA = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-string">&quot;零&quot;</span>, <span class="hljs-string">&quot;一&quot;</span>, <span class="hljs-string">&quot;二&quot;</span>, <span class="hljs-string">&quot;三&quot;</span>, <span class="hljs-string">&quot;四&quot;</span>, <span class="hljs-string">&quot;五&quot;</span>, <span class="hljs-string">&quot;六&quot;</span>, <span class="hljs-string">&quot;七&quot;</span>, <span class="hljs-string">&quot;八&quot;</span>, <span class="hljs-string">&quot;九&quot;</span>);<br>    <span class="hljs-keyword">var</span> BB = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;十&quot;</span>, <span class="hljs-string">&quot;百&quot;</span>, <span class="hljs-string">&quot;千&quot;</span>, <span class="hljs-string">&quot;万&quot;</span>, <span class="hljs-string">&quot;亿&quot;</span>, <span class="hljs-string">&quot;点&quot;</span>, <span class="hljs-string">&quot;&quot;</span>);<br>    <span class="hljs-keyword">var</span> a = (<span class="hljs-string">&quot;&quot;</span> + num).<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/(^0*)/g</span>, <span class="hljs-string">&quot;&quot;</span>).<span class="hljs-built_in">split</span>(<span class="hljs-string">&quot;.&quot;</span>),<br>        k = <span class="hljs-number">0</span>,<br>        re = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = a[<span class="hljs-number">0</span>].<span class="hljs-built_in">length</span> - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;<br>        switch (k) &#123;<br>            case <span class="hljs-number">0</span>:<br>                re = BB[<span class="hljs-number">7</span>] + re;<br>                <span class="hljs-keyword">break</span>;<br>            case <span class="hljs-number">4</span>:<br>                <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">new</span> RegExp(<span class="hljs-string">&quot;0&#123;4&#125;\\d&#123;&quot;</span> + (a[<span class="hljs-number">0</span>].<span class="hljs-built_in">length</span> - i - <span class="hljs-number">1</span>) + <span class="hljs-string">&quot;&#125;$&quot;</span>).test(a[<span class="hljs-number">0</span>]))<br>                    re = BB[<span class="hljs-number">4</span>] + re;<br>                <span class="hljs-keyword">break</span>;<br>            case <span class="hljs-number">8</span>:<br>                re = BB[<span class="hljs-number">5</span>] + re;<br>                BB[<span class="hljs-number">7</span>] = BB[<span class="hljs-number">5</span>];<br>                k = <span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (k % <span class="hljs-number">4</span> == <span class="hljs-number">2</span> &amp;&amp; a[<span class="hljs-number">0</span>].charAt(i + <span class="hljs-number">2</span>) != <span class="hljs-number">0</span> &amp;&amp; a[<span class="hljs-number">0</span>].charAt(i + <span class="hljs-number">1</span>) == <span class="hljs-number">0</span>) re = AA[<span class="hljs-number">0</span>] + re;<br>        <span class="hljs-keyword">if</span> (a[<span class="hljs-number">0</span>].charAt(i) != <span class="hljs-number">0</span>) re = AA[a[<span class="hljs-number">0</span>].charAt(i)] + BB[k % <span class="hljs-number">4</span>] + re;<br>        k++;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (a.<span class="hljs-built_in">length</span> &gt; <span class="hljs-number">1</span>) <span class="hljs-comment">//加上小数部分(如果有小数部分)</span><br>    &#123;<br>        re += BB[<span class="hljs-number">6</span>];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; a[<span class="hljs-number">1</span>].<span class="hljs-built_in">length</span>; i++) re += AA[a[<span class="hljs-number">1</span>].charAt(i)];<br>    &#125;<br>    <span class="hljs-keyword">return</span> re;<br>&#125;;<br><br>NoToChinese(<span class="hljs-number">6666666</span>)<span class="hljs-comment">// 六百六十六万六千六百六十六</span><br><br>NoToChinese(<span class="hljs-number">123456789.87654</span>)<span class="hljs-comment">//一亿二千三百四十五万六千七百八十九点八七六五四</span><br></code></pre></td></tr></table></figure><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原生</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>整理项目中实现的打印功能</title>
    <link href="/2022/01/18/2022/2022-01/01-18pinrt-js%E6%89%93%E5%8D%B0%E6%8F%92%E4%BB%B6/"/>
    <url>/2022/01/18/2022/2022-01/01-18pinrt-js%E6%89%93%E5%8D%B0%E6%8F%92%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<h2 id="打印功能"><a href="#打印功能" class="headerlink" title="打印功能"></a>打印功能</h2><pre><code>打印功能的业务场景有很多种，如项目中的数据图片、一些快照等，常规使用下面两种方式</code></pre><ol><li><a href="https://www.w3cschool.cn/jsref/met-win-print.html">window.print()</a>方法用于打印当前窗口的内容</li><li>后台做打印相关处理，前端利用 pdf 格式性质进行打印<br>浏览文本，当即将浏览到图片时，进行加载动画。</li></ol><h2 id="调用浏览器的-print-方法"><a href="#调用浏览器的-print-方法" class="headerlink" title="调用浏览器的 print 方法"></a>调用浏览器的 print 方法</h2><ol><li>直接调用 window.print()基础方式唤醒浏览器的打印功能，用于打印当前的窗口内容</li></ol><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;pbtn&quot;</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handelPrint&quot;</span>&gt;</span>打 印<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">li</span></span></span><br><span class="hljs-tag"><span class="language-xml">              <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;height: 100px; margin: 10px 0px; background-color: #ccc&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">              <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;item in 50&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">              <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;item&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">          &gt;</span></span><br><span class="language-xml">              打印内容</span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">item</span> &#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml"> methods: &#123;</span><br><span class="language-xml">  handelPrint() &#123;</span><br><span class="language-xml">        window.print();</span><br><span class="language-xml">   &#125;</span><br><span class="language-xml">&#125;</span><br></code></pre></td></tr></table></figure><h2 id="使用插件方式"><a href="#使用插件方式" class="headerlink" title="使用插件方式"></a>使用插件方式</h2><p>使用插件的方式，有很多现成的库，用过两个 <a href="https://www.npmjs.com/package/vue-print-nb">vue-print-nb</a> <a href="https://www.npmjs.com/package/print-js">print-js</a> <a href="https://printjs.crabbly.com/">官网</a></p><h3 id="vue-print-nb-引入-vue-print-nb-博客"><a href="#vue-print-nb-引入-vue-print-nb-博客" class="headerlink" title="vue-print-nb 引入 vue-print-nb 博客"></a>vue-print-nb 引入 <a href="https://www.jianshu.com/p/d19270c237ad">vue-print-nb 博客</a></h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs gradle">npm i vue-<span class="hljs-keyword">print</span>-nb <span class="hljs-comment">// vue2.x</span><br>npm i vue3-<span class="hljs-keyword">print</span>-nb <span class="hljs-comment">// vue3</span><br><span class="hljs-comment">//全局 引入</span><br><span class="hljs-comment">// vue2 与vu3 注册方式有所区别 主要以Options API和 Composition API</span><br><br><span class="hljs-keyword">import</span>  <span class="hljs-keyword">Print</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-print-nb&#x27;</span>  或者 ‘vue3-<span class="hljs-keyword">print</span>-nb’<br><br>Vue.use(<span class="hljs-keyword">Print</span>) <span class="hljs-comment">//vue2.x</span><br>...<br><span class="hljs-comment">// vue3 中是注册到 createApp 函数构建的app 中</span><br><span class="hljs-keyword">import</span> &#123; createApp &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> App <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App&#x27;</span><br>const app = createApp(App)<br>app.use(<span class="hljs-keyword">Print</span>)<br>...<br><span class="hljs-comment">// 局部引用 在对应页面组件中注册</span><br> <span class="hljs-keyword">import</span>  <span class="hljs-keyword">Print</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-print-nb&#x27;</span>  或者 ‘vue3-<span class="hljs-keyword">print</span>-nb’<br><br>directives: &#123; <span class="hljs-keyword">Print</span> &#125;<br></code></pre></td></tr></table></figure><h4 id="实现打印功能"><a href="#实现打印功能" class="headerlink" title="实现打印功能"></a>实现打印功能</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs typescript">&lt;button <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;pbtn&quot;</span> v-<span class="hljs-keyword">if</span>=<span class="hljs-string">&quot;printset&quot;</span>&gt;打 印&lt;/button&gt;<br>      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;printWrap&quot;</span>&gt;</span></span><br><span class="language-xml">          <span class="hljs-tag">&lt;<span class="hljs-name">li</span></span></span><br><span class="hljs-tag"><span class="language-xml">              <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;height: 100px; margin: 10px 0px; background-color: #ccc&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">              <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;item in 50&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">              <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;item&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">          &gt;</span></span><br><span class="language-xml">              打印内容&#123;&#123; item &#125;&#125;</span><br><span class="language-xml">          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml"> <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;noprint&quot;</span>&gt;</span>不需要打印的内容<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> // 不需要打印的内容 添加noprint 类</span><br><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br><br> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;page-break-after: always;&quot;</span>&gt;</span>我是本页的末尾哦<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span> <span class="hljs-comment">//需要分页的</span><br><span class="hljs-title function_">data</span>(<span class="hljs-params"></span>)&#123;<br>   <span class="hljs-keyword">return</span> &#123;<br> <span class="hljs-comment">// 配置项</span><br>  <span class="hljs-attr">printset</span>:&#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&#x27;printWrap&#x27;</span>,<br>    <span class="hljs-attr">popTitle</span>: <span class="hljs-string">&#x27;打印&#x27;</span>, <span class="hljs-comment">// 打印配置页上方标题</span><br>    <span class="hljs-attr">extraHead</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">//最上方的头部文字，附加在head标签上的额外标签,使用逗号分隔</span><br>    <span class="hljs-attr">preview</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 是否启动预览模式，默认是false（开启预览模式，可以先预览后打印）</span><br>    <span class="hljs-attr">previewTitle</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 打印预览的标题（开启预览模式后出现）,</span><br>    <span class="hljs-attr">previewPrintBtnLabel</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 打印预览的标题的下方按钮文本，点击可进入打印（开启预览模式后出现）</span><br>    <span class="hljs-attr">zIndex</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 预览的窗口的z-index，默认是 20002（此值要高一些，这涉及到预览模式是否显示在最上面）</span><br>    <span class="hljs-title function_">previewBeforeOpenCallback</span>(<span class="hljs-params"></span>) &#123;&#125;, <span class="hljs-comment">//预览窗口打开之前的callback（开启预览模式调用）</span><br>    <span class="hljs-title function_">previewOpenCallback</span>(<span class="hljs-params"></span>) &#123;&#125;, <span class="hljs-comment">// 预览窗口打开之后的callback（开启预览模式调用）</span><br>    <span class="hljs-title function_">beforeOpenCallback</span>(<span class="hljs-params"></span>) &#123;&#125;, <span class="hljs-comment">// 开启打印前的回调事件</span><br>    <span class="hljs-title function_">openCallback</span>(<span class="hljs-params"></span>) &#123;&#125;, <span class="hljs-comment">// 调用打印之后的回调事件</span><br>    <span class="hljs-title function_">closeCallback</span>(<span class="hljs-params"></span>) &#123;&#125;, <span class="hljs-comment">//关闭打印的回调事件（无法确定点击的是确认还是取消）</span><br>    <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>    <span class="hljs-attr">standard</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>    <span class="hljs-attr">extraCss</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>  &#125;<br>   &#125;<br>&#125;<br> <span class="hljs-comment">// 样式</span><br>&lt;style media=<span class="hljs-string">&quot;print&quot;</span>&gt;<br><span class="hljs-meta">@page</span> &#123;<br>  <span class="hljs-attr">size</span>: auto;<br>  <span class="hljs-attr">margin</span>: <span class="hljs-number">0</span> 10mm;<br>&#125;<br><br>html &#123;<br>  background-<span class="hljs-attr">color</span>: #fff;<br>  <span class="hljs-attr">height</span>: auto;<br>  <span class="hljs-attr">margin</span>: 0px;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><h3 id="print-js-插件打印"><a href="#print-js-插件打印" class="headerlink" title="print-js 插件打印"></a><a href="https://www.npmjs.com/package/print-js">print-js</a> 插件打印</h3><p>一篇比较详细的<a href="https://www.jianshu.com/p/f6f09dd9f7db">博客</a></p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-comment">//安装</span><br>npm i <span class="hljs-keyword">print</span>-js -S<br><br><span class="hljs-comment">// 引入</span><br><span class="hljs-keyword">import</span> <span class="hljs-keyword">Print</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;print-js&#x27;</span><br><br></code></pre></td></tr></table></figure><h4 id="实现打印功能-1"><a href="#实现打印功能-1" class="headerlink" title="实现打印功能"></a>实现打印功能</h4><p><img src="/img/2022/print_1.png" alt="print_1"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;template&gt;<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;pbtn&quot;</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;bindPrint&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            &gt;</span>打 印&lt;/el-button</span><br><span class="language-xml">        &gt;</span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;box_wrap&quot;</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;printWrap&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;print-page-wrap&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;printWrap&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;page-header&quot;</span>&gt;</span></span><br><span class="language-xml">                  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;Page_title&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;Page_title&quot;</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;print-h2 fw-6&quot;</span>&gt;</span></span><br><span class="language-xml">                        &#123;&#123; headerTitle &#125;&#125;</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;print-h3 fw-6&quot;</span>&gt;</span>治疗记录<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span><br><span class="language-xml">                  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;print-base-wrap&quot;</span>&gt;</span></span><br><span class="language-xml">                       <span class="hljs-tag">&lt;<span class="hljs-name">InfoSpan</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;姓名：&quot;</span> <span class="hljs-attr">:val</span>=<span class="hljs-string">&quot;infoPrint.consumerName&quot;</span> /&gt;</span></span><br><span class="language-xml">                       <span class="hljs-tag">&lt;<span class="hljs-name">InfoSpan</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;性别：&quot;</span> <span class="hljs-attr">:val</span>=<span class="hljs-string">&quot;infoPrint.gender&quot;</span> /&gt;</span></span><br><span class="language-xml">                       <span class="hljs-tag">&lt;<span class="hljs-name">InfoSpan</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;年龄：&quot;</span> <span class="hljs-attr">:val</span>=<span class="hljs-string">&quot;infoPrint.consumerAge&quot;</span> /&gt;</span></span><br><span class="language-xml">                       <span class="hljs-tag">&lt;<span class="hljs-name">InfoSpan</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;家床号：&quot;</span> <span class="hljs-attr">:val</span>=<span class="hljs-string">&quot;infoPrint.bedRegId&quot;</span> /&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;mtb_10 fsw-28&quot;</span>&gt;</span>康复诊断:<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;print&quot;</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">Gtable</span></span></span><br><span class="hljs-tag"><span class="language-xml">   <span class="hljs-attr">:titles</span>=<span class="hljs-string">&quot;titles&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">   <span class="hljs-attr">:tabData</span>=<span class="hljs-string">&quot;tabdata&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">   <span class="hljs-attr">operateShow</span></span></span><br><span class="hljs-tag"><span class="language-xml">   <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;mini&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">   <span class="hljs-attr">border</span></span></span><br><span class="hljs-tag"><span class="language-xml">   &gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">Gtable</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">h5</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;h5_title&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;(item, index) in detaildata&quot;</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;index&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Gtable</span></span></span><br><span class="hljs-tag"><span class="language-xml">       <span class="hljs-attr">:titles</span>=<span class="hljs-string">&quot;titles&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">       <span class="hljs-attr">:tabData</span>=<span class="hljs-string">&quot;item&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">       <span class="hljs-attr">operateShow</span></span></span><br><span class="hljs-tag"><span class="language-xml">   <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;mini&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">   <span class="hljs-attr">border</span></span></span><br><span class="hljs-tag"><span class="language-xml">    &gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">Gtable</span>&gt;</span></span><br><span class="language-xml">                        <span class="hljs-tag">&lt;<span class="hljs-name">footer</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;print-footer&quot;</span>&gt;</span></span><br><span class="language-xml">                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                                疗效评定：</span><br><span class="language-xml">                                <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;info-val&quot;</span>&gt;</span>&#123;&#123;</span><br><span class="language-xml">                                    item.effectName</span><br><span class="language-xml">                                &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                                签名：</span><br><span class="language-xml">                                <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;info-val&quot;</span>&gt;</span>&#123;&#123;</span><br><span class="language-xml">                                    item.effectDoctorName</span><br><span class="language-xml">                                &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                        <span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><br><span class="hljs-attr">methods</span>:&#123;<br>   <span class="hljs-title function_">bindPrint</span>(<span class="hljs-params"></span>) &#123;<br><br>            <span class="hljs-title function_">printJS</span>(&#123;<br>                <span class="hljs-attr">printable</span>: <span class="hljs-string">&#x27;printWrap&#x27;</span>, <span class="hljs-comment">//绑定的id</span><br>                <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;html&#x27;</span>, <span class="hljs-comment">//类型</span><br>                <span class="hljs-attr">maxWidth</span>: <span class="hljs-number">1300</span>, <span class="hljs-comment">// 打印的尺寸</span><br>                <span class="hljs-attr">header</span>: <span class="hljs-string">`&lt;div style=&quot;text-align: center; line-height: 16px;&quot;&gt;&lt;h1  &gt; <span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.headerTitle&#125;</span>&lt;/h1&gt;&lt;h2 style=&quot;line-height: 16px; font-size: 28px;&quot; &gt;治疗记录&lt;/h2&gt;&lt;/div&gt;`</span>,<span class="hljs-comment">// 设置的打印头标题</span><br>                <span class="hljs-attr">ignoreElements</span>: [<span class="hljs-string">&#x27;Page_title&#x27;</span>],<span class="hljs-comment">//不打印的元素id</span><br>                <span class="hljs-attr">targetStyles</span>: [<span class="hljs-string">&#x27;*&#x27;</span>],<span class="hljs-comment">// 继承属性</span><br>                <span class="hljs-attr">scanStyles</span>: <span class="hljs-literal">true</span>,<span class="hljs-comment">///继承当前html结构所用的样式表.</span><br>                <span class="hljs-attr">style</span>: <span class="hljs-string">&#x27;@page &#123; margin: 0 10mm &#125;&#x27;</span>,<span class="hljs-comment">//可选 打印时去掉页眉页尾</span><br>        &#125;);<br>    &#125;,<br>&#125;<br><br></code></pre></td></tr></table></figure><h6 id="调整打印字体"><a href="#调整打印字体" class="headerlink" title="调整打印字体"></a>调整打印字体</h6><p>在这里调整 font_size 的数值 一定程度下 浏览器打印字体不会变小<br><img src="/img/2022/print_2.png" alt="print_2"></p><h3 id="服务端返回blob流-转换为-pdf-唤醒浏览器-pdf-打印-window-open"><a href="#服务端返回blob流-转换为-pdf-唤醒浏览器-pdf-打印-window-open" class="headerlink" title="服务端返回blob流 转换为 pdf 唤醒浏览器 pdf 打印 window.open()"></a>服务端返回<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Blob">blob</a>流 转换为 pdf 唤醒浏览器 pdf 打印 <a href="https://www.runoob.com/jsref/met-win-open.html">window.open()</a></h3><p>Blob 对象表示一个不可变、原始数据的类文件对象。它的数据可以按文本或二进制的格式进行读取，也可以转换成 ReadableStream 来用于数据操作</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 封装api</span><br>     openPdf (url, params = &#123;&#125;) &#123;<br>         <span class="hljs-title function_">get</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;FDAPP_HOST&#125;</span><span class="hljs-subst">$&#123;url&#125;</span>`</span>, &#123; params,<span class="hljs-attr">responseType</span>: <span class="hljs-string">&#x27;blob&#x27;</span> ,<span class="hljs-attr">headers</span>: &#123; <span class="hljs-attr">backdoor</span>: <span class="hljs-literal">true</span>&#125; &#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>             <span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blob</span>([res], &#123;<br>                 <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;application/pdf&#x27;</span><br>             &#125;);<br>             <span class="hljs-keyword">var</span> href = <span class="hljs-variable language_">window</span>.<span class="hljs-property">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);<br>             <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">open</span>(href);<br>         &#125;, <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;<br>             <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err);<br>         &#125;);<br>     &#125;<br></code></pre></td></tr></table></figure><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>插件</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>封装一个表单验证（针对）</title>
    <link href="/2022/01/06/2022/2022-01/01-06%E8%A1%A8%E5%8D%95%E6%A0%A1%E9%AA%8C%E5%B0%81%E8%A3%85/"/>
    <url>/2022/01/06/2022/2022-01/01-06%E8%A1%A8%E5%8D%95%E6%A0%A1%E9%AA%8C%E5%B0%81%E8%A3%85/</url>
    
    <content type="html"><![CDATA[<h3 id="解决问题？"><a href="#解决问题？" class="headerlink" title="解决问题？"></a>解决问题？</h3><p>由于在工作中，公司 h5 项目 对 vant 的 表单验证 不太理想，业务需要 toast 提示验证，而非表单中的函数验证。所以在验证校验时，使用了大量的 if else 判断。代码臃肿 重复 。这些面向过程的编码行为逻辑又不能进行封装。</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">var</span> name = this.username.value;<br><span class="hljs-keyword">var</span> pwd1 = this.password1.value;<br><span class="hljs-keyword">var</span> pwd2 = this.password2.value;<br><span class="hljs-keyword">var</span> tel = this.phone.value;<br><span class="hljs-keyword">if</span> (name.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/(^\s*)|(\s*$)/g</span>, <span class="hljs-string">&quot;&quot;</span>) === <span class="hljs-string">&quot;&quot;</span>) &#123;<br>    alert(<span class="hljs-string">&#x27;用户名不能为空&#x27;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br><span class="hljs-keyword">if</span> (pwd1.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/(^\s*)|(\s*$)/g</span>, <span class="hljs-string">&quot;&quot;</span>) === <span class="hljs-string">&quot;&quot;</span>) &#123;<br>    alert(<span class="hljs-string">&#x27;密码不能为空&#x27;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br> <span class="hljs-keyword">if</span> (pwd2.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/(^\s*)|(\s*$)/g</span>, <span class="hljs-string">&quot;&quot;</span>) === <span class="hljs-string">&quot;&quot;</span>) &#123;<br>    alert(<span class="hljs-string">&#x27;确认密码不能为空&#x27;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br><span class="hljs-keyword">if</span> (pwd2 !== pwd1) &#123;<br>    alert(<span class="hljs-string">&#x27;确认密码与原密码不相同！&#x27;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br><span class="hljs-keyword">if</span> (tel.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/(^\s*)|(\s*$)/g</span>, <span class="hljs-string">&quot;&quot;</span>) === <span class="hljs-string">&quot;&quot;</span>) &#123;<br>    alert(<span class="hljs-string">&#x27;手机号码不能为空&#x27;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br><span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/^1[3,4,5,7,8,9][0-9]\d&#123;8&#125;$/</span>.test(tel)) &#123;<br>    alert(<span class="hljs-string">&#x27;手机号码格式不正确&#x27;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br><br></code></pre></td></tr></table></figure><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><ul><li>  首先将 定义一个对像 rules 将校验规则存起来</li><li>  将逻辑进行抽离 校验值 与 Dom 无关（因为不用将某项的提示信息放到当前项）</li><li>  推理，使用方式 <code>&#123; formKey:[&#123;verifyName：&#39;isRequired&#39;,verifyVal:&#39;11&#39;,msg:&#39;提示信息&#39;&#125;] &#125;</code>（这里将校验值传递进来，便于处理，不用通过虚拟 dom 获取 ）</li><li>  封装处理方法 获取对象中 key 的数组 每一项的校验名称、值、错误提示 一一比对</li></ul><h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Validate</span>(<span class="hljs-params"></span>) &#123;&#125;<br><span class="hljs-comment">// 四个功能函数， 通过外部 调用rules[名称]获取</span><br><span class="hljs-title class_">Validate</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">rules</span> = &#123;<br>    <span class="hljs-comment">// 是否手机号</span><br>    <span class="hljs-attr">isMobile</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">str</span>) &#123;<br>        <span class="hljs-keyword">let</span> rule = <span class="hljs-regexp">/^1[3,4,5,7,8,9][0-9]\d&#123;8&#125;$/</span>;<br>        <span class="hljs-keyword">return</span> rule.<span class="hljs-title function_">test</span>(str);<br>    &#125;,<br>    <span class="hljs-comment">// 是否必填</span><br>    <span class="hljs-attr">isRequired</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">str</span>) &#123;<br>        <span class="hljs-comment">// 除去首尾空格</span><br>        <span class="hljs-keyword">let</span> value = str.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/(^\s*)|(\s*$)/g</span>, <span class="hljs-string">&quot;&quot;</span>);<br>        <span class="hljs-keyword">return</span> value !== <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;,<br>    <span class="hljs-comment">// 最小长度</span><br>    <span class="hljs-attr">minLength</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">str, length</span>) &#123;<br>        <span class="hljs-keyword">let</span> strLength = str.<span class="hljs-property">length</span>;<br>        <span class="hljs-keyword">return</span> strLength &gt;= length;<br>    &#125;,<br>    <span class="hljs-comment">// 是否相等</span><br>    <span class="hljs-attr">isEqual</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">// 可以接收多个参数比较</span><br>        <span class="hljs-keyword">let</span> args = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">slice</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>);<br>        <span class="hljs-comment">// 取首项与后面所有的项比较，如果每个都相等，就返回true</span><br>        <span class="hljs-keyword">let</span> equal = args.<span class="hljs-title function_">every</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) &#123;<br>            <span class="hljs-keyword">return</span> value === args[<span class="hljs-number">0</span>];<br>        &#125;)<br>        <span class="hljs-keyword">return</span> equal;<br>    &#125;<br>&#125;<br><span class="hljs-title class_">Validate</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">test</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">rules</span>) &#123;<br>    <span class="hljs-keyword">let</span> v = <span class="hljs-variable language_">this</span>;<br>    <span class="hljs-keyword">let</span> valid; <span class="hljs-comment">// 保存校验结果</span><br>    <span class="hljs-comment">// 外部传递的规则配置参数rules</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> rules) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; rules[key].<span class="hljs-property">length</span>; i++) &#123; <span class="hljs-comment">// 遍历每一个字段的校验规则</span><br>            <span class="hljs-keyword">let</span> ruleName = rules[key][i].<span class="hljs-property">rule</span>; <span class="hljs-comment">// 规则名</span><br>            <span class="hljs-keyword">let</span> value = rules[key][i].<span class="hljs-property">value</span>; <span class="hljs-comment">// 获校验值</span><br>            <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(value)) &#123; <span class="hljs-comment">// 统一校验值为数组类型</span><br>                value = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(value)<br>            &#125;<br>            <span class="hljs-keyword">let</span> result = v.<span class="hljs-property">rules</span>[ruleName].<span class="hljs-title function_">apply</span>(v, value); <span class="hljs-comment">// 调用校验规则方法进行校验</span><br>            <span class="hljs-keyword">if</span> (!result) &#123; <span class="hljs-comment">// 如果校验不通过，就获取校验结果信息，并立即跳出循环不再执行，节约消耗</span><br>                valid = &#123;<br>                    <span class="hljs-attr">errValue</span>: key,<br>                    <span class="hljs-attr">errMsg</span>: rules[key][i].<span class="hljs-property">message</span><br>                &#125;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (valid) &#123; <span class="hljs-comment">// 如果有了校验结果，代表存在不通过的字段，则立即停止循环，节约消耗</span><br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> valid; <span class="hljs-comment">// 把校验结果返回出去</span><br>&#125;<br><span class="hljs-comment">// 封装之后 我们只需每次将构造函数实例话 进行这样的穿参</span><br><span class="hljs-keyword">let</span> formData = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;form&#x27;</span>)<br>formData.<span class="hljs-property">onsubmit</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    event.<span class="hljs-title function_">preventDefault</span>()<br>    <span class="hljs-keyword">let</span> validator = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Validate</span>();<br>    <span class="hljs-comment">// 验证规则 抽离出来， 便于更为灵活的应用验证器</span><br>    <span class="hljs-comment">//  验证器已经和DOM解耦，只关心规则和数据以及message</span><br>    <span class="hljs-keyword">let</span> res = validator.<span class="hljs-title function_">test</span>(&#123; <span class="hljs-comment">// 和id一致才能获取</span><br>        <span class="hljs-attr">username</span>: [&#123;<br>            <span class="hljs-attr">rule</span>: <span class="hljs-string">&#x27;isRequired&#x27;</span>,<br>            <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">username</span>.<span class="hljs-property">value</span>,<br>            <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;用户名不能为空！&#x27;</span><br>        &#125;],<br>        <span class="hljs-attr">password1</span>: [&#123;<br>                <span class="hljs-attr">rule</span>: <span class="hljs-string">&#x27;isRequired&#x27;</span>,<br>                <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">password1</span>.<span class="hljs-property">value</span>,<br>                <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;密码不能为空！&#x27;</span><br>            &#125;,<br>            &#123;<br>                <span class="hljs-attr">rule</span>: <span class="hljs-string">&#x27;minLength&#x27;</span>,<br>                <span class="hljs-attr">value</span>: [<span class="hljs-variable language_">this</span>.<span class="hljs-property">password1</span>.<span class="hljs-property">value</span>, <span class="hljs-number">6</span>],<br>                <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;密码长度不能小于6个字符！&#x27;</span><br>            &#125;<br>        ],<br>        <span class="hljs-attr">password2</span>: [&#123;<br>                <span class="hljs-attr">rule</span>: <span class="hljs-string">&#x27;isRequired&#x27;</span>,<br>                <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">password2</span>.<span class="hljs-property">value</span>,<br>                <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;确认密码不能为空！&#x27;</span><br>            &#125;,<br>            &#123;<br>                <span class="hljs-attr">rule</span>: <span class="hljs-string">&#x27;minLength&#x27;</span>,<br>                <span class="hljs-attr">value</span>: [<span class="hljs-variable language_">this</span>.<span class="hljs-property">password2</span>.<span class="hljs-property">value</span>, <span class="hljs-number">6</span>],<br>                <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;确认密码长度不能小于6个字符！&#x27;</span><br>            &#125;,<br>            &#123;<br>                <span class="hljs-attr">rule</span>: <span class="hljs-string">&#x27;isEqual&#x27;</span>,<br>                <span class="hljs-attr">value</span>: [<span class="hljs-variable language_">this</span>.<span class="hljs-property">password2</span>.<span class="hljs-property">value</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">password1</span>.<span class="hljs-property">value</span>],<br>                <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;确认密码与原密码不相同！&#x27;</span><br>            &#125;<br>        ],<br>    &#125;)<br>    <span class="hljs-keyword">if</span> (res) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">$tost</span>.<span class="hljs-title function_">error</span>(res)<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;校验通过&#x27;</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>![BG图片](/img/default.jpg)</code><br><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原生</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vue2与vue3项目写法注意</title>
    <link href="/2021/12/25/2021/2021-12/12-25vue2&amp;vue3%20%E5%86%99%E6%B3%95%E6%B3%A8%E6%84%8F/"/>
    <url>/2021/12/25/2021/2021-12/12-25vue2&amp;vue3%20%E5%86%99%E6%B3%95%E6%B3%A8%E6%84%8F/</url>
    
    <content type="html"><![CDATA[<h4 id="1-执行入口"><a href="#1-执行入口" class="headerlink" title="1. 执行入口"></a>1. 执行入口</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//vue2.x</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App.vue&#x27;</span>;<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>    <span class="hljs-attr">el</span>: <span class="hljs-string">&#x27;#app&#x27;</span>,<br>router,<br>store,<br>    <span class="hljs-attr">render</span>: <span class="hljs-function">(<span class="hljs-params">h</span>) =&gt;</span> <span class="hljs-title function_">h</span>(<span class="hljs-title class_">App</span>),<br>&#125;);<br><span class="hljs-comment">//vue3</span><br><span class="hljs-keyword">import</span> &#123; createApp &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App.vue&#x27;</span><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)<br>app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">&#x27;#app&#x27;</span>) <span class="hljs-comment">// 挂载 app.use(store).use(router)...</span><br></code></pre></td></tr></table></figure><h4 id="2-路由挂载"><a href="#2-路由挂载" class="headerlink" title="2. 路由挂载"></a>2. 路由挂载</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//vue2.x</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-title class_">VueRouter</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span>;<br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">VueRouter</span>);<br><span class="hljs-keyword">import</span> &#123; <span class="hljs-variable constant_">ROUTER_BASEPATH</span>,  &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../utils/constant&#x27;</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">createRouter</span> = (<span class="hljs-params"></span>) =&gt;<br> <span class="hljs-keyword">new</span> <span class="hljs-title class_">VueRouter</span>(&#123;<br>        <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;history&#x27;</span>,<br>base :<span class="hljs-string">&#x27;ROUTER_BASEPATH&#x27;</span>,<br>     ...<br>    &#125;);<br><span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>();<br>router.<span class="hljs-property">beforeEach</span>...<br>router.<span class="hljs-title function_">addRoutes</span>(menus);<span class="hljs-comment">//addRoute</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router;<br><span class="hljs-comment">//vue3 必须要使用vue-router(v4)</span><br><br><span class="hljs-keyword">import</span> &#123; createRouter, createWebHashHistory,createWebHistory &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-variable constant_">ROUTER_BASEPATH</span>,  &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../utils/constant&#x27;</span>;<br><span class="hljs-comment">//  创建router，new VueRouter使用createRouter()</span><br><span class="hljs-comment">//  路由模式mode 更换为对应api，createWebHashHistory()  createWebHistory() base在函数中传参</span><br><span class="hljs-comment">// &lt;router-link&gt;已经没有tag属性的，可以用custom和插槽实现自定义。</span><br><span class="hljs-comment">// 新增了几个组合API：useRoute/useRouter/useLink。</span><br><span class="hljs-comment">// Vue3中，只保留了 addRoute() 方法</span><br><span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>(&#123; <span class="hljs-comment">//</span><br>  <span class="hljs-attr">history</span>: <span class="hljs-title function_">createWebHistory</span>(<span class="hljs-variable constant_">ROUTER_BASEPATH</span>), <span class="hljs-comment">// hash createWebHashHistory() 路由模式有相对应函数</span><br>  ...<br>&#125;)<br><br></code></pre></td></tr></table></figure><h4 id="3-vue-生命周期"><a href="#3-vue-生命周期" class="headerlink" title="3. vue 生命周期"></a>3. vue 生命周期</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">//vue3中api是需要手动引入到组件中使用</span><br><span class="hljs-keyword">import</span> &#123;onMounted &#125; from <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-comment">//vue2.x  ||   vue3</span><br>beforeCreate      =&gt; setup(data,method)<br>created           =&gt; setup<br>beforeMount       =&gt; onBeforeMount<br>Mounted           =&gt; onMounted<br>beforeUptate      =&gt; onBeforeUpdate<br>Updated           =&gt; onUpdated<br>beforeDestroy     =&gt; onBeforeUnmount<br>Destroyed         =&gt; onUnmounted<br></code></pre></td></tr></table></figure><h4 id="4-响应数据"><a href="#4-响应数据" class="headerlink" title="4. 响应数据"></a>4. 响应数据</h4><p>vue2.x<a href="https://v2.cn.vuejs.org/v2/guide/reactivity.html">Object.defineProprty</a> 与 vue3<a href="https://cn.vuejs.org/guide/extras/reactivity-in-depth.html#how-reactivity-works-in-vue">porxy</a> 原理不做展开介绍</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//vue2.x</span><br>vue.<span class="hljs-property">Observable</span><br> data 中的数据，组件创建时候就会作于依赖收集响应值<br> <span class="hljs-title class_">Vue</span>.<span class="hljs-property">set</span><br><span class="hljs-comment">//vue3</span><br><span class="hljs-keyword">import</span> &#123; reactive,ref,torefs,computed ,watch&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br><span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>(&#123;<br><span class="hljs-attr">conut</span>:<span class="hljs-number">0</span>,<br><span class="hljs-attr">value</span>:<span class="hljs-number">1</span>,<br>&#125;)<br>&#125;<br><span class="hljs-keyword">const</span> val = <span class="hljs-title function_">ref</span>(<span class="hljs-number">11</span>)<br><span class="hljs-comment">//计算属性的使用</span><br><span class="hljs-keyword">const</span> contVal = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> val.<span class="hljs-property">value</span> +<span class="hljs-number">1</span>)<br><span class="hljs-comment">// 监听</span><br><span class="hljs-title function_">watch</span>(val,<span class="hljs-function">() =&gt;</span> &#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;val&#x27;</span>,val.<span class="hljs-property">value</span>)<br>&#125;)<br><span class="hljs-comment">// 监听reactive值</span><br><span class="hljs-title function_">watch</span>(state,<span class="hljs-function">(<span class="hljs-params">newVal,oldVal</span>) =&gt;</span> &#123;<br>...<br>&#125;)<br><span class="hljs-comment">// 监听reactive属性值</span><br><span class="hljs-keyword">const</span> stopWatch = <span class="hljs-title function_">watch</span>(<span class="hljs-function">() =&gt;</span> state.<span class="hljs-property">value</span>,<span class="hljs-function">(<span class="hljs-params">newVal,oldVal</span>) =&gt;</span> &#123;<br>...<br>&#125;)<br><span class="hljs-comment">// 在setup()函数内创建的watch监视，会在当前组件被销毁的时候自动停止。如果想要明确的停止某个监视，可以调用watch()函数的返回值即可</span><br><span class="hljs-title function_">stopWatch</span>()<br><span class="hljs-keyword">return</span> &#123;<br>...<span class="hljs-title function_">torefs</span>(state)<br>&#125;<br>&#125;<br><br><span class="hljs-comment">//toRefs(）一般配合reactive()和…一起使用</span><br></code></pre></td></tr></table></figure><h4 id="1-模板内-ref-使用"><a href="#1-模板内-ref-使用" class="headerlink" title="1. 模板内 ref 使用"></a>1. 模板内 ref 使用</h4><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs d"><br><span class="hljs-comment">//vue2.x   this.$refs[&#x27;xxx&#x27;]就可以获取对应节点信息方便操作</span><br>&lt;<span class="hljs-keyword">template</span>&gt;<br>    &lt;div <span class="hljs-keyword">ref</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;&lt;/div&gt;<br>&lt;/<span class="hljs-keyword">template</span>&gt;<br><span class="hljs-keyword">this</span>.$refs.box<br><br><span class="hljs-comment">//vue3</span><br>在vue3中使用组合式API的setup()方法的时候，可以使用新的函数<span class="hljs-keyword">ref</span>()。<br>使用<span class="hljs-keyword">ref</span>()函数创建DOM引用,需在onMounted中获取<br>&lt;<span class="hljs-keyword">template</span>&gt;<br>    &lt;div <span class="hljs-keyword">ref</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;&lt;/div&gt;<br>&lt;/<span class="hljs-keyword">template</span>&gt;<br>setup()&#123;<br>onMounted(() =&gt; &#123;<br>   <span class="hljs-keyword">const</span> box= <span class="hljs-keyword">ref</span>(<span class="hljs-literal">null</span>)<br>&#125;)<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3-设置全局变量"><a href="#3-设置全局变量" class="headerlink" title="3. 设置全局变量"></a>3. 设置全局变量</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>vue2.x<br><span class="hljs-regexp">//</span> ue2.x挂载全局是使用 Vue.prototype.<span class="hljs-variable">$xxxx</span>=xxx 的形式来挂载，然后通过 this.<span class="hljs-variable">$xxx</span>来获取挂载到全局的变量或者方法。<br>Vue.prototype.<span class="hljs-variable">$http</span> = () =&gt; &#123;&#125;<br><span class="hljs-regexp">//</span>vue3<br><span class="hljs-regexp">//</span> 这在 Vue <span class="hljs-number">3</span> 中，就等同于 config.globalProperties。这些 property 将被复制到应用中作为实例化组件的一部分。<br>const app = createApp(&#123;&#125;)<br>app.config.globalProperties.<span class="hljs-variable">$http</span> = () =&gt; &#123;&#125;<br>或者利用依赖注入的方式 Provide / Inject<br>可以将全局变量放在根组件的 provide 中，这样所有的组件都能使用到这个变量。<br>如果需要变量是响应式的，就需要在 provide 的时候使用 ref 或者 reactive 包装变量。<br></code></pre></td></tr></table></figure><h4 id="3-vue-自定义指令-v"><a href="#3-vue-自定义指令-v" class="headerlink" title="3. vue 自定义指令 v-"></a>3. vue 自定义指令 v-</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 差异不大，主要载体发生变化。vue2.x中 在Vue挂载 vue3在createApp构建app上 局部基本一致与setup平级</span><br><span class="hljs-comment">// 主要 指令的生命周期</span><br>bind—&gt;beforeMount<br>inserted—&gt;mounted<br>beforeUpdate （元素自身更新前调用）<br>update vue3中已删除（和updated基本相同，因此被移除，可使用updated代替）<br>componentUpdated—&gt;updated<br>beforeUnmount（与组件生命周期相似，元素将要被移除之前调用）<br>unbind—&gt;unmounted<br><span class="hljs-comment">//vue2.x</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-comment">// 全局</span><br>vue.<span class="hljs-title function_">directive</span>(<span class="hljs-string">&#x27;name&#x27;</span>,&#123;<br>....<br>&#125;)<br><span class="hljs-comment">//局部</span><br><span class="hljs-attr">directives</span>:&#123;<br><span class="hljs-attr">name</span>:&#123;<br>...<br>&#125;<br>&#125;<br><span class="hljs-comment">//vue3</span><br><span class="hljs-comment">// 全局</span><br><span class="hljs-keyword">import</span> &#123; createApp &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App.vue&#x27;</span><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)<br>app.<span class="hljs-title function_">directive</span>(<span class="hljs-string">&#x27;name&#x27;</span>,&#123;<br>....<br>&#125;)<br><span class="hljs-comment">//局部</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br><span class="hljs-attr">directives</span>:&#123;<br><span class="hljs-attr">name</span>:&#123;<br>...<br>&#125;<br>&#125;,<br><span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>)&#123;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原生</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TS基础学习0到1</title>
    <link href="/2021/12/17/2021/2021-12/12-17Ts%D1%A7%CF%B0/"/>
    <url>/2021/12/17/2021/2021-12/12-17Ts%D1%A7%CF%B0/</url>
    
    <content type="html"><![CDATA[<h2 id="认识-TypeScript"><a href="#认识-TypeScript" class="headerlink" title="认识 TypeScript"></a>认识 <a href="https://www.tslang.cn/docS">TypeScript</a></h2><p>因为 JavaScript 的‘灵活’性，在编码过程中并不会报错，如：修改某个 number 类型 使用是用来做运算 ，变成了 string. 类似问题，参数不符预期。对于多人开发的大型项目，往往会出现这样那样的问题。而 typeScript 可以 解决这些问题，类型断言。将错误在编译过程中暴露出来，从而减少运行中报错问题</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p><code>npm install -g typescript</code><br>可以安装 ts-node 直接运行.ts 文件 <code>npm install -g ts-node</code></p><h4 id="认识类型"><a href="#认识类型" class="headerlink" title="认识类型"></a>认识类型</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">isDone</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0o744</span>;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">num1</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">6</span>;<br> <span class="hljs-keyword">let</span> <span class="hljs-attr">str</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">&#x27;33&#x27;</span>;<br> <span class="hljs-keyword">let</span> <span class="hljs-attr">str1</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">`sss<span class="hljs-subst">$&#123;num&#125;</span>s`</span>; <span class="hljs-comment">//支持字符串模版</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">arr1</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">34</span>, <span class="hljs-number">5</span>];<br><span class="hljs-keyword">let</span> <span class="hljs-attr">arr2</span>: <span class="hljs-built_in">string</span>[] = [<span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>];<br><span class="hljs-comment">// 泛型</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">arr3</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt; = [<span class="hljs-number">1</span>, <span class="hljs-number">23</span>, <span class="hljs-number">45</span>];<br><span class="hljs-keyword">let</span> <span class="hljs-attr">arr4</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span> | <span class="hljs-built_in">string</span>&gt; = [<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;23&#x27;</span>, <span class="hljs-number">45</span>];<br>元组 <span class="hljs-title class_">Tuple</span><br><br></code></pre></td></tr></table></figure><h3 id="interface（接口）"><a href="#interface（接口）" class="headerlink" title="interface（接口）"></a>interface（接口）</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IObj</span> &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;<br>&#125;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">obj</span>: <span class="hljs-title class_">IObj</span> = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;11&#x27;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">11</span>,<br>&#125;;<br><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IPerson</span> &#123;<br>    name?: <span class="hljs-built_in">string</span>; <span class="hljs-comment">//选填 ?</span><br>    <span class="hljs-attr">date</span>: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// 必填</span><br>    <span class="hljs-attr">sex</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-title function_">action</span>(): <span class="hljs-built_in">void</span>;<span class="hljs-comment">//没要求有 值类型</span><br>    [<span class="hljs-attr">propName</span>: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span>; <span class="hljs-comment">//可添加任意属性</span><br>&#125;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">person1</span>: <span class="hljs-title class_">IPerson</span> = &#123;<br>    <span class="hljs-attr">date</span>: <span class="hljs-string">&#x27;2021-11-01&#x27;</span>,<br>    <span class="hljs-attr">sex</span>: <span class="hljs-string">&#x27;1&#x27;</span>,<br>    <span class="hljs-attr">action</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; &#125;,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;小小&#x27;</span>,<br>    <span class="hljs-attr">cat</span>: <span class="hljs-string">&#x27;儿童车&#x27;</span>,<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// 函数 输入类型 输出类型</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">f1</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt; &#123;<br>    <span class="hljs-keyword">return</span> [a, b];<br>&#125;<br><span class="hljs-comment">// void 无返回值</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">f2</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">void</span> &#123; &#125;<br></code></pre></td></tr></table></figure><h3 id="lt-T-gt-泛型-T-指一个变量"><a href="#lt-T-gt-泛型-T-指一个变量" class="headerlink" title="&lt; T &gt;泛型(T 指一个变量)"></a>&lt; T &gt;泛型(T 指一个变量)</h3><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">function</span> <span class="hljs-title function_">f3</span>&lt;<span class="hljs-title function_">T</span>&gt;(<span class="hljs-params">a: T, b: T</span>): <span class="hljs-title function_">Array</span>&lt;<span class="hljs-title function_">T</span>&gt; &#123;<br>    <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>([a, b]);<br>    <span class="hljs-keyword">return</span> [a, b];<br>&#125;<br>f3&lt;string&gt;(<span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>);<br><br></code></pre></td></tr></table></figure><h3 id="type-别名"><a href="#type-别名" class="headerlink" title="type(别名)"></a>type(别名)</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// type 别名</span><br><span class="hljs-keyword">type</span> sn = <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span>;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">sn1</span>: sn = <span class="hljs-string">&#x27;sss&#x27;</span>;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">sn2</span>: sn = <span class="hljs-number">444</span>;<br><br><span class="hljs-keyword">type</span> sn1 = <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span>;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">arr8</span>: sn1[] = [<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;22&#x27;</span>];<br><span class="hljs-keyword">let</span> <span class="hljs-attr">arr9</span>: <span class="hljs-title class_">Array</span>&lt;sn1&gt; = [<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;22&#x27;</span>]; <span class="hljs-comment">//泛型写法</span><br></code></pre></td></tr></table></figure><h3 id="enum-枚举"><a href="#enum-枚举" class="headerlink" title="enum(枚举)"></a>enum(枚举)</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// 枚举</span><br><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Color</span> &#123;<br>    <span class="hljs-title class_">Red</span>,<br>    <span class="hljs-title class_">Green</span>,<br>    <span class="hljs-title class_">Blue</span>,<br>&#125;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">c</span>: <span class="hljs-title class_">Color</span> = <span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(c);<br><br><span class="hljs-keyword">enum</span> <span class="hljs-title class_">EColor</span> &#123;<br>    <span class="hljs-string">&#x27;红色&#x27;</span>,<br>    <span class="hljs-string">&#x27;蓝色&#x27;</span>,<br>    <span class="hljs-string">&#x27;橙色&#x27;</span>,<br>&#125;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">color</span>: <span class="hljs-title class_">EColor</span> = <span class="hljs-title class_">EColor</span>.橙色;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(color);<br></code></pre></td></tr></table></figure><h3 id="接口-泛型-类-常规用法"><a href="#接口-泛型-类-常规用法" class="headerlink" title="接口 泛型 类 常规用法"></a>接口 泛型 类 常规用法</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ILength</span> &#123;<br>    <span class="hljs-attr">length</span>: <span class="hljs-built_in">number</span>;<br>&#125;<br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ISearchFun</span> &#123;<br>    &lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ILength</span>&gt;(<span class="hljs-attr">a</span>: T, <span class="hljs-attr">b</span>: T): <span class="hljs-built_in">boolean</span>;<br>&#125;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">fun4</span>: <span class="hljs-title class_">ISearchFun</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">return</span> a == b;<br>&#125;;<br><br><span class="hljs-comment">// 类实现接口 implements 关键字</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IObj3</span> &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-attr">color</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-title function_">action</span>(): <span class="hljs-built_in">string</span>;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IObj3</span> &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-attr">color</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, color: <span class="hljs-built_in">string</span></span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;<br>    &#125;<br>    <span class="hljs-title function_">eat</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> + <span class="hljs-string">&#x27;吃&#x27;</span>;<br>    &#125;<br>    <span class="hljs-title function_">action</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;11&#x27;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IO3</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ILength</span>&gt; &#123;<br>    (<span class="hljs-attr">a</span>: T, <span class="hljs-attr">b</span>: T): <span class="hljs-built_in">boolean</span><br>&#125;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">fun5</span>: <span class="hljs-title class_">IO3</span>&lt;<span class="hljs-built_in">string</span>&gt; = <span class="hljs-function">(<span class="hljs-params">x, y</span>) =&gt;</span> x == y<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">fun5</span>(<span class="hljs-string">&#x27;12&#x27;</span>, <span class="hljs-string">&#x27;12&#x27;</span>));<br></code></pre></td></tr></table></figure><p><code>![BG图片](/img/default.jpg)</code><br><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原生</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vue数组的变异方法实现</title>
    <link href="/2021/12/03/2021/2021-12/12-03vue%E6%95%B0%E7%BB%84%E7%9A%84%E5%8F%98%E5%BC%82%E6%96%B9%E6%B3%95%E5%AE%9E%E7%8E%B0/"/>
    <url>/2021/12/03/2021/2021-12/12-03vue%E6%95%B0%E7%BB%84%E7%9A%84%E5%8F%98%E5%BC%82%E6%96%B9%E6%B3%95%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h2 id="函数拦截"><a href="#函数拦截" class="headerlink" title="函数拦截"></a>函数拦截</h2><p>仿写实现 vue 的数组变异方法之前，首先要了解函数拦截这个概念。是指在函数原有的基础上增加额外的操作</p><ul><li>  使用一个临时的函数名储存函数</li><li>  重新定义原来的函数</li><li>  定义扩展的功能</li><li>  调用临时的那个函数</li></ul><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;函数本身的功能&#x27;</span>);<br>&#125;<br><br>let _tFn = fn;<br>fn = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    _tFn()<br>    <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;新的扩展的功能&#x27;</span>);<br>&#125;<br>fn(); <span class="hljs-comment">// 打印出本身功能 扩展功能</span><br></code></pre></td></tr></table></figure><h2 id="vue-中的实现方式"><a href="#vue-中的实现方式" class="headerlink" title="vue 中的实现方式"></a>vue 中的实现方式</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">/**  修改数组原型方法 */</span><br><span class="hljs-keyword">let</span> <span class="hljs-variable constant_">ARRAY_METHOD</span> = [<br>    <span class="hljs-string">&#x27;push&#x27;</span>, <span class="hljs-string">&#x27;pop&#x27;</span>, <span class="hljs-string">&#x27;shift&#x27;</span>, <span class="hljs-string">&#x27;unshift&#x27;</span>, <span class="hljs-string">&#x27;reverse&#x27;</span>, <span class="hljs-string">&#x27;sort&#x27;</span>, <span class="hljs-string">&#x27;splice&#x27;</span><br>];<br><span class="hljs-comment">// 将原型链继承：修改原型链结构</span><br><span class="hljs-keyword">let</span> arr = [];<br><span class="hljs-comment">// 关系 ： arr =&gt; Array.prototype =&gt; Obj.prototype</span><br><span class="hljs-comment">//  更换为</span><br><span class="hljs-comment">// 关系：  arr =&gt; 函数拦截(改写的方法) =&gt; Array.prototype =&gt; Obj.prototype</span><br><span class="hljs-keyword">let</span> array_methods = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>)<br><span class="hljs-variable constant_">ARRAY_METHOD</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">method</span> =&gt;</span> &#123;<br>    <span class="hljs-comment">// console.log(&#x27;调用拦截的&#x27;, method);</span><br>    array_methods[method] = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">let</span> res = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>[method].<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span>)<br>        <span class="hljs-keyword">return</span> res<br>    &#125;<br>&#125;)<br>arr.<span class="hljs-property">__proto__</span> = array_methods;<br></code></pre></td></tr></table></figure><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>函数</title>
    <link href="/2021/10/25/2021/2021-10/10-25%E5%87%BD%E6%95%B0/"/>
    <url>/2021/10/25/2021/2021-10/10-25%E5%87%BD%E6%95%B0/</url>
    
    <content type="html"><![CDATA[<h2 id="函数式编程"><a href="#函数式编程" class="headerlink" title="函数式编程"></a>函数式编程</h2><ul><li>  函数柯里化</li><li>  偏函数</li><li>高阶函数<br>  <code>[函数式编程](https://baike.baidu.com/item/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/4035031?fr=aladdin)</code></li></ul><p><code>![BG图片](/img/default.jpg)</code><br><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原生</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>数据原理3</title>
    <link href="/2021/10/14/2021/2021-10/10-14%E6%95%B0%E6%8D%AE%E5%8E%9F%E7%90%863/"/>
    <url>/2021/10/14/2021/2021-10/10-14%E6%95%B0%E6%8D%AE%E5%8E%9F%E7%90%863/</url>
    
    <content type="html"><![CDATA[<h2 id="数据驱动模型"><a href="#数据驱动模型" class="headerlink" title="数据驱动模型"></a>数据驱动模型</h2><h2 id="模拟-vue-数据驱动"><a href="#模拟-vue-数据驱动" class="headerlink" title="模拟 vue 数据驱动"></a>模拟 vue 数据驱动</h2><ul><li><p>  简化实现 VUE 真实 DOM =&gt; VNode =&gt; 数据+模板 =&gt; 真实 DOM =&gt; 页面</p></li><li><p>  class VNode(虚拟 DOM 类)</p></li><li><p>  getVnode (真实 DOM =&gt; 获取虚拟 DOM)</p></li><li><p>  getValueByPath (处理 data 嵌套层数据)</p></li><li><p>  combine (将获取真实的 DOM 带有{…} 的模板与数据结合)</p></li><li><p>  parseVNode (虚拟 DOM 生成真实 DOM)</p></li><li><p>  JGVue (VUE 构造函数)</p></li><li><p>  mountComponent (VUE 执行 挂载函数) 方便后期使用发布订阅模式</p></li><li><p>  createRenderFn ( 返回一个 render 函数 带有缓存行为 闭包)</p></li><li><p>  update (VUE 更新阶段 diff 算法省略 渲染到页面中)</p></li></ul><ul><li>示例图<br>  <img src="/img/%E5%B8%A6%E6%A7%BD%E7%9A%84dom.png" alt="带槽的dom"><br>  <img src="/img/%E6%95%B0%E6%8D%AE%E4%B8%8E%E8%99%9A%E6%8B%9FDOM%E7%BB%93%E5%90%88%E5%90%8E.png" alt="数据与虚拟DOM结合后"></li><li>  代码块</li></ul><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">name</span>&#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;hello2&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;aa&quot;</span>&gt;</span>hello2<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">age</span>&#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">gender</span>&#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;li1&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;111&quot;</span>&gt;</span>li1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>li2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>li3<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 生成虚拟DOM  */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">class</span> <span class="hljs-title class_">VNode</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-title function_">constructor</span>(<span class="hljs-params">tag, data, value, type</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">tag</span> = tag &amp;&amp; tag.<span class="hljs-title function_">toLowerCase</span>();</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> = data;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> = type;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span> = [];</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">/** 追加子节点 */</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-title function_">appebdChild</span>(<span class="hljs-params">vnode</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span>.<span class="hljs-title function_">push</span>(vnode)</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">getVnode</span>(<span class="hljs-params">node</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> nodeType = node.<span class="hljs-property">nodeType</span>; <span class="hljs-comment">//节点类型</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> _vnode = <span class="hljs-literal">null</span>;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">if</span> (nodeType === <span class="hljs-number">1</span>) &#123; <span class="hljs-comment">//元素节点类型</span></span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">let</span> nodeName = node.<span class="hljs-property">nodeName</span>; <span class="hljs-comment">//节点名称</span></span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">let</span> attrs = node.<span class="hljs-property">attributes</span>; <span class="hljs-comment">//节点属性 为数组</span></span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-comment">// console.log(&#x27;节点名称&#x27;, nodeName, &#x27;节点属性&#x27;, attrs);</span></span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">let</span> _attrsObj = &#123;&#125;;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; attrs.<span class="hljs-property">length</span>; i++) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                    _attrsObj[attrs[i].<span class="hljs-property">nodeName</span>] = attrs[i].<span class="hljs-property">nodeValue</span>;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">                &#125;</span></span><br><span class="language-javascript"><span class="language-xml">                _vnode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VNode</span>(nodeName, _attrsObj, <span class="hljs-literal">undefined</span>, nodeType);</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-comment">// node 子元素</span></span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">let</span> childNodes = node.<span class="hljs-property">childNodes</span>; <span class="hljs-comment">//获取当前元素的所有子元素</span></span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; childNodes.<span class="hljs-property">length</span>; i++) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                    _vnode.<span class="hljs-title function_">appebdChild</span>(<span class="hljs-title function_">getVnode</span>(childNodes[i])) <span class="hljs-comment">//再次将子元素递归</span></span></span><br><span class="language-javascript"><span class="language-xml">                &#125;</span></span><br><span class="language-javascript"><span class="language-xml">            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nodeType === <span class="hljs-number">3</span>) &#123; <span class="hljs-comment">//文本节点类型</span></span></span><br><span class="language-javascript"><span class="language-xml">                _vnode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VNode</span>(<span class="hljs-literal">undefined</span>, <span class="hljs-literal">undefined</span>, node.<span class="hljs-property">nodeValue</span>, node.<span class="hljs-property">nodeType</span>)</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// 将vnode返回</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">return</span> _vnode</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 根据路径 处理数据 */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">getValueByPath</span>(<span class="hljs-params">obj, path</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> paths = path.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;.&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> res = obj;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> prop;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">while</span> (prop = paths.<span class="hljs-title function_">shift</span>()) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                res = res[prop];</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">return</span> res;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">let</span> <span class="hljs-title class_">Rkuohao</span> = <span class="hljs-regexp">/\&#123;\&#123;(.+?)\&#125;\&#125;/g</span>;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 将带有坑的vnode 与数据结合 */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">combine</span>(<span class="hljs-params">vnode, data</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> _type = vnode.<span class="hljs-property">type</span>;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> _data = vnode.<span class="hljs-property">data</span>;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> _value = vnode.<span class="hljs-property">value</span>;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> _tag = vnode.<span class="hljs-property">tag</span>;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> _children = vnode.<span class="hljs-property">children</span>;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> _vnode = <span class="hljs-literal">null</span>;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">if</span> (_type == <span class="hljs-number">3</span>) &#123; <span class="hljs-comment">//文本节点</span></span></span><br><span class="language-javascript"><span class="language-xml">                _value = _value.<span class="hljs-title function_">replace</span>(<span class="hljs-title class_">Rkuohao</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">_, g</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-keyword">return</span> <span class="hljs-title function_">getValueByPath</span>(data, g.<span class="hljs-title function_">trim</span>())</span></span><br><span class="language-javascript"><span class="language-xml">                &#125;)</span></span><br><span class="language-javascript"><span class="language-xml">                _vnode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VNode</span>(_tag, _data, _value, _type)</span></span><br><span class="language-javascript"><span class="language-xml">            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (_type == <span class="hljs-number">1</span>) &#123; <span class="hljs-comment">//元素节点</span></span></span><br><span class="language-javascript"><span class="language-xml">                _vnode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VNode</span>(_tag, _data, _value, _type)</span></span><br><span class="language-javascript"><span class="language-xml">                _children.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> _vnode.<span class="hljs-title function_">appebdChild</span>(<span class="hljs-title function_">combine</span>(v, data)))</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">return</span> _vnode;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 创建真实DOM */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">parseVNode</span>(<span class="hljs-params">vnode</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// 获取虚拟dom类型 文本节点创建文本 元素节点创建元素</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> type = vnode.<span class="hljs-property">type</span> <span class="hljs-comment">//type是 class VNode中声明的type</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> _node = <span class="hljs-literal">null</span>;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">if</span> (type === <span class="hljs-number">3</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTextNode</span>(vnode.<span class="hljs-property">value</span>); <span class="hljs-comment">//文本节点只需传递value 值</span></span></span><br><span class="language-javascript"><span class="language-xml">            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-number">1</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                _node = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(vnode.<span class="hljs-property">tag</span>); <span class="hljs-comment">// 创建元素节点</span></span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-comment">//添加数据</span></span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">let</span> data = vnode.<span class="hljs-property">data</span>;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> data) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                    _node.<span class="hljs-title function_">setAttribute</span>(key, data[key])</span></span><br><span class="language-javascript"><span class="language-xml">                &#125;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-comment">// 添加子元素</span></span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">let</span> children = vnode.<span class="hljs-property">children</span>;</span></span><br><span class="language-javascript"><span class="language-xml">                children.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> &#123; <span class="hljs-comment">// 每项都是虚拟DOM 递归再次调用</span></span></span><br><span class="language-javascript"><span class="language-xml">                    _node.<span class="hljs-title function_">appendChild</span>(<span class="hljs-title function_">parseVNode</span>(v))</span></span><br><span class="language-javascript"><span class="language-xml">                &#125;)</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">return</span> _node</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">JGVue</span>(<span class="hljs-params">options</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span> = options.<span class="hljs-property">data</span>;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> elm = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(options.<span class="hljs-property">el</span>); <span class="hljs-comment">// vue中是字符串 （我们使用虚拟DOM）</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_template</span> = elm;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_parent</span> = elm.<span class="hljs-property">parentNode</span>; <span class="hljs-comment">//获取父元素</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">mount</span>(); <span class="hljs-comment">//挂载</span></span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title class_">JGVue</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">mount</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// 需要提供一个render 方法生成虚拟DOM</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">render</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createRenderFn</span>()</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">mountComponent</span>();</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title class_">JGVue</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">mountComponent</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// 执行 mountComponent</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> <span class="hljs-title function_">mount</span> = (<span class="hljs-params"></span>) =&gt; &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">update</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">render</span>());</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;</span></span><br><span class="language-javascript"><span class="language-xml">            mount.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>)</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// this.update(this.render())// 使用发布订阅 交给watchr 来完成</span></span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/**</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">         * 生成render函数 方法 缓存抽象语法树（我们使用虚拟DOM）</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">         * 在页面中的DOM 和虚拟DOM 是一一对应关系</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">         * 先有AST 和数据生成VNode (新，render)</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">         * 将旧的VNode 和新的VNode 比较（diff）更新（updata）</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">         */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title class_">JGVue</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">createRenderFn</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> ast = <span class="hljs-title function_">getVnode</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_template</span>)</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// vue 将AST + Data =&gt; VNode</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-comment">// debugger;</span></span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">let</span> temp = <span class="hljs-title function_">combine</span>(ast, <span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span>);</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">return</span> temp;</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 虚拟DOM 渲染到页面中 diff算法</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title class_">JGVue</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">update</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">vnode</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// 简化，直接生成 HTML DOM replaceChild 到页面中</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> realDom = <span class="hljs-title function_">parseVNode</span>(vnode);</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// debugger;</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_parent</span>);</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">//   这个地方没有使用算法 直接替换</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_parent</span>.<span class="hljs-title function_">replaceChild</span>(realDom, <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#root&#x27;</span>))</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">let</span> app = <span class="hljs-keyword">new</span> <span class="hljs-title class_">JGVue</span>(&#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">el</span>: <span class="hljs-string">&quot;#root&quot;</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">data</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;张三&#x27;</span>,</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-attr">age</span>: <span class="hljs-string">&#x27;16&#x27;</span>,</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-attr">gender</span>: <span class="hljs-string">&#x27;男&#x27;</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;)</span></span><br><span class="language-javascript"><span class="language-xml">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>(笔记)<br><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>数据原理2</title>
    <link href="/2021/10/13/2021/2021-10/10-13%E6%95%B0%E6%8D%AE%E5%8E%9F%E7%90%862%20copy/"/>
    <url>/2021/10/13/2021/2021-10/10-13%E6%95%B0%E6%8D%AE%E5%8E%9F%E7%90%862%20copy/</url>
    
    <content type="html"><![CDATA[<h2 id="数据驱动模型"><a href="#数据驱动模型" class="headerlink" title="数据驱动模型"></a>数据驱动模型</h2><ol><li>获得模板， 模板中由‘坑’</li><li>利用 Vue 构造函数中所提供的数据来”填坑”，得到可以再页面中显示的”标签”</li><li>将标签替换页面中原来有坑的位置</li></ol><h2 id="模拟-vue-数据驱动"><a href="#模拟-vue-数据驱动" class="headerlink" title="模拟 vue 数据驱动"></a>模拟 vue 数据驱动</h2><ul><li>  简化版本，没有考虑很多 Vue 实例的方法 指令等 只实现最基本的 DOM =&gt; virtualDOM =&gt; DOM 转换过程</li></ul><ul><li>效果图<br>  <img src="/img/DOM1.png" alt="转换为虚拟DOM"><br>  <img src="/img/DOM2.png" alt="虚拟DOM转换为真实DOM"></li><li>  代码块</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>hello1<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;hello2&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;aa&quot;</span>&gt;</span>hello2<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>hello3<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>hello4<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;li1&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;111&quot;</span>&gt;</span>li1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>li2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>li3<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//为什么使用virtualDom?</span></span><br><span class="language-javascript">        <span class="hljs-comment">//首先由于真实DOM操作太浪费性能，使用虚拟DOM 经过计算存储缓存中 后直接插入到真实DOM中 ，这样大大节约了开销</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">/** 定义</span></span><br><span class="hljs-comment"><span class="language-javascript">         *  &lt;div&gt;&lt;/div&gt; =&gt; &#123; tag: &#x27;div&#x27;&#125;</span></span><br><span class="hljs-comment"><span class="language-javascript">         *  文本节点 张三 =&gt; &#123; tag: undefind, value: &#x27;张三&#x27;&#125;</span></span><br><span class="hljs-comment"><span class="language-javascript">         *  &lt;div title=&quot;1&quot; class=&quot;aa&quot; &gt; &lt;span&gt;11&lt;/span&gt;&lt;/div&gt; =&gt; &#123; tag: &#x27;div&#x27;, data:&#123;title: &#x27;1&#x27;, class: &#x27;aa&#x27;&#125;, children:[&#123;tag:&#x27;span&#x27;,children:[&#123;tag:&#x27;undefind&#x27;,value:&#x27;11&#x27;&#125;],&#125;]&#125;</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">         <span class="hljs-comment">/** 声明一个虚拟DOM 类 */</span></span><br><span class="language-javascript">        <span class="hljs-keyword">class</span> <span class="hljs-title class_">VNode</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">constructor</span>(<span class="hljs-params">tag, data, value, type</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">tag</span> = tag &amp;&amp; tag.<span class="hljs-title function_">toLowerCase</span>();</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> = data;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> = type;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span> = [];</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-comment">/** 追加子节点 */</span></span><br><span class="language-javascript">            <span class="hljs-title function_">appebdChild</span>(<span class="hljs-params">vnode</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span>.<span class="hljs-title function_">push</span>(vnode)</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-comment">/** 使用递归 来遍历DOM 生成virtualDOM</span></span><br><span class="hljs-comment"><span class="language-javascript">         * VUE中使用的源码是栈结构， 使用栈存储 父元素来实现</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">getVnode</span>(<span class="hljs-params">node</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> nodeType = node.<span class="hljs-property">nodeType</span>; <span class="hljs-comment">//节点类型</span></span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(&#x27;传进&#x27;, node);</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> _vnode = <span class="hljs-literal">null</span>;</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (nodeType === <span class="hljs-number">1</span>) &#123; <span class="hljs-comment">//元素节点类型</span></span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> nodeName = node.<span class="hljs-property">nodeName</span>; <span class="hljs-comment">//节点名称</span></span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> attrs = node.<span class="hljs-property">attributes</span>; <span class="hljs-comment">//节点属性 为数组</span></span><br><span class="language-javascript">                <span class="hljs-comment">// console.log(&#x27;节点名称&#x27;, nodeName, &#x27;节点属性&#x27;, attrs);</span></span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> _attrsObj = &#123;&#125;;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; attrs.<span class="hljs-property">length</span>; i++) &#123;</span><br><span class="language-javascript">                    _attrsObj[attrs[i].<span class="hljs-property">nodeName</span>] = attrs[i].<span class="hljs-property">nodeValue</span>;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">                _vnode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VNode</span>(nodeName, _attrsObj, <span class="hljs-literal">undefined</span>, nodeType);</span><br><span class="language-javascript">                <span class="hljs-comment">// node 子元素</span></span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> childNodes = node.<span class="hljs-property">childNodes</span>; <span class="hljs-comment">//获取当前元素的所有子元素</span></span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; childNodes.<span class="hljs-property">length</span>; i++) &#123;</span><br><span class="language-javascript">                    _vnode.<span class="hljs-title function_">appebdChild</span>(<span class="hljs-title function_">getVnode</span>(childNodes[i])) <span class="hljs-comment">//再次将子元素递归</span></span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (nodeType === <span class="hljs-number">3</span>) &#123; <span class="hljs-comment">//文本节点类型</span></span><br><span class="language-javascript">                _vnode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VNode</span>(<span class="hljs-literal">undefined</span>, <span class="hljs-literal">undefined</span>, node.<span class="hljs-property">nodeValue</span>, node.<span class="hljs-property">nodeType</span>)</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-comment">// 将vnode返回</span></span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> _vnode</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-comment">/** 创建真实DOM */</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">parseVNode</span>(<span class="hljs-params">vnode</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 获取虚拟dom类型 文本节点创建文本 元素节点创建元素</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> type = vnode.<span class="hljs-property">type</span> <span class="hljs-comment">//type是 class VNode中声明的type</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> _node = <span class="hljs-literal">null</span>;</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (type === <span class="hljs-number">3</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTextNode</span>(vnode.<span class="hljs-property">value</span>); <span class="hljs-comment">//文本节点只需传递value 值</span></span><br><span class="language-javascript">            &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-number">1</span>) &#123;</span><br><span class="language-javascript">                _node = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(vnode.<span class="hljs-property">tag</span>); <span class="hljs-comment">// 创建元素节点</span></span><br><span class="language-javascript">                <span class="hljs-comment">//添加数据</span></span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> data = vnode.<span class="hljs-property">data</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> data) &#123;</span><br><span class="language-javascript">                    _node.<span class="hljs-title function_">setAttribute</span>(key, data[key])</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">                <span class="hljs-comment">// 添加子元素</span></span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> children = vnode.<span class="hljs-property">children</span>;</span><br><span class="language-javascript">                children.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> &#123; <span class="hljs-comment">// 每项都是虚拟DOM 递归再次调用</span></span><br><span class="language-javascript">                    _node.<span class="hljs-title function_">appendChild</span>(<span class="hljs-title function_">parseVNode</span>(v))</span><br><span class="language-javascript">                &#125;)</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> _node</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-keyword">let</span> root = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#root&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;真实root&#x27;</span>, root);</span><br><span class="language-javascript">        <span class="hljs-keyword">let</span> <span class="hljs-title class_">VNodeRoot</span> = <span class="hljs-title function_">getVnode</span>(root);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;转换为虚拟DOM&#x27;</span>, <span class="hljs-title class_">VNodeRoot</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">let</span> root2 = <span class="hljs-title function_">parseVNode</span>(<span class="hljs-title class_">VNodeRoot</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;虚转真root&#x27;</span>, root2);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>(笔记)<br><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>数据原理1</title>
    <link href="/2021/10/12/2021/2021-10/10-12%E6%95%B0%E6%8D%AE%E5%8E%9F%E7%90%861%20copy/"/>
    <url>/2021/10/12/2021/2021-10/10-12%E6%95%B0%E6%8D%AE%E5%8E%9F%E7%90%861%20copy/</url>
    
    <content type="html"><![CDATA[<h2 id="数据驱动模型"><a href="#数据驱动模型" class="headerlink" title="数据驱动模型"></a>数据驱动模型</h2><ol><li>获得模板， 模板中由‘坑’</li><li>利用 Vue 构造函数中所提供的数据来”填坑”，得到可以再页面中显示的”标签”</li><li>将标签替换页面中原来有坑的位置</li></ol><h2 id="模拟-vue-数据驱动"><a href="#模拟-vue-数据驱动" class="headerlink" title="模拟 vue 数据驱动"></a>模拟 vue 数据驱动</h2><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">name</span>&#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">msg</span>&#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 步骤拆解</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 1. 拿到模板</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 2. 拿到数据</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 3. 将数据与模板结合 得到的时 HTML (DOM元素)</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 4. 放到页面中</span></span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">//  1 获取模板</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">let</span> tmpNode = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#root&#x27;</span>); <span class="hljs-comment">//获取元素</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 2. 获取数据</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">let</span> data = &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;这是名字&#x27;</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">msg</span>: <span class="hljs-string">&#x27;这是消息&#x27;</span>,</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 3. 将数据放到模板中、</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">let</span> <span class="hljs-title class_">Rkuohao</span> = <span class="hljs-regexp">/\&#123;\&#123;(.+?)\&#125;\&#125;/g</span>;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// vue 源码中是 将真是DOM -&gt; 字符串模板 -&gt; VDOM -&gt; 真实DOM</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">//  下面使用递归的方式</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">compiler</span>(<span class="hljs-params">template, data</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> childNodes = template.<span class="hljs-property">childNodes</span>; <span class="hljs-comment">//取出子元素</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;打印node 节点&#x27;</span>, childNodes);</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; childNodes.<span class="hljs-property">length</span>; i++) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">let</span> type = childNodes[i].<span class="hljs-property">nodeType</span> <span class="hljs-comment">// 十几种类型  1 元素 2 文本</span></span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">if</span> (type == <span class="hljs-number">3</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-keyword">let</span> txt = childNodes[i].<span class="hljs-property">nodeValue</span>; <span class="hljs-comment">//该属性只有文本才有意义</span></span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-comment">// 匹配花括号</span></span></span><br><span class="language-javascript"><span class="language-xml">                    txt = txt.<span class="hljs-title function_">replace</span>(<span class="hljs-title class_">Rkuohao</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">_, g</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                        <span class="hljs-comment">// g代表每次匹配的值</span></span></span><br><span class="language-javascript"><span class="language-xml">                        <span class="hljs-comment">// replace 使用匹配一次 函数会调用一次</span></span></span><br><span class="language-javascript"><span class="language-xml">                        <span class="hljs-keyword">let</span> key = g.<span class="hljs-title function_">trim</span>()</span></span><br><span class="language-javascript"><span class="language-xml">                        <span class="hljs-keyword">let</span> value = data[key]</span></span><br><span class="language-javascript"><span class="language-xml">                        <span class="hljs-keyword">return</span> value</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">                    &#125;)</span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-comment">// 注意 TXT和DOM是没有关系的 所以将其替换掉</span></span></span><br><span class="language-javascript"><span class="language-xml">                    childNodes[i].<span class="hljs-property">nodeValue</span> = txt</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-number">1</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-comment">//   元素,考虑它有没有子元素 是否需要将其子元素进行 判断是否需要插值</span></span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-title function_">compiler</span>(childNodes[i], data)</span></span><br><span class="language-javascript"><span class="language-xml">                &#125;</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 克隆node节点 如果使用获取的话，是引用类型 会直接转换 再次就是获取的不是模板了</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">let</span> cloneNode = tmpNode.<span class="hljs-title function_">cloneNode</span>(<span class="hljs-literal">true</span>)</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;原始Node&#x27;</span>, tmpNode);</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">compiler</span>(cloneNode, data)</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;处理后的Node&#x27;</span>, cloneNode);</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 4 将clone 的节点插入html</span></span></span><br><span class="language-javascript"><span class="language-xml">        root.<span class="hljs-property">parentNode</span>.<span class="hljs-title function_">replaceChild</span>(cloneNode, root)</span></span><br><span class="language-javascript"><span class="language-xml">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure><ul><li>  以上简单实现 但与实际很大的差异</li><li>  vue 是虚拟 DOM</li><li>  局限性 data 数据 实际业务中会用到 a.b.c 层次型数据</li><li>  操作指令 代码没有整合</li></ul><h3 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h3><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">name.firstName</span>&#125;&#125;</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">name.lastName</span>&#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">msg</span>&#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 构造函数</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">let</span> <span class="hljs-title class_">Rkuohao</span> = <span class="hljs-regexp">/\&#123;\&#123;(.+?)\&#125;\&#125;/g</span>;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 获取data值对应 */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">getValueByPath</span>(<span class="hljs-params">obj, path</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> paths = path.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;.&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> res = obj;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> prop;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">while</span> (prop = paths.<span class="hljs-title function_">shift</span>()) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                res = res[prop];</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">return</span> res;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 递归 获取DOM 与data 的结合*/</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">compiler</span>(<span class="hljs-params">template, data</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> childNodes = template.<span class="hljs-property">childNodes</span>; <span class="hljs-comment">//取出子元素</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; childNodes.<span class="hljs-property">length</span>; i++) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">let</span> type = childNodes[i].<span class="hljs-property">nodeType</span> <span class="hljs-comment">// 十几种类型  1 元素 2 文本</span></span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-keyword">if</span> (type == <span class="hljs-number">3</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-keyword">let</span> txt = childNodes[i].<span class="hljs-property">nodeValue</span>; <span class="hljs-comment">//该属性只有文本才有意义</span></span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-comment">// 匹配花括号</span></span></span><br><span class="language-javascript"><span class="language-xml">                    txt = txt.<span class="hljs-title function_">replace</span>(<span class="hljs-title class_">Rkuohao</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">_, g</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                        <span class="hljs-comment">// g代表每次匹配的值</span></span></span><br><span class="language-javascript"><span class="language-xml">                        <span class="hljs-comment">// replace 使用匹配一次 函数会调用一次</span></span></span><br><span class="language-javascript"><span class="language-xml">                        <span class="hljs-keyword">let</span> key = g.<span class="hljs-title function_">trim</span>()</span></span><br><span class="language-javascript"><span class="language-xml">                        <span class="hljs-keyword">let</span> value = <span class="hljs-title function_">getValueByPath</span>(data, key)</span></span><br><span class="language-javascript"><span class="language-xml">                        <span class="hljs-keyword">return</span> value</span></span><br><span class="language-javascript"><span class="language-xml">                    &#125;)</span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-comment">// 注意 TXT和DOM是没有关系的 所以将其替换掉</span></span></span><br><span class="language-javascript"><span class="language-xml">                    childNodes[i].<span class="hljs-property">nodeValue</span> = txt</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-number">1</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-comment">//   元素,考虑它有没有子元素 是否需要将其子元素进行 判断是否需要插值</span></span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-title function_">compiler</span>(childNodes[i], data)</span></span><br><span class="language-javascript"><span class="language-xml">                &#125;</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">JGvue</span>(<span class="hljs-params">options</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// _ 开头的是内部数据 $开头的是只读数据</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span> = options.<span class="hljs-property">data</span>;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_el</span> = options.<span class="hljs-property">el</span>;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// 准备模板</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">$el</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_templateDOM</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_el</span>);</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_parent</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_templateDOM</span>.<span class="hljs-property">parentNode</span>;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// 渲染</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">render</span>();</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 向原型添加方法</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 将模板和数据结合进行渲染到HTML页面之中 */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title class_">JGvue</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">render</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">compiler</span>()</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 将模板和数据结合得到真正的DOM*/</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title class_">JGvue</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">compiler</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> realHTMLDOM = <span class="hljs-variable language_">this</span>.<span class="hljs-property">_templateDOM</span>.<span class="hljs-title function_">cloneNode</span>(<span class="hljs-literal">true</span>); <span class="hljs-comment">//获取克隆的准DOM</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">//将DOM 和 数据结合</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-title function_">compiler</span>(realHTMLDOM, <span class="hljs-variable language_">this</span>.<span class="hljs-property">_data</span>)</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updata</span>(realHTMLDOM);</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/** 更新，将DOM 放到页面之中*/</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title class_">JGvue</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">updata</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">real</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">_parent</span>.<span class="hljs-title function_">replaceChild</span>(real, <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;#root&quot;</span>));</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">//    使用方式</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">let</span> app = <span class="hljs-keyword">new</span> <span class="hljs-title class_">JGvue</span>(&#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">el</span>: <span class="hljs-string">&quot;#root&quot;</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">data</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-attr">msg</span>: <span class="hljs-string">&#x27;信息啊&#x27;</span>,</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-attr">name</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-attr">firstName</span>: <span class="hljs-string">&#x27;张&#x27;</span>,</span></span><br><span class="language-javascript"><span class="language-xml">                    <span class="hljs-attr">lastName</span>: <span class="hljs-string">&#x27;三&#x27;</span>,</span></span><br><span class="language-javascript"><span class="language-xml">                &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">            &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;)</span></span><br><span class="language-javascript"><span class="language-xml">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>(笔记)<br><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vue.set()</title>
    <link href="/2021/10/08/2021/2021-10/10-08Vue%E6%B7%B1%E5%85%A5%E5%93%8D%E5%BA%94%E5%BC%8F/"/>
    <url>/2021/10/08/2021/2021-10/10-08Vue%E6%B7%B1%E5%85%A5%E5%93%8D%E5%BA%94%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3><p>由于 JavaScript 的限制，Vue 不能检测数组和对象的变化。尽管如此我们还是有一些办法来回避这些限制并保证它们的响应性。<br>首先 Vue 中已经封装了一些数组的封装方法 例如：push() pop() shift() unshift() splice() sort() reverse() 这些事 都可以处理一些响应式数据。<br>但一些无法检测到 property()<br><a href="https://cn.vuejs.org/v2/api/#Vue-set">Vue.set()</a> Api 可以解决这一现象</p><h4 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h4><p><code>Vue.set( target, key, value )</code></p><ul><li>  target Arr||Obj (修改的对象)</li><li>  key/index string || number（修改的具体数据 key 值。）</li><li>  value : any（要修改的结果）</li></ul><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;app2&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;(item,index) in items&quot;</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;index&quot;</span>&gt;</span></span><br><span class="language-xml">        </span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">item.message</span>&#125;&#125;</span><span class="language-xml"></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn&quot;</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;btn2Click()&quot;</span>&gt;</span>动态赋值<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn&quot;</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;btn3Click()&quot;</span>&gt;</span>为data新增属性<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;../dist/vue.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">var</span> vm = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">el</span>:<span class="hljs-string">&quot;#app&quot;</span>,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">data</span>:&#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">items</span>:[</span></span><br><span class="language-javascript"><span class="language-xml">            &#123;<span class="hljs-attr">message</span>:<span class="hljs-string">&quot;Test one&quot;</span>,<span class="hljs-attr">id</span>:<span class="hljs-string">&quot;1&quot;</span>&#125;,</span></span><br><span class="language-javascript"><span class="language-xml">            &#123;<span class="hljs-attr">message</span>:<span class="hljs-string">&quot;Test two&quot;</span>,<span class="hljs-attr">id</span>:<span class="hljs-string">&quot;2&quot;</span>&#125;,</span></span><br><span class="language-javascript"><span class="language-xml">            &#123;<span class="hljs-attr">message</span>:<span class="hljs-string">&quot;Test three&quot;</span>,<span class="hljs-attr">id</span>:<span class="hljs-string">&quot;3&quot;</span>&#125;</span></span><br><span class="language-javascript"><span class="language-xml">        ]</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">methods</span>:&#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">btn2Click</span>(<span class="hljs-params"></span>)&#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">set</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>,<span class="hljs-number">0</span>,&#123;<span class="hljs-attr">message</span>:<span class="hljs-string">&quot;Change Test&quot;</span>,<span class="hljs-attr">id</span>:<span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-property">length</span> + <span class="hljs-number">1</span>&#125;)</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">btn3Click</span>(<span class="hljs-params"></span>)&#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">var</span> itemLen=<span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-property">length</span>;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">set</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>,itemLen,&#123;<span class="hljs-attr">message</span>:<span class="hljs-string">&quot;Test add attr&quot;</span>,<span class="hljs-attr">id</span>:itemLen&#125;);</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;</span></span><br><span class="language-javascript"><span class="language-xml">&#125;);</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>有时想向已有对象上添加一些属性，例如使用 Object.assign() 或 _.extend() 方法来添加属性。但是，添加到对象上的新属性不会触发更新。在这种情况下可以创建一个新的对象，让它包含原对象的属性和新的属性.</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">// 代替 Object.assign(this.obj, &#123; a: 1, b: 2 &#125;)</span><br><span class="hljs-keyword">this</span>.obj= Object.assign(&#123;&#125;, <span class="hljs-keyword">this</span>.obj, &#123; a: <span class="hljs-number">1</span>, b: <span class="hljs-number">2</span> &#125;)<br></code></pre></td></tr></table></figure><h3 id="set-源码"><a href="#set-源码" class="headerlink" title="set 源码"></a>set 源码</h3><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>响应原理</title>
    <link href="/2021/10/03/2021/2021-10/10-03%E5%93%8D%E5%BA%94%E5%8E%9F%E7%90%861/"/>
    <url>/2021/10/03/2021/2021-10/10-03%E5%93%8D%E5%BA%94%E5%8E%9F%E7%90%861/</url>
    
    <content type="html"><![CDATA[<h3 id="认识-Object-defineProperty"><a href="#认识-Object-defineProperty" class="headerlink" title="认识 Object.defineProperty()"></a>认识 Object.defineProperty()</h3><p>Object.defineProperty() 方法会直接在一个对象上定义一个新属性，或者修改一个对象的现有属性，并返回此对象。</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-comment">//语法</span><br><span class="hljs-comment">// Object.defineProperty(&#x27;修改的对象&#x27;,&#x27;要修改的参数(key/index)&#x27;,&#x27;修改为的值&#x27;)</span><br><br><span class="hljs-built_in">Object</span>.defineProperty(object1, <span class="hljs-string">&#x27;property1&#x27;</span>, &#123;<br>  value: <span class="hljs-string">&#x27;&#x27;</span>,<br>  writable: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 可更换，重写</span><br>  configurable:<span class="hljs-literal">true</span>, <span class="hljs-comment">// 可配置，可删除</span><br>  enumerable:<span class="hljs-literal">true</span>, <span class="hljs-comment">//可枚举</span><br>  <span class="hljs-built_in">get</span>:fn, <span class="hljs-comment">//函数 获取</span><br>  <span class="hljs-built_in">set</span>:fn, <span class="hljs-comment">//函数 设置</span><br>&#125;);<br><br><span class="hljs-comment">// 使用方式</span><br><br>let obj = &#123;<br>    <span class="hljs-built_in">name</span>: <span class="hljs-string">&#x27;张三&#x27;</span>,<br>&#125;;<br>  let <span class="hljs-variable">_age</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-built_in">Object</span>.defineProperty(obj, <span class="hljs-string">&#x27;age&#x27;</span>, &#123;<br>    configurable: <span class="hljs-literal">true</span>,<br>    <span class="hljs-built_in">set</span>(newVal) &#123;<br>        <span class="hljs-variable">_age</span> = newVal<br>    &#125;,<br>    <span class="hljs-built_in">get</span>() &#123;<br>        return <span class="hljs-variable">_age</span><br>    &#125;<br>&#125;)<br><br></code></pre></td></tr></table></figure><h3 id="VUE-中的使用场景"><a href="#VUE-中的使用场景" class="headerlink" title="VUE 中的使用场景"></a>VUE 中的使用场景</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//简化的Vue defineReactive (只有一层data)</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">defineReactive</span>(<span class="hljs-params">target, key, value, enumerable</span>) &#123;<br>    <span class="hljs-comment">//函数内部是一个局部作用域，这个value就是在函数内部使用（闭包）</span><br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(target, key, &#123;<br>        <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">enumerable</span>: !!enumerable,<br>        <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;获取对象&#x27;</span> + key + <span class="hljs-string">&#x27;的值&#x27;</span>);<br>            <span class="hljs-keyword">return</span> value;<br>        &#125;,<br>        <span class="hljs-title function_">set</span>(<span class="hljs-params">newVal</span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`设置对象<span class="hljs-subst">$&#123;key&#125;</span>,值为<span class="hljs-subst">$&#123;newVal&#125;</span>`</span>);<br>            value = newVal;<br>        &#125;,<br>    &#125;)<br>&#125;;<br><span class="hljs-comment">// 使用将对象转换为响应式</span><br><span class="hljs-keyword">let</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj);<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-title function_">defineProperty</span>(obj, keys[i], obj[keys[i]], <span class="hljs-literal">true</span>)<br>&#125;<br><br></code></pre></td></tr></table></figure><p>(笔记)<br><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>动态组件/异步组件</title>
    <link href="/2021/09/20/2021/2021-09/09-20%E5%8A%A8%E6%80%81%E5%BC%82%E6%AD%A5%E7%BB%84%E4%BB%B6/"/>
    <url>/2021/09/20/2021/2021-09/09-20%E5%8A%A8%E6%80%81%E5%BC%82%E6%AD%A5%E7%BB%84%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<h3 id="动态组件"><a href="#动态组件" class="headerlink" title="动态组件"></a>动态组件</h3><p>一个多标签的界面中使用 is 来切换不同的组件,并可参考<a href="https://cn.vuejs.org/v2/api/#keep-alive">keep-alive 组件</a>将动态组件状态储存起来</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs ruby">component <span class="hljs-symbol">:is=<span class="hljs-string">&quot;nextName&quot;</span>&gt;&lt;/component&gt;</span><br><br>import <span class="hljs-keyword">next</span> from <span class="hljs-string">&#x27;./next&#x27;</span><br>export default &#123;<br>  <span class="hljs-symbol">components:</span>&#123;<br>    <span class="hljs-keyword">next</span>,<br>  &#125;,<br>  data() &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-symbol">nextName:</span><span class="hljs-string">&quot;next&quot;</span><br>    &#125;;<br>  &#125;,<br><br>&#125;;<br></code></pre></td></tr></table></figure><h4 id="切换不同的页面"><a href="#切换不同的页面" class="headerlink" title="切换不同的页面"></a>切换不同的页面</h4><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs axapta">&lt;<span class="hljs-keyword">div</span> id=<span class="hljs-string">&quot;example&quot;</span>&gt;<br>  &lt;button @click=<span class="hljs-string">&quot;change&quot;</span>&gt;切换页面&lt;/button&gt;<br>  &lt;component :<span class="hljs-keyword">is</span>=<span class="hljs-string">&quot;currentView&quot;</span>&gt;&lt;/component&gt;<br>&lt;/<span class="hljs-keyword">div</span>&gt;<br><br><span class="hljs-keyword">new</span> Vue(&#123;<br>  el: <span class="hljs-string">&#x27;#example&#x27;</span>,<br>  data:&#123;<br>    <span class="hljs-keyword">index</span>:<span class="hljs-number">0</span>,<br>    arr:[<br>      &#123;template:`&lt;<span class="hljs-keyword">div</span>&gt;我是页面A&lt;/<span class="hljs-keyword">div</span>&gt;`&#125;,<br>      &#123;template:`&lt;<span class="hljs-keyword">div</span>&gt;我是页面B&lt;/<span class="hljs-keyword">div</span>&gt;`&#125;,<br>      &#123;template:`&lt;<span class="hljs-keyword">div</span>&gt;我是页面C&lt;/<span class="hljs-keyword">div</span>&gt;`&#125;<br>    ],<br>  &#125;,<br>  computed:&#123;<br>    currentView()&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.arr[<span class="hljs-keyword">this</span>.<span class="hljs-keyword">index</span>];<br>    &#125;<br>  &#125;,<br>  methods:&#123;<br>    change()&#123;<br>      <span class="hljs-keyword">this</span>.<span class="hljs-keyword">index</span> = (++<span class="hljs-keyword">this</span>.<span class="hljs-keyword">index</span>)%<span class="hljs-number">3</span>;<br>    &#125;<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="异步组件"><a href="#异步组件" class="headerlink" title="异步组件"></a>异步组件</h3><p>异步组件就是定义的时候不做渲染运算，只在组件需要渲染（组件第一次显示）的时候进行加载渲染并缓存，缓存是以备下次访问。</p><h4 id="Vue-实现按需加载"><a href="#Vue-实现按需加载" class="headerlink" title="Vue 实现按需加载"></a>Vue 实现按需加载</h4><p>import() 函数 按需加载，异步加载大组件</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><br>&lt;FromDemo v-<span class="hljs-keyword">if</span>=<span class="hljs-string">&quot;show&quot;</span>/&gt;<br>&lt;button @click=<span class="hljs-string">&quot;show=true&quot;</span>&gt;&lt;/button&gt;<br><br><br>components:&#123;<br>  FromDemo:<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span><span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;../FromDemo&#x27;</span>)<br>&#125;<br><br><br></code></pre></td></tr></table></figure><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>v-if 和 v-show</title>
    <link href="/2021/09/10/2021/2021-09/09-10ifshow/"/>
    <url>/2021/09/10/2021/2021-09/09-10ifshow/</url>
    
    <content type="html"><![CDATA[<h3 id="相同点-不同点"><a href="#相同点-不同点" class="headerlink" title="相同点/不同点"></a>相同点/不同点</h3><ul><li>  相同点：相同使用方式，值为 true 时，满足条件元素显示，反则不显示。</li><li>  不同点：1. v-if 根据值在 DOM 中生成或移除一个元素。v-show 根据值来显示或者隐藏 HTML 元素。当 v-show 赋值为 false 时，元素被隐藏，此时查看代码时，该元素上会多一个内联样式 style=“display:none” 2.渲染元素的开销不同，v-if 有更高的切换消耗，而 v-show 初始渲染消耗较高。频繁切换，则使用 v-show 更好。</li></ul><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>过滤器filter</title>
    <link href="/2021/09/03/2021/2021-09/09-03Vue%E8%BF%87%E6%BB%A4%E5%99%A8/"/>
    <url>/2021/09/03/2021/2021-09/09-03Vue%E8%BF%87%E6%BB%A4%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<h3 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a><a href="https://cn.vuejs.org/v2/guide/filters.html">过滤器</a></h3><h2 id="全局过滤器"><a href="#全局过滤器" class="headerlink" title="全局过滤器"></a>全局过滤器</h2><p>我们可以直接在 vue 对象上使用 filter 方法注册过滤器，这种全局注册的过滤器在任何一个组件内都可以使用。</p><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs qml">Vue.filter(<span class="hljs-string">&#x27;formatTime&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> <span class="hljs-built_in">date</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(val);<br>  <span class="hljs-keyword">const</span> hour = <span class="hljs-built_in">date</span>.getHours();<br>  <span class="hljs-keyword">const</span> minutes = <span class="hljs-built_in">date</span>.getMinutes();<br>  <span class="hljs-keyword">const</span> seconds = <span class="hljs-built_in">date</span>.getSeconds();<br>  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">$&#123;hour&#125;</span> : <span class="hljs-subst">$&#123;minutes&#125;</span> : <span class="hljs-subst">$&#123;seconds&#125;</span>`</span>;<br>&#125;)<br></code></pre></td></tr></table></figure><h4 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h4><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>vue过滤器<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">new</span> Date() | formatTime&#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">1627742058904</span> | formatTime&#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br></code></pre></td></tr></table></figure><blockquote><p>可以串联使用 <code>&#123;&#123; value | filterA | filterB &#125;&#125; </code><br>可以传递参数<code>接收参数 &#123;&#123; value | filterA('arg1') &#125;&#125;</code></p></blockquote><h2 id="局部注册"><a href="#局部注册" class="headerlink" title="局部注册"></a>局部注册</h2><p>注册组件内部过滤器则只能在当前组件内使用</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">export default&#123;<br>    data <span class="hljs-literal">()</span> &#123;<br>        return &#123;&#125;<br>    &#125;,<br>    filters: &#123;<br>        format<span class="hljs-constructor">Time(<span class="hljs-params">val</span>,<span class="hljs-params">type</span>)</span>&#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">type</span>)&#123;<br>              return  <span class="hljs-keyword">new</span> <span class="hljs-constructor">Date(<span class="hljs-params">val</span>)</span>.form<span class="hljs-constructor">Date(<span class="hljs-params">type</span>)</span><br>            &#125;<br>          return <span class="hljs-keyword">new</span> <span class="hljs-constructor">Date(<span class="hljs-params">val</span>)</span>.form<span class="hljs-constructor">Date(&#x27;<span class="hljs-params">yyyy</span>-MM-DD <span class="hljs-params">hh</span>:<span class="hljs-params">mm</span>:<span class="hljs-params">ss</span>&#x27;)</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原生</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vue插槽</title>
    <link href="/2021/08/28/2021/2021-08/08-28Vue%E6%8F%92%E6%A7%BD/"/>
    <url>/2021/08/28/2021/2021-08/08-28Vue%E6%8F%92%E6%A7%BD/</url>
    
    <content type="html"><![CDATA[<h2 id="插槽"><a href="#插槽" class="headerlink" title="插槽"></a>插槽</h2><p>插槽就是子组件中的提供给父组件使用的一个占位符，用<code>&lt;slot&gt;&lt;/slot&gt;</code> 表示，父组件可以在这个占位符中填充任何模板代码，如 HTML、组件等，填充的内容会替换子组件的<code>&lt;slot&gt;&lt;/slot&gt;</code>标签。插槽使用会给我们带来很多便利。<a href="https://cn.vuejs.org/v2/guide/components-slots.html#%E6%8F%92%E6%A7%BD%E5%86%85%E5%AE%B9">vue 官网插槽</a></p><h2 id="主要"><a href="#主要" class="headerlink" title="主要"></a>主要</h2><h4 id="默认插槽-lt-slot-gt-lt-slot-gt"><a href="#默认插槽-lt-slot-gt-lt-slot-gt" class="headerlink" title="默认插槽 &lt;slot&gt;&lt;/slot&gt;"></a>默认插槽 <code>&lt;slot&gt;&lt;/slot&gt;</code></h4><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs xquery">// 子组件<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">  </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">      </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>今天天气：<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml">      </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">slot</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> </span></span><span class="language-xquery">&#123;</span><br><span class="language-xquery">     <span class="hljs-built_in"> name</span>: <span class="hljs-string">&#x27;child&#x27;</span></span><br><span class="language-xquery">  &#125;</span><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br>// 父组件<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">  </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">      </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>使用slot分发内容<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml">      </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">          </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">child</span>&gt;</span></span><br><span class="language-xml">              <span class="hljs-tag">&lt;<span class="hljs-name">div</span> &gt;</span>小雨，最高气温34度，最低气温28度，微风<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml">          <span class="hljs-tag">&lt;/<span class="hljs-name">child</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>&lt;/template&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-keyword">import</span> child <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./child.vue&quot;</span>;</span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> </span></span><span class="language-xquery">&#123;</span><br><span class="language-xquery">     <span class="hljs-built_in"> name</span>: <span class="hljs-string">&#x27;father&#x27;</span>,</span><br><span class="language-xquery">      components:&#123;</span><br><span class="language-xquery">          child</span><br><span class="language-xquery">      &#125;</span><span class="language-xml"></span><br><span class="language-xml">  &#125;</span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><br></code></pre></td></tr></table></figure><h4 id="具名插槽-lt-slot-name-quot-xxx-quot-gt-lt-slot-gt-v-slot-name-”xxx”"><a href="#具名插槽-lt-slot-name-quot-xxx-quot-gt-lt-slot-gt-v-slot-name-”xxx”" class="headerlink" title="具名插槽 &lt;slot name=&quot;xxx&quot;&gt;&lt;/slot&gt; v-slot:name =”xxx”"></a>具名插槽 <code>&lt;slot name=&quot;xxx&quot;&gt;&lt;/slot&gt;</code> v-slot:name =”xxx”</h4><blockquote><p>子组件定义插槽，名称位置。父组件填充内容, 父组件通过 v-slot:[name] 的方式指定到对应的插槽中.<br>父级模板里的所有内容都是在父级作用域中编译的；子模板里的所有内容都是在子作用域中编译的。</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs xml">---子组件---<br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;title&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;title&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>今天天气：<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">slot</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;child&quot;</span></span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><br>---父组件---<br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>slot内容分发<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">child</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">slot</span>=<span class="hljs-string">&quot;title&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>天气预报<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> &gt;</span>小雨，最高气温34度，最低气温28度，微风<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">child</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">import</span> child <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./child.vue&quot;</span>;</span><br><span class="language-javascript">    <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;father1&quot;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">components</span>: &#123;</span><br><span class="language-javascript">            child</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><br></code></pre></td></tr></table></figure><h3 id="作用域插槽"><a href="#作用域插槽" class="headerlink" title="作用域插槽"></a>作用域插槽</h3><p>带数据的插槽，作用域插槽绑定了一套数据，父组件可以拿来用。于是，情况就变成了这样：样式父组件说了算，但内容可以显示子组件插槽绑定的。</p><h5 id="slots-插槽-通过-vm-slots-可以访问到插槽分发的内容，每个具名插槽都有对应的property（-slots-header）-default-property-包括了所有没有包含在具名插槽中的节点-default-内容（插槽不是响应式的）"><a href="#slots-插槽-通过-vm-slots-可以访问到插槽分发的内容，每个具名插槽都有对应的property（-slots-header）-default-property-包括了所有没有包含在具名插槽中的节点-default-内容（插槽不是响应式的）" class="headerlink" title="slots 插槽 通过 vm.$slots 可以访问到插槽分发的内容，每个具名插槽都有对应的property（$slots.header） default property 包括了所有没有包含在具名插槽中的节点 default 内容（插槽不是响应式的）"></a>slots 插槽 通过 vm.$slots 可以访问到插槽分发的内容，每个具名插槽都有对应的property（$slots.header） default property 包括了所有没有包含在具名插槽中的节点 default 内容（插槽不是响应式的）</h5><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vue响应数据原理</title>
    <link href="/2021/08/16/2021/2021-08/08-16Vue%E7%BB%84%E4%BB%B6%E5%93%8D%E5%BA%94%E5%BC%8F/"/>
    <url>/2021/08/16/2021/2021-08/08-16Vue%E7%BB%84%E4%BB%B6%E5%93%8D%E5%BA%94%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h2 id="响应式原理（Vue-2x）"><a href="#响应式原理（Vue-2x）" class="headerlink" title="响应式原理（Vue.2x）"></a><a href="https://cn.vuejs.org/v2/guide/reactivity.html">响应式原理（Vue.2x）</a></h2><p>官网上介绍了， Vue2.x 版本数据绑定原理其主要于使用<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty">Object.defineProperty()</a>的方法，对数据进行了<code>getter/setter</code>数据劫持。</p><h3 id="Object-defineProperty"><a href="#Object-defineProperty" class="headerlink" title="Object.defineProperty()"></a>Object.defineProperty()</h3><blockquote><p>Object.defineProperty 需要三个参数（object , propName , descriptor）</p></blockquote><ul><li>  object 对象 =&gt; 添加的对象</li><li>  propName 属性名 =&gt; 要加的属性的名字 【类型：String】</li><li>  descriptor 属性描述 =&gt; 加的这个属性值【类型：Object】</li></ul><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">var</span> message = <span class="hljs-string">&#x27;hello world&#x27;</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-keyword">data</span> = &#123;&#125;;<br>Object.defineProperty(<span class="hljs-keyword">data</span>, <span class="hljs-string">&#x27;message&#x27;</span>, &#123;<br>   <span class="hljs-keyword">get</span>() &#123;<br>       <span class="hljs-keyword">return</span> message;<br>   &#125;,<br>   <span class="hljs-keyword">set</span>(newVal) &#123;<br>       message = newVal;<br>   &#125;<br>&#125;);<br><span class="hljs-keyword">data</span>.message <span class="hljs-comment">// &#x27;hello world&#x27;</span><br><span class="hljs-keyword">data</span>.message = <span class="hljs-string">&#x27;test&#x27;</span> <span class="hljs-comment">// &#x27;test&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="Vue-中实现数据劫持过程"><a href="#Vue-中实现数据劫持过程" class="headerlink" title="Vue 中实现数据劫持过程"></a>Vue 中实现数据劫持过程</h2><blockquote><p>经典的例子</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> data = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;你不知道的VUE&#x27;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>,<br>    <span class="hljs-attr">info</span>: &#123;<br>        <span class="hljs-attr">address</span>: <span class="hljs-string">&#x27;北京&#x27;</span><br>    &#125;,<br>    <span class="hljs-attr">numbers</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<br>&#125;;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">observerObject</span>(<span class="hljs-params">target, name, value</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">&#x27;object&#x27;</span> || <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(target)) &#123;<br>        <span class="hljs-title function_">observer</span>(value);<br>    &#125;<br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(target, name, &#123;<br>        <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">return</span> value;<br>        &#125;,<br>        <span class="hljs-title function_">set</span>(<span class="hljs-params">newVal</span>) &#123;<br>            <span class="hljs-keyword">if</span> (newVal !== value) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">&#x27;object&#x27;</span> || <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(value)) &#123;<br>                    <span class="hljs-title function_">observer</span>(value);<br>                &#125;<br>                value = newVal;<br>            &#125;<br>            <span class="hljs-title function_">renderView</span>();<br>        &#125;<br>    &#125;);<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">observer</span>(<span class="hljs-params">target</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> target !== <span class="hljs-string">&#x27;object&#x27;</span> || !target) &#123;<br>        <span class="hljs-keyword">return</span> target;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> target) &#123;<br>        <span class="hljs-keyword">if</span> (target.<span class="hljs-title function_">hasOwnProperty</span>(key)) &#123;<br>            <span class="hljs-keyword">const</span> value = target[key];<br>            <span class="hljs-title function_">observerObject</span>(target, key, value);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-title function_">observer</span>(data);<br></code></pre></td></tr></table></figure><p>遍历这个 data 对象，对每一个属性都使用 observerObject 方法进行数据劫持。</p><p>observerObject 主要做的就是使用 Object.defineProperty 去监听传入的属性，如果 target 是一个对象的话，就递归执行 observer，确保 data 中所有的对象中的所以属性都能够被监听到。当我们 set 的时候，去执行 renderView（执行视图渲染相关逻辑）。</p><h3 id="Object-defineProperty-局限性"><a href="#Object-defineProperty-局限性" class="headerlink" title="Object.defineProperty 局限性"></a>Object.defineProperty 局限性</h3><ol><li> 递归遍历所有的对象的属性，这样如果我们数据层级比较深的话，是一件很耗费性能的事情</li><li> 只能应用在对象上，不能用于数组</li><li> 只能够监听定义时的属性，不能监听新加的属性，这也就是为什么在 vue 中要使用 Vue.set/vue.detele</li></ol><h2 id="Proxy-Vue3"><a href="#Proxy-Vue3" class="headerlink" title="Proxy(Vue3)"></a><a href="https://v3.cn.vuejs.org/guide/reactivity.html#proxy-vs-%E5%8E%9F%E5%A7%8B%E6%A0%87%E8%AF%86">Proxy(Vue3)</a></h2><ul><li><p>  使用了 proxy 去实现对象的监听，在目标对象之前架设一层“拦截”，外界对该对象的访问，都必须先通过这层拦截，因此提供了一种机制，可以对外界的访问进行过滤和改写。</p></li><li><p>  Proxy 对拦截操作多达 13 种，所以在这 13 中操作中，我们可以自定义很多逻辑。Proxy 的出现，其实就是为了扩展对象的能力。</p></li></ul><h3 id="proxy-MDN"><a href="#proxy-MDN" class="headerlink" title="proxy MDN"></a><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy">proxy MDN</a></h3><p><code>new Proxy(target, handler)</code><br>target: 拦截的目标对象<br>handler：定义拦截的方法</p><ul><li>  handler.apply</li><li>  handler.construct 拦截构造函数调用 new Example（）</li><li>  handler.difineProperty</li><li>  handler.get 拦截对象属性的读取 obj.name</li><li>  handler.set 拦截对象属性的设置 obj.name = ‘前端的自我修养’</li><li>  handler.getOwnPropertyDwscriptor</li><li>  handler.has</li><li>  handler.ownKeys 拦截 Object.keys for in 等</li><li>  handler.setPrototypeOf</li><li>  handler.isExtensible</li><li>  handler.getPropertyOf</li><li>  handler.preventExtensiions</li><li>  handler.enumerate</li></ul><h3 id="Refect"><a href="#Refect" class="headerlink" title="Refect"></a>Refect</h3><ul><li>  将 Object 对象的一些明显属于语言内部的方法（比如 Object.defineProperty），放到 Reflect 对象上。</li><li>  修改某些 Object 方法的返回结果，让其变得更合理。比如，Object.defineProperty(obj, name, desc)在无法定义属性时，会抛出一个错误，而 Reflect.defineProperty(obj, name, desc)则会返回 false。</li><li>  让 Object 操作都变成函数行为。比如 name in obj 和 delete obj[name]，而 Reflect.has(obj, name)和 Reflect.deleteProperty(obj, name)让它们变成了函数行为。</li><li>  Reflect 对象的方法与 Proxy 对象的方法一一对应，只要是 Proxy 对象的方法，就能在 Reflect 对象上找到对应的方法。这就让 Proxy 对象可以方便地调用对应的* Reflect 方法，完成默认行为，作为修改行为的基础。也就是说，不管 Proxy 怎么修改默认行为，你总可以在 Reflect 上获取默认行为。</li></ul><h3 id="数据劫持相应"><a href="#数据劫持相应" class="headerlink" title="数据劫持相应"></a>数据劫持相应</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">observe</span>(<span class="hljs-params">target</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> target !== <span class="hljs-string">&#x27;object&#x27;</span> || target == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> target;<br>    &#125;<br>    <span class="hljs-keyword">const</span> obseved = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(target, &#123;<br>        <span class="hljs-title function_">get</span>(<span class="hljs-params">target, key, receiver</span>) &#123;<br>           <span class="hljs-keyword">return</span> <span class="hljs-title function_">observe</span>(<span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">get</span>(target, key, receiver);)<br><br>        &#125;,<br>        <span class="hljs-title function_">set</span>(<span class="hljs-params">target, key, value, receiver</span>) &#123;<br>            <span class="hljs-keyword">if</span> (value === target[key]) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>            <span class="hljs-keyword">const</span> ownKeys = <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">ownKeys</span>(target);<br>              <span class="hljs-keyword">if</span> (ownKeys.<span class="hljs-title function_">includes</span>(key)) &#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;旧属性&#x27;</span>);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;新添加的属性&#x27;</span>);<br><br>           <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">set</span>(target, key, value, receiver);<br><br><br>        &#125;,<br>        <span class="hljs-title function_">deleteProperty</span>(<span class="hljs-params">target, key</span>) &#123;<br>           <span class="hljs-keyword">return</span> result  <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">deleteProperty</span>(target, key);<br><br>        &#125;<br>    &#125;);<br>    <span class="hljs-keyword">return</span> obseved;<br>&#125;<br><span class="hljs-keyword">const</span> data = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;你不知道的前端&#x27;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>,<br>    <span class="hljs-attr">info</span>: &#123;<br>        <span class="hljs-attr">city</span>:<span class="hljs-string">&#x27;beijing&#x27;</span><br>    &#125;，<br>    <span class="hljs-attr">numbers</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<br>&#125;;<br><span class="hljs-keyword">const</span> proxyData = <span class="hljs-title function_">observe</span>(data<br></code></pre></td></tr></table></figure><h4 id="proxy-在实现数据劫持时，具有以下优点"><a href="#proxy-在实现数据劫持时，具有以下优点" class="headerlink" title="proxy 在实现数据劫持时，具有以下优点"></a>proxy 在实现数据劫持时，具有以下优点</h4><ul><li>  proxy 可以直接监听数组的修改</li><li>  proxy 可以直接监听属性的新增和删除</li><li>  在实现深度监听的时候，只有在 data 对象的属性被访问的时候，才去对这个属性做监听处理，而不是一次性递归所有的。</li></ul><blockquote><p>内容便于自身理解，并非 vue 源码实现<br>部分内容转载于 知乎-<a href="https://zhuanlan.zhihu.com/p/111591503">Vue 如何实现数据劫持</a></p></blockquote><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vue自定义指令学习总结</title>
    <link href="/2021/08/10/2021/2021-08/08-10Vue%E6%8C%87%E4%BB%A4%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0/"/>
    <url>/2021/08/10/2021/2021-08/08-10Vue%E6%8C%87%E4%BB%A4%E6%89%A9%E5%B1%95%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h2 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h2><p>封装常规业务的自定义指令，理解自定义指令各钩子函数意义。<a href="https://cn.vuejs.org/v2/guide/custom-directive.html">vue 官网-自定义指令</a></p><h2 id="主要"><a href="#主要" class="headerlink" title="主要"></a>主要</h2><ul><li>  <code>bind</code>: 只调用一次，指令第一次绑定到元素时调用，可以定义一个在绑定时执行一次的初始化动作。</li><li>  <code>inserted</code>: 被绑定元素插入父节点时调用（父节点存在即可调用，不必存在于 document 中)。</li><li>  <code>update</code>: 被绑定元素所在的模板更新时调用，而不论绑定值是否变化。通过比较更新前后的绑定值。</li><li>  <code>componentUpdated</code>: 被绑定元素所在模板完成一次更新周期时调用。</li><li>  <code>unbind</code>: 只调用一次， 指令与元素解绑时调用。</li></ul><h2 id="实例代码"><a href="#实例代码" class="headerlink" title="实例代码"></a>实例代码</h2><h3 id="v-copy"><a href="#v-copy" class="headerlink" title="v-copy"></a>v-copy</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs stylus">const copy = &#123;<br> <span class="hljs-built_in">bind</span>(el, &#123; value &#125;) &#123;<br>   el.<span class="hljs-variable">$value</span> = value<br>   el<span class="hljs-selector-class">.handler</span> = () =&gt; &#123;<br>     <span class="hljs-keyword">if</span> (!el.<span class="hljs-variable">$value</span>) &#123;<br>       <span class="hljs-comment">// 值为空的时候，给出提示。可根据项目UI仔细设计</span><br>       console<span class="hljs-selector-class">.log</span>(<span class="hljs-string">&#x27;无复制内容&#x27;</span>)<br>       return<br>     &#125;<br>     <span class="hljs-comment">// 动态创建 textarea 标签</span><br>     const <span class="hljs-selector-tag">textarea</span> = document<span class="hljs-selector-class">.createElement</span>(<span class="hljs-string">&#x27;textarea&#x27;</span>)<br>     <span class="hljs-comment">// 将该 textarea 设为 readonly 防止 iOS 下自动唤起键盘，同时将 textarea 移出可视区域</span><br>     <span class="hljs-selector-tag">textarea</span><span class="hljs-selector-class">.readOnly</span> =<span class="hljs-string">&#x27;readonly&#x27;</span><br>     <span class="hljs-selector-tag">textarea</span><span class="hljs-selector-class">.style</span><span class="hljs-selector-class">.position</span> =<span class="hljs-string">&#x27;absolute&#x27;</span><br>     <span class="hljs-selector-tag">textarea</span><span class="hljs-selector-class">.style</span><span class="hljs-selector-class">.left</span> =<span class="hljs-string">&#x27;-9999px&#x27;</span><br>     <span class="hljs-comment">// 将要 copy 的值赋给 textarea 标签的 value 属性</span><br>     <span class="hljs-selector-tag">textarea</span><span class="hljs-selector-class">.value</span> = el.<span class="hljs-variable">$value</span><br>     <span class="hljs-comment">// 将 textarea 插入到 body 中</span><br>     document<span class="hljs-selector-class">.body</span><span class="hljs-selector-class">.appendChild</span>(textarea)<br>     <span class="hljs-comment">// 选中值并复制</span><br>     <span class="hljs-selector-tag">textarea</span><span class="hljs-selector-class">.select</span>()<br>     const result = document<span class="hljs-selector-class">.execCommand</span>(<span class="hljs-string">&#x27;Copy&#x27;</span>)<br>     <span class="hljs-keyword">if</span> (result) &#123;<br>       console<span class="hljs-selector-class">.log</span>(<span class="hljs-string">&#x27;复制成功&#x27;</span>)<span class="hljs-comment">// 可根据项目UI仔细设计</span><br>     &#125;<br>     document<span class="hljs-selector-class">.body</span><span class="hljs-selector-class">.removeChild</span>(textarea)<br>   &#125;<br>   <span class="hljs-comment">// 绑定点击事件，就是所谓的一键 copy 啦</span><br>   el<span class="hljs-selector-class">.addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, el.handler)<br> &#125;,<br> <span class="hljs-comment">// 当传进来的值更新的时候触发</span><br> <span class="hljs-built_in">componentUpdated</span>(el, &#123; value &#125;) &#123;<br>   el.<span class="hljs-variable">$value</span> = value<br> &#125;,<br> <span class="hljs-comment">// 指令与元素解绑的时候，移除事件绑定</span><br> <span class="hljs-built_in">unbind</span>(el) &#123;<br>   el<span class="hljs-selector-class">.removeEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, el.handler)<br> &#125;,<br>&#125;<br><br>export default copy<br><br><span class="hljs-comment">// 使用方式</span><br>&lt;template&gt;<br> &lt;<span class="hljs-selector-tag">button</span> v-copy=<span class="hljs-string">&quot;copyText&quot;</span>&gt;复制&lt;/button&gt;<br>&lt;/template&gt;<br><br>&lt;script&gt;export default &#123;<br>   <span class="hljs-built_in">data</span>() &#123;<br>     return &#123;<br>       copyText:<span class="hljs-string">&#x27;a copy directives&#x27;</span>,<br>     &#125;<br>   &#125;,<br> &#125; &lt;/script&gt;<br><br></code></pre></td></tr></table></figure><h3 id="v-int（正整数）-v-Float（两位小数）"><a href="#v-int（正整数）-v-Float（两位小数）" class="headerlink" title="v-int（正整数） v-Float（两位小数）"></a>v-int（正整数） v-Float（两位小数）</h3><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs arcade">import Vue from <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-comment">// 针对 input做的限制，只能输入正整数</span><br>Vue.directive(<span class="hljs-string">&#x27;Int&#x27;</span>, &#123;<br>    <span class="hljs-attr">bind</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">el, binding, vnode</span>) &#123;<br>        <span class="hljs-comment">// 针对 el-input做的限制，只能输入正整数</span><br>        <span class="hljs-comment">// if (binding.expression == &quot;el&quot;) &#123;</span><br>        <span class="hljs-comment">//   input = el.getElementsByTagName(&#x27;input&#x27;)[0]</span><br>        <span class="hljs-comment">// &#125; else &#123;</span><br>        <span class="hljs-comment">//   input = el</span><br>        <span class="hljs-comment">// &#125;</span><br>        const input = el.getElementsByTagName(<span class="hljs-string">&#x27;input&#x27;</span>)[<span class="hljs-number">0</span>]<br>        input.onkeyup = <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">if</span> (input.value.<span class="hljs-built_in">length</span> === <span class="hljs-number">1</span>) &#123;<br>                input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/[^0-9]/g</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/[^\d]/g</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>                input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/\b(0+)/gi</span>, <span class="hljs-string">&quot;&quot;</span>)<br>            &#125;<br>            trigger(input, <span class="hljs-string">&#x27;input&#x27;</span>)<br>        &#125;<br>        input.onblur = <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">if</span> (input.value.<span class="hljs-built_in">length</span> === <span class="hljs-number">1</span>) &#123;<br>                input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/[^0-9]/g</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/[^\d]/g</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>                input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/\b(0+)/gi</span>, <span class="hljs-string">&quot;&quot;</span>)<br>            &#125;<br>            trigger(input, <span class="hljs-string">&#x27;input&#x27;</span>)<br>        &#125;<br>    &#125;<br>&#125;)<br><br><span class="hljs-comment">// 针对 input做的限制，能输入2位小数</span><br>Vue.directive(<span class="hljs-string">&#x27;Float&#x27;</span>, &#123;<br>    <span class="hljs-attr">bind</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">el, binding, vnode</span>) &#123;<br>        <span class="hljs-comment">// let input = undefined</span><br>        <span class="hljs-comment">// 针对 el-input做的限制，只能输入正整数</span><br>        <span class="hljs-comment">// if (binding.expression == &quot;el&quot;) &#123;</span><br>        <span class="hljs-comment">//   input = el.getElementsByTagName(&#x27;input&#x27;)[0]</span><br>        <span class="hljs-comment">// &#125; else &#123;</span><br>        <span class="hljs-comment">//   input = el</span><br>        <span class="hljs-comment">// &#125;</span><br>        const input = el.getElementsByTagName(<span class="hljs-string">&#x27;input&#x27;</span>)[<span class="hljs-number">0</span>]<br>        input.onkeyup = <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br>            input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/[^\d.]/g</span>, <span class="hljs-string">&#x27;&#x27;</span>);<br>            input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/\.&#123;2,&#125;/g</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>            input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/^\./g</span>, <span class="hljs-string">&#x27;0.&#x27;</span>);<br>            input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/^\d*\.\d*\./g</span>, input.value.substring(<span class="hljs-number">0</span>, input.value.<span class="hljs-built_in">length</span> - <span class="hljs-number">1</span>));<br>            input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/^0[^\.]+/g</span>, <span class="hljs-string">&#x27;0&#x27;</span>)<br>            input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/^(\d+)\.(\d\d).*$/</span>, <span class="hljs-string">&#x27;$1.$2&#x27;</span>)<br>            trigger(input, <span class="hljs-string">&#x27;input&#x27;</span>)<br>        &#125;<br>        input.onblur = <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br>            input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/[^\d.]/g</span>, <span class="hljs-string">&#x27;&#x27;</span>);<br>            input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/\.&#123;2,&#125;/g</span>, <span class="hljs-string">&#x27;.&#x27;</span>);<br>            input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/^\./g</span>, <span class="hljs-string">&#x27;0.&#x27;</span>);<br>            input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/^\d*\.\d*\./g</span>, input.value.substring(<span class="hljs-number">0</span>, input.value.<span class="hljs-built_in">length</span> - <span class="hljs-number">1</span>));<br>            input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/^0[^\.]+/g</span>, <span class="hljs-string">&#x27;0&#x27;</span>)<br>            input.value = input.value.<span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/^(\d+)\.(\d\d).*$/</span>, <span class="hljs-string">&#x27;$1.$2&#x27;</span>)<br>            trigger(input, <span class="hljs-string">&#x27;input&#x27;</span>)<br>        &#125;<br>    &#125;<br>&#125;)<br>const trigger = <span class="hljs-function">(<span class="hljs-params">el, type</span>) =&gt;</span> &#123;<br>    const e = document.createEvent(<span class="hljs-string">&#x27;HTMLEvents&#x27;</span>)<br>    e.initEvent(type, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>)<br>    el.dispatchEvent(e)<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="v-debounce"><a href="#v-debounce" class="headerlink" title="v-debounce"></a>v-debounce</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 防止按钮在短时间内被多次点击，使用防抖函数限制规定时间内只能点击一次。</span><br><span class="hljs-keyword">const</span> debounce = &#123;<br>  <span class="hljs-attr">inserted</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">el, binding</span>) &#123;<br>    <span class="hljs-keyword">let</span> timer<br>    el.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;keyup&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span> (timer) &#123;<br>        <span class="hljs-built_in">clearTimeout</span>(timer)<br>      &#125;<br>      timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        binding.<span class="hljs-title function_">value</span>()<br>      &#125;, <span class="hljs-number">1000</span>)<br>    &#125;)<br>  &#125;,<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> debounce<br></code></pre></td></tr></table></figure><h3 id="v-emoji"><a href="#v-emoji" class="headerlink" title="v-emoji"></a>v-emoji</h3><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-comment">// 根据正则表达式，设计自定义处理表单输入规则的指令，下面以禁止输入表情和特殊字符为例。</span><br>let findEle = <span class="hljs-function">(<span class="hljs-params">parent, type</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> parent.tagName.toLowerCase() === type ? parent : parent.querySelector(type)<br>&#125;<br><br>const trigger = <span class="hljs-function">(<span class="hljs-params">el, type</span>) =&gt;</span> &#123;<br>  const e = document.createEvent(<span class="hljs-string">&#x27;HTMLEvents&#x27;</span>)<br>  e.initEvent(type,<span class="hljs-literal">true</span>,<span class="hljs-literal">true</span>)<br>  el.dispatchEvent(e)<br>&#125;<br><br>const emoji = &#123;<br>  <span class="hljs-attr">bind</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">el, binding, vnode</span>) &#123;<br>    <span class="hljs-comment">// 正则规则可根据需求自定义</span><br>    <span class="hljs-keyword">var</span> regRule = <span class="hljs-regexp">/[^u4E00-u9FA5|d|a-zA-Z|rns,.?!，。？！…—&amp;$=()-+/*&#123;&#125;[]]|s/g</span><br>    let <span class="hljs-symbol">$i</span>np = findEle(el,<span class="hljs-string">&#x27;input&#x27;</span>)<br>    el.<span class="hljs-symbol">$i</span>np = <span class="hljs-symbol">$i</span>np<br>    <span class="hljs-symbol">$i</span>np.handle =<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>      let val = <span class="hljs-symbol">$i</span>np.value<br>      <span class="hljs-symbol">$i</span>np.value = val.<span class="hljs-built_in">replace</span>(regRule,<span class="hljs-string">&#x27;&#x27;</span>)<br><br>      trigger(<span class="hljs-symbol">$i</span>np,<span class="hljs-string">&#x27;input&#x27;</span>)<br>    &#125;<br>    <span class="hljs-symbol">$i</span>np.addEventListener(<span class="hljs-string">&#x27;keyup&#x27;</span>, <span class="hljs-symbol">$i</span>np.handle)<br>  &#125;,<br>  <span class="hljs-attr">unbind</span>:<span class="hljs-keyword">function</span> (<span class="hljs-params">el</span>) &#123;<br>    el.<span class="hljs-symbol">$i</span>np.removeEventListener(<span class="hljs-string">&#x27;keyup&#x27;</span>, el.<span class="hljs-symbol">$i</span>np.handle)<br>  &#125;,<br>&#125;<br><br>export default emoji<br><br><span class="hljs-comment">//使用</span><br>&lt;template&gt;<br>  &lt;input type=<span class="hljs-string">&quot;text&quot;</span> v-model=<span class="hljs-string">&quot;note&quot;</span> v-emoji /&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure><h3 id="v-LazyLoad"><a href="#v-LazyLoad" class="headerlink" title="v-LazyLoad"></a>v-LazyLoad</h3><blockquote><p>实现一个图片懒加载指令，只加载浏览器可见区域的图片。</p></blockquote><p>思路：<br>图片懒加载的原理主要是判断当前图片是否到了可视区域这一核心逻辑实现的<br>拿到所有的图片 Dom ，遍历每个图片判断当前图片是否到了可视区范围内<br>如果到了就设置图片的 src 属性，否则显示默认图片</p><blockquote><p>图片懒加载有两种方式可以实现，一是绑定 srcoll 事件进行监听，二是使用 IntersectionObserver 判断图片是否到了可视区域，但是有浏览器兼容性问题。</p></blockquote><p>下面封装一个懒加载指令兼容两种方法，判断浏览器是否支持 IntersectionObserver API，如果支持就使用 IntersectionObserver 实现懒加载，否则则使用 srcoll 事件监听 + 节流的方法实现。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">LazyLoad</span> = &#123;<br>  <span class="hljs-comment">// install方法</span><br>  <span class="hljs-title function_">install</span>(<span class="hljs-params">Vue, options</span>) &#123;<br>    <span class="hljs-keyword">const</span> defaultSrc = options.<span class="hljs-property">default</span><br>    <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">directive</span>(<span class="hljs-string">&#x27;lazy&#x27;</span>, &#123;<br>      <span class="hljs-title function_">bind</span>(<span class="hljs-params">el, binding</span>) &#123;<br>        <span class="hljs-title class_">LazyLoad</span>.<span class="hljs-title function_">init</span>(el, binding.<span class="hljs-property">value</span>, defaultSrc)<br>      &#125;,<br>      <span class="hljs-title function_">inserted</span>(<span class="hljs-params">el</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">IntersectionObserver</span>) &#123;<br>          <span class="hljs-title class_">LazyLoad</span>.<span class="hljs-title function_">observe</span>(el)<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-title class_">LazyLoad</span>.<span class="hljs-title function_">listenerScroll</span>(el)<br>        &#125;<br>      &#125;,<br>    &#125;)<br>  &#125;,<br>  <span class="hljs-comment">// 初始化</span><br>  <span class="hljs-title function_">init</span>(<span class="hljs-params">el, val, def</span>) &#123;<br>    el.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;data-src&#x27;</span>, val)<br>    el.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;src&#x27;</span>, def)<br>  &#125;,<br>  <span class="hljs-comment">// 利用IntersectionObserver监听el</span><br>  <span class="hljs-title function_">observe</span>(<span class="hljs-params">el</span>) &#123;<br>    <span class="hljs-keyword">var</span> io =<span class="hljs-keyword">new</span> <span class="hljs-title class_">IntersectionObserver</span>(<span class="hljs-function">(<span class="hljs-params">entries</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">const</span> realSrc = el.<span class="hljs-property">dataset</span>.<span class="hljs-property">src</span><br>      <span class="hljs-keyword">if</span> (entries[<span class="hljs-number">0</span>].<span class="hljs-property">isIntersecting</span>) &#123;<br>        <span class="hljs-keyword">if</span> (realSrc) &#123;<br>          el.<span class="hljs-property">src</span> = realSrc<br>          el.<span class="hljs-title function_">removeAttribute</span>(<span class="hljs-string">&#x27;data-src&#x27;</span>)<br>        &#125;<br>      &#125;<br>    &#125;)<br>    io.<span class="hljs-title function_">observe</span>(el)<br>  &#125;,<br>  <span class="hljs-comment">// 监听scroll事件</span><br>  <span class="hljs-title function_">listenerScroll</span>(<span class="hljs-params">el</span>) &#123;<br>    <span class="hljs-keyword">const</span> handler = <span class="hljs-title class_">LazyLoad</span>.<span class="hljs-title function_">throttle</span>(<span class="hljs-title class_">LazyLoad</span>.<span class="hljs-property">load</span>, <span class="hljs-number">300</span>)<br>    <span class="hljs-title class_">LazyLoad</span>.<span class="hljs-title function_">load</span>(el)<br>    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;scroll&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-title function_">handler</span>(el)<br>    &#125;)<br>  &#125;,<br>  <span class="hljs-comment">// 加载真实图片</span><br>  <span class="hljs-title function_">load</span>(<span class="hljs-params">el</span>) &#123;<br>    <span class="hljs-keyword">const</span> windowHeight = <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">clientHeight</span><br>    <span class="hljs-keyword">const</span> elTop = el.<span class="hljs-title function_">getBoundingClientRect</span>().<span class="hljs-property">top</span><br>    <span class="hljs-keyword">const</span> elBtm = el.<span class="hljs-title function_">getBoundingClientRect</span>().<span class="hljs-property">bottom</span><br>    <span class="hljs-keyword">const</span> realSrc = el.<span class="hljs-property">dataset</span>.<span class="hljs-property">src</span><br>    <span class="hljs-keyword">if</span> (elTop - windowHeight &lt; <span class="hljs-number">0</span> &amp;&amp; elBtm &gt; <span class="hljs-number">0</span>) &#123;<br>      <span class="hljs-keyword">if</span> (realSrc) &#123;<br>        el.<span class="hljs-property">src</span> = realSrc<br>        el.<span class="hljs-title function_">removeAttribute</span>(<span class="hljs-string">&#x27;data-src&#x27;</span>)<br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-comment">// 节流</span><br>  <span class="hljs-title function_">throttle</span>(<span class="hljs-params">fn, delay</span>) &#123;<br>    <span class="hljs-keyword">let</span> timer<br>    <span class="hljs-keyword">let</span> prevTime<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">...args</span>) &#123;<br>      <span class="hljs-keyword">const</span> currTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()<br>      <span class="hljs-keyword">const</span> context =<span class="hljs-variable language_">this</span><br>      <span class="hljs-keyword">if</span> (!prevTime) prevTime = currTime<br>      <span class="hljs-built_in">clearTimeout</span>(timer)<br><br>      <span class="hljs-keyword">if</span> (currTime - prevTime &gt; delay) &#123;<br>        prevTime = currTime<br>        fn.<span class="hljs-title function_">apply</span>(context, args)<br>        <span class="hljs-built_in">clearTimeout</span>(timer)<br>        <span class="hljs-keyword">return</span><br>      &#125;<br><br>      timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        prevTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()<br>        timer =<span class="hljs-literal">null</span><br>        fn.<span class="hljs-title function_">apply</span>(context, args)<br>      &#125;, delay)<br>    &#125;<br>  &#125;,<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">LazyLoad</span><br><br><span class="hljs-comment">// 使用</span><br>&lt;img v-<span class="hljs-title class_">LazyLoad</span>=<span class="hljs-string">&quot;xxx.jpg&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><h3 id="批量注册"><a href="#批量注册" class="headerlink" title="批量注册"></a>批量注册</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> copy <span class="hljs-keyword">from</span><span class="hljs-string">&#x27;./copy&#x27;</span><br><span class="hljs-keyword">import</span> debounce <span class="hljs-keyword">from</span><span class="hljs-string">&#x27;./debounce&#x27;</span><br><span class="hljs-comment">// 自定义指令</span><br><span class="hljs-keyword">const</span> directives = &#123;<br>  copy,<br>  debounce,<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-title function_">install</span>(<span class="hljs-params">Vue</span>) &#123;<br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(directives).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> &#123;<br>      <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">directive</span>(key, directives[key])<br>    &#125;)<br>  &#125;,<br>&#125;<br><br><span class="hljs-comment">//在 main.js 引入并调用</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span><span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Directives</span> <span class="hljs-keyword">from</span><span class="hljs-string">&#x27;./JS/directives&#x27;</span><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">Directives</span>)<br></code></pre></td></tr></table></figure><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vue指令学习</title>
    <link href="/2021/08/04/2021/2021-08/08-04Vue%E6%8C%87%E4%BB%A4%E5%AD%A6%E4%B9%A0/"/>
    <url>/2021/08/04/2021/2021-08/08-04Vue%E6%8C%87%E4%BB%A4%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>在 vue 中提供了一些对于页面 + 数据的更为方便的输出,这些操作就叫做指令, 以 v-xxx 表示</p><h3 id="vue-中常用的-v-指令"><a href="#vue-中常用的-v-指令" class="headerlink" title="vue 中常用的 v-指令"></a>vue 中常用的 v-指令</h3><ul><li>  v-text 其实就是给元素的 innerText 赋值，只能用在双标签中 相当于插值表达试 <code>&#123;&#123;&#125;&#125;</code></li><li>  v-html 就是给元素的 innerHTML 赋值</li><li>  v-if 判断是否插入这个元素</li><li>  v-else-if 判断是否插入这个元素</li><li>  v-else 判断是否插入这个元素</li><li>v-show 隐藏元素 如果确定要隐藏, 会给元素的 style 加上 display:none<blockquote><p>v-if 家族都是对元素进行插入和移除的操作 v-show 是显示与否的问题。 v-if 家族使用必须是相同嵌套层相邻的 兄弟元素</p></blockquote></li><li>  v-model 双向数据绑定,针对的 js 内存对象,写在那个元素上，就对哪个元素操作</li><li>v-bind 可以给已经存在的属性赋值 input value 简写方式 v-bind:xx=”x” =&gt; :xx=”x”<blockquote><p>v-bind 和 v-model 的区别，在于，双向数据绑定 页面对于 input 的 value 改变，能影响内存中 name 变量，内存 js 改变 name 的值，会影响页面重新渲染最新值。bind,单向数据绑定 内存改变影响页面改变</p></blockquote></li><li>  v-on 处理自定义原生事件的,给按钮添加 click 并让使用变量的样式改变 简写： v-on:fn=”表达式||函数名” =&gt; @fn=”表达式||函数名”</li><li>v-for 循环遍历数据 v-for=”(item,index) in arr” v-for=”(value,key,index) in Obj”<blockquote><p>key 值， 都会说要拿一个唯一识别做渲染。由于 Vue 和 React 的虚拟 DOM diff 算法大致相同，我们需要使用 key 来给每个节点做一个唯一标识，Diff 算法就可以正确的识别此节点，找到正确的位置区插入新的节点，节约性能，更高效的更新 virtual DOM <a href="https://cn.vuejs.org/v2/api/#key">key 值运用</a></p></blockquote></li></ul><h3 id="不常用"><a href="#不常用" class="headerlink" title="不常用"></a>不常用</h3><ul><li>  v-pre 主要用来跳过这个元素和它的子元素编译过程</li><li>  v-cloak 这个指令是用来保持在元素上直到关联实例结束时进行编译。</li><li>  v-once 关联的实例，只会渲染一次。之后的重新渲染，实例极其所有的子节点将被视为静态内容跳过，这可以用于优化更新性能。</li></ul><h3 id="修饰符"><a href="#修饰符" class="headerlink" title="修饰符"></a>修饰符</h3><h4 id="v-on-事件修饰符"><a href="#v-on-事件修饰符" class="headerlink" title="v-on / @ 事件修饰符"></a>v-on / @ 事件修饰符</h4><ul><li>  .stop 阻止事件继续传播冒泡</li><li>  .prevent 事件不再重载</li><li>  .capture 使用事件捕获模式,即元素自身触发的事件先在此处处理，然后才交由内部元素进行处理</li><li>  .self 只当在 event.target 是当前元素自身时触发处理函数</li><li>  .once 事件将只会触发一次</li><li>  .passive 告诉浏览器你不想阻止事件的默认行为</li></ul><h4 id="v-model-修饰符"><a href="#v-model-修饰符" class="headerlink" title="v-model 修饰符"></a>v-model 修饰符</h4><ul><li>  .lazy 默认情况下，v-model 同步输入框的值和数据。可以通过这个修饰符，转变为在 change 事件再同步。</li><li>  .number 自动将用户的输入值转化为数值类型。 会转换成 NAN</li><li>  .trim 自动过滤用户输入的首尾空格，string 格式</li></ul><h4 id="自定义事件修饰符"><a href="#自定义事件修饰符" class="headerlink" title="自定义事件修饰符"></a>自定义事件修饰符</h4><ul><li>  .sync 只是作为一个编译时的语法糖存在。它会被扩展为一个自动更新父组件属性的 v-on 监听器。当一个子组件改变了一个 prop 的值时，这个变化也会同步到父组件中所绑定。如果我们不用.sync，我们想做上面的那个弹窗功能，我们也可以 props 传初始值，然后事件监听，实现起来也不算复杂。</li></ul><blockquote><p>修饰符可以串联使用，但要注意顺序。例如： 用 v-on:click.prevent.self 会阻止所有的点击，而 v-on:click.self.prevent 只会阻止对元素自身的点击。</p></blockquote><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>作用域</title>
    <link href="/2021/07/29/2021/2021-07/07-29%E4%BD%9C%E7%94%A8%E5%9F%9F%2013.22.29/"/>
    <url>/2021/07/29/2021/2021-07/07-29%E4%BD%9C%E7%94%A8%E5%9F%9F%2013.22.29/</url>
    
    <content type="html"><![CDATA[<h2 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h2><blockquote><p>作用域一般指某个函数，变量声明时能够访问的位置权限来决定的。作用域范围而就由此决定。<br>作用域的目的，提高了程序的可靠性，减少了命名的冲突</p></blockquote><h3 id="全局作用域-局部作用域"><a href="#全局作用域-局部作用域" class="headerlink" title="全局作用域/局部作用域"></a>全局作用域/局部作用域</h3><blockquote><p>全局作用域： 直接写在 js 标签的声明 就是在全局作用域里面，js 全局作用域中有一个全局对象 windeow,在这里创建声明的都会作为 window 对象的属性进行保存<br>局部作用域： 在词法作用域内部的就是局部作用域，只在当前的载体内起作用，每次调用创建局部作用域，执行完销毁，相互独立</p></blockquote><p>以下这种，在局部声明的方式，也是全局变量。这种隐式声明不推荐。 （严格模式下会报错）</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">nu</span>(<span class="hljs-params"></span>)&#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> a = <span class="hljs-number">10</span>;</span><br><span class="language-javascript">        v = <span class="hljs-number">20</span>;</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a);</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">    <span class="hljs-title function_">nu</span>();</span><br><span class="language-javascript">    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b);</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="变量提升"><a href="#变量提升" class="headerlink" title="变量提升"></a>变量提升</h2><blockquote><p>使用 var 与 function 声明的变量、函数 会在所有的代码前进行一次预编译效果，也就是变量提升</p></blockquote><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(a) <span class="hljs-comment">//undefined   预编译 ==&gt;  var a</span><br><span class="hljs-keyword">var</span> a = <span class="hljs-number">10</span>                               <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(a) <span class="hljs-comment">//undefined</span><br>                                         a= <span class="hljs-number">10</span><br><br>coun()                               <span class="hljs-keyword">function</span> <span class="hljs-title function_">coun</span> (<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">coun</span> (<span class="hljs-params"></span>)&#123;            预编译 ==&gt;       <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;hi&#x27;</span>)<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;hi&#x27;</span>)                    &#125;<br>&#125;      coun()<br><br></code></pre></td></tr></table></figure><p>但注意函数式方式不会具有变量提升</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">coun</span><span class="hljs-params">()</span></span>   <span class="hljs-comment">//这种方式报错</span><br><span class="hljs-selector-tag">var</span> coun = <span class="hljs-built_in">function</span>()&#123;<br>console<span class="hljs-selector-class">.log</span>(<span class="hljs-string">&#x27;hi&#x27;</span>)<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="局部作用域"><a href="#局部作用域" class="headerlink" title="局部作用域"></a>局部作用域</h3><h4 id="函数作用域"><a href="#函数作用域" class="headerlink" title="函数作用域"></a>函数作用域</h4><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span><span class="hljs-params">(a)</span> &#123;<br> <span class="hljs-keyword">var</span> b = <span class="hljs-number">2</span>;<br> <span class="hljs-comment">// 一些代码</span><br> <span class="hljs-keyword">function</span> <span class="hljs-title function_">bar</span><span class="hljs-params">()</span> &#123;<br> <span class="hljs-comment">// ...</span><br> &#125;<br><span class="hljs-number">22</span><br> <span class="hljs-comment">// 更多的代码</span><br> <span class="hljs-keyword">var</span> c = <span class="hljs-number">3</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>每个函数自身都会具有创建一个作用域，foo()可以在全局中获取到，而 foo 中的 a,b,c 只能在 foo 中获取</p><h4 id="块作用域"><a href="#块作用域" class="headerlink" title="块作用域"></a>块作用域</h4><p>首先 javaScript 本身并没有定义块级作用域说法，但是却时存在这一现象。例如：for 循环中的 变量定义声明、with、 try/catch、中的 catch 失败时的调用、 let const</p><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原生</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>图片随屏幕滚动而滑入滑出</title>
    <link href="/2021/07/26/2021/2021-07/07-26/"/>
    <url>/2021/07/26/2021/2021-07/07-26/</url>
    
    <content type="html"><![CDATA[<h3 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h3><p>浏览文本，当即将浏览到图片时，进行加载动画。</p><h4 id="主要"><a href="#主要" class="headerlink" title="主要"></a>主要</h4><blockquote><p>css 部分</p></blockquote><ul><li>  scale 控制图片缩放</li><li>  translateX 来控制左右移动</li></ul><blockquote><p>js 部分</p></blockquote><ul><li>  window.scrolly 纵向滚动距离</li><li>  window.innerHeight viewport 部分高度</li><li>  el.height 节点的高度</li><li>  el.offsetTop 当前元素节点至顶的距离 相对于浏览器窗口</li></ul><blockquote><p><code>debounce</code> 的作用： 降低事件监听的频率，使用了 Lodash 中的 debounce 方法。</p></blockquote><h3 id="在线地址"><a href="#在线地址" class="headerlink" title="在线地址"></a>在线地址</h3><p><img src="https://cl.ly/2k2e2H0b1U0J/Screen%20Recording%202017-07-18%20at%2010.04%20%E4%B8%8A%E5%8D%88.gif" alt="Scroll 效果演示">（图片太大，可点击<a href="https://cl.ly/2k2e2H0b1U0J">外链</a>查看，或查看<a href="http://soyaine.cn/JavaScript30/13%20-%20Slide%20in%20on%20Scroll/index-SOYAINE.html">在线效果</a>。）</p><h3 id="初始代码"><a href="#初始代码" class="headerlink" title="初始代码"></a>初始代码</h3><figure class="highlight tp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs tp">&lt;<span class="hljs-comment">!DOCTYPE html&gt;</span><br><span class="hljs-comment">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="hljs-comment">&lt;head&gt;</span><br><span class="hljs-comment">  &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="hljs-comment">  &lt;title&gt;Document&lt;/title&gt;</span><br><span class="hljs-comment">&lt;/head&gt;</span><br><span class="hljs-comment">&lt;body&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">  &lt;div class=&quot;site-wrap&quot;&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;h1&gt;滚动出现图片&lt;/h1&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;p&gt;Consectetur adipisicing elit. Tempore tempora rerum, est autem cupiditate, corporis a qui libero ipsum delectus quidem dolor at nulla, adipisci veniam in reiciendis aut asperiores omnis blanditiis quod quas laborum nam! Fuga ad tempora in aspernatur pariaturlores sunt esse magni, ut, dignissimos.&lt;/p&gt;</span><br><span class="hljs-comment">    &lt;p&gt;Lorem ipsum cupiditate, corporis a qui libero ipsum delectus quidem dolor at nulla, adipisci veniam in reiciendis aut asperiores omnis blanditiis quod quas laborum nam! Fuga ad tempora in aspernatur pariatur fugit quibusdam dolores sunt esse magni, ut, dignissimos.&lt;/p&gt;</span><br><span class="hljs-comment">    &lt;p&gt;Adipisicing elit. Tempore tempora rerum..&lt;/p&gt;</span><br><span class="hljs-comment">    &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit. Tempore tempora rerum, est autem cupiditate, corporis a qui libero ipsum delectus quidem dolor at nulla, adipisci veniam in reiciendis aut asperiores omnis blanditiis quod quas laborum nam! Fuga ad tempora in aspernatur pariatur fugit quibusdam dolores sunt esse magni, ut, dignissimos.&lt;/p&gt;</span><br><span class="hljs-comment">    &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit. Tempore tempora rerum, est autem cupiditate, corporis a qui libero ipsum delectus quidem dolor at nulla, adipisci veniam in reiciendis aut asperiores omnis blanditiis quod quas laborum nam! Fuga ad tempora in aspernatur pariatur fugit quibusdam dolores sunt esse magni, ut, dignissimos.&lt;/p&gt;</span><br><span class="hljs-comment">    &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit. Tempore tempora rerum, est autem cupiditate, corporis a qui libero ipsum delectus quidem dolor at nulla, adipisci veniam in reiciendis aut asperiores omnis blanditiis quod quas laborum nam! Fuga ad tempora in aspernatur pariatur fugit quibusdam dolores sunt esse magni, ut, dignissimos.&lt;/p&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;img src=&quot;http://unsplash.it/400/400&quot; class=&quot;align-left slide-in&quot;&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit. Voluptates, deserunt facilis et iste corrupti omnis tenetur est. Iste ut est dicta dolor itaque adipisci, dolorum minima, veritatis earum provident error molestias. Ratione magni illo sint vel velit ut excepturi consectetur suscipit, earum modi accusamus voluptatem nostrum, praesentium numquam, reiciendis voluptas sit id quisquam. Consequatur in quis reprehenderit modi perspiciatis necessitatibus saepe, quidem, suscipit iure natus dignissimos ipsam, eligendi deleniti accusantium, rerum quibusdam fugit perferendis et optio recusandae sed ratione. Culpa, dolorum reprehenderit harum ab voluptas fuga, nisi eligendi natus maiores illum quas quos et aperiam aut doloremque optio maxime fugiat doloribus. Eum dolorum expedita quam, nesciunt&lt;/p&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;img src=&quot;http://unsplash.it/400/401&quot; class=&quot;align-right slide-in&quot;&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;p&gt; at provident praesentium atque quas rerum optio dignissimos repudiandae ullam illum quibusdam. Vel ad error quibusdam, illo ex totam placeat. Quos excepturi fuga, molestiae ea quisquam minus, ratione dicta consectetur officia omnis, doloribus voluptatibus? Veniam ipsum veritatis architecto, provident quas consequatur doloremque quam quidem earum expedita, ad delectus voluptatum, omnis praesentium nostrum qui aspernatur ea eaque adipisci et cumque ab? Ea voluptatum dolore itaque odio. Eius minima distinctio harum, officia ab nihil exercitationem. Tempora rem nemo nam temporibus molestias facilis minus ipsam quam doloribus consequatur debitis nesciunt tempore officiis aperiam quisquam, molestiae voluptates cum, fuga culpa. Distinctio accusamus quibusdam, tempore perspiciatis dolorum optio facere consequatur quidem ullam beatae architecto, ipsam sequi officiis dignissimos amet impedit natus necessitatibus tenetur repellendus dolor rem! Dicta dolorem, iure, facilis illo ex nihil ipsa amet officia, optio temporibus eum autem odit repellendus nisi. Possimus modi, corrupti error debitis doloribus dicta libero earum, sequi porro ut excepturi nostrum ea voluptatem nihil culpa? Ullam expedita eligendi obcaecati reiciendis velit provident omnis quas qui in corrupti est dolore facere ad hic, animi soluta assumenda consequuntur reprehenderit! Voluptate dolor nihil veniam laborum voluptas nisi pariatur sed optio accusantium quam consectetur, corrupti, sequi et consequuntur, excepturi doloremque. Tempore quis velit corporis neque fugit non sequi eaque rem hic. Facere, inventore, aspernatur. Accusantium modi atque, asperiores qui nobis soluta cumque suscipit excepturi possimus doloremque odit saepe perferendis temporibus molestiae nostrum voluptatum quis id sint quidem nesciunt culpa. Rerum labore dolor beatae blanditiis praesentium explicabo velit optio esse aperiam similique, voluptatem cum, maiores ipsa tempore. Reiciendis sed culpa atque inventore, nam ullam enim expedita consectetur id velit iusto alias vitae explicabo nemo neque odio reprehenderit soluta sint eaque. Aperiam, qui ut tenetur, voluptate doloremque officiis dicta quaerat voluptatem rerum natus magni. Eum amet autem dolor ullam.&lt;/p&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;img src=&quot;http://unsplash.it/200/500&quot; class=&quot;align-left slide-in&quot;&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio maiores adipisci quibusdam repudiandae dolor vero placeat esse sit! Quibusdam saepe aperiam explicabo placeat optio, consequuntur nihil voluptatibus expedita quia vero perferendis, deserunt et incidunt eveniet &lt;img src=&quot;http://unsplash.it/200/200&quot; class=&quot;align-right slide-in&quot;&gt; temporibus doloremque possimus facilis. Possimus labore, officia dolore! Eaque ratione saepe, alias harum laboriosam deserunt laudantium blanditiis eum explicabo placeat reiciendis labore iste sint. Consectetur expedita dignissimos, non quos distinctio, eos rerum facilis eligendi. Asperiores laudantium, rerum ratione consequatur, culpa consectetur possimus atque ab tempore illum non dolor nesciunt. Neque, rerum. A vel non incidunt, quod doloremque dignissimos necessitatibus aliquid laboriosam architecto at cupiditate commodi expedita in, quae blanditiis. Deserunt labore sequi, repellat laboriosam est, doloremque culpa reiciendis tempore excepturi. Enim nostrum fugit itaque vel corporis ullam sed tenetur ipsa qui rem quam error sint, libero. Laboriosam rem, ratione. Autem blanditiis&lt;/p&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;p&gt;laborum neque repudiandae quam, cumque, voluptate veritatis itaque, placeat veniam ad nisi. Expedita, laborum reprehenderit ratione soluta velit natus, odit mollitia. Corporis rerum minima fugiat in nostrum. Assumenda natus cupiditate hic quidem ex, quas, amet ipsum esse dolore facilis beatae maxime qui inventore, iste? Maiores dignissimos dolore culpa debitis voluptatem harum, excepturi enim reiciendis, tempora ab ipsam illum aspernatur quasi qui porro saepe iure sunt eligendi tenetur quaerat ducimus quas sequi omnis aperiam suscipit! Molestiae obcaecati officiis quo, ratione eveniet, provident pariatur. Veniam quasi expedita distinctio, itaque molestiae sequi, dolorum nisi repellendus quia facilis iusto dignissimos nam? Tenetur fugit quos autem nihil, perspiciatis expedita enim tempore, alias ab maiores quis necessitatibus distinctio molestias eum, quidem. Delectus impedit quidem laborum, fugit vel neque quo, ipsam, quasi aspernatur quas odio nihil? Veniam amet reiciendis blanditiis quis reprehenderit repudiandae neque, ab ducimus, odit excepturi voluptate saepe ipsam. Voluptatem eum error voluptas porro officiis, amet! Molestias, fugit, ut! Tempore non magnam, amet, facere ducimus accusantium eos veritatis neque.&lt;/p&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;img src=&quot;http://unsplash.it/400/400&quot; class=&quot;align-right slide-in&quot;&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio maiores adipisci quibusdam repudiandae dolor vero placeat esse sit! Quibusdam saepe aperiam explicabo placeat optio, consequuntur nihil voluptatibus expedita quia vero perferendis, deserunt et incidunt eveniet temporibus doloremque possimus facilis. Possimus labore, officia dolore! Eaque ratione saepe, alias harum laboriosam deserunt laudantium blanditiis eum explicabo placeat reiciendis labore iste sint. Consectetur expedita dignissimos, non quos distinctio, eos rerum facilis eligendi. Asperiores laudantium, rerum ratione consequatur, culpa consectetur possimus atque ab tempore illum non dolor nesciunt. Neque, rerum. A vel non incidunt, quod doloremque dignissimos necessitatibus aliquid laboriosam architecto at cupiditate commodi expedita in, quae blanditiis. Deserunt labore sequi, repellat laboriosam est, doloremque culpa reiciendis tempore excepturi. Enim nostrum fugit itaque vel corporis ullam sed tenetur ipsa qui rem quam error sint, libero. Laboriosam rem, ratione. Autem blanditiis laborum neque repudiandae quam, cumque, voluptate veritatis itaque, placeat veniam ad nisi. Expedita, laborum reprehenderit ratione soluta velit natus, odit mollitia. Corporis rerum minima fugiat in nostrum. Assumenda natus cupiditate hic quidem ex, quas, amet ipsum esse dolore facilis beatae maxime qui inventore, iste? Maiores dignissimos dolore culpa debitis voluptatem harum, excepturi enim reiciendis, tempora ab ipsam illum aspernatur quasi qui porro saepe iure sunt eligendi tenetur quaerat ducimus quas sequi omnis aperiam suscipit! Molestiae obcaecati officiis quo, ratione eveniet, provident pariatur. Veniam quasi expedita distinctio, itaque molestiae sequi, dolorum nisi repellendus quia facilis iusto dignissimos nam? Tenetur fugit quos autem nihil, perspiciatis expedita enim tempore, alias ab maiores quis necessitatibus distinctio molestias eum, quidem. Delectus impedit quidem laborum, fugit vel neque quo, ipsam, quasi aspernatur quas odio nihil? Veniam amet reiciendis blanditiis quis reprehenderit repudiandae neque, ab ducimus, odit excepturi voluptate saepe ipsam. Voluptatem eum error voluptas porro officiis, amet! Molestias, fugit, ut! Tempore non magnam, amet, facere ducimus accusantium eos veritatis neque.&lt;/p&gt;</span><br><span class="hljs-comment">    &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio maiores adipisci quibusdam repudiandae dolor vero placeat esse sit! Quibusdam saepe aperiam explicabo placeat optio, consequuntur nihil voluptatibus expedita quia vero perferendis, deserunt et incidunt eveniet temporibus doloremque possimus facilis. Possimus labore, officia dolore! Eaque ratione saepe, alias harum laboriosam deserunt laudantium blanditiis eum explicabo placeat reiciendis labore iste sint. Consectetur expedita dignissimos, non quos distinctio, eos rerum facilis eligendi. Asperiores laudantium, rerum ratione consequatur, culpa consectetur possimus atque ab tempore illum non dolor nesciunt. Neque, rerum. A vel non incidunt, quod doloremque dignissimos necessitatibus aliquid laboriosam architecto at cupiditate commodi expedita in, quae blanditiis. Deserunt labore sequi, repellat laboriosam est, doloremque culpa reiciendis tempore excepturi. Enim nostrum fugit itaque vel corporis ullam sed tenetur ipsa qui rem quam error sint, libero. Laboriosam rem, ratione. Autem blanditiis laborum neque repudiandae quam, cumque, voluptate veritatis itaque, placeat veniam ad nisi. Expedita, laborum reprehenderit ratione soluta velit natus, odit mollitia. Corporis rerum minima fugiat in nostrum. Assumenda natus cupiditate hic quidem ex, quas, amet ipsum esse dolore facilis beatae maxime qui inventore, iste? Maiores dignissimos dolore culpa debitis voluptatem harum, excepturi enim reiciendis, tempora ab ipsam illum aspernatur quasi qui porro saepe iure sunt eligendi tenetur quaerat ducimus quas sequi omnis aperiam suscipit! Molestiae obcaecati officiis quo, ratione eveniet, provident pariatur. Veniam quasi expedita distinctio, itaque molestiae sequi, dolorum nisi repellendus quia facilis iusto dignissimos nam? Tenetur fugit quos autem nihil, perspiciatis expedita enim tempore, alias ab maiores quis necessitatibus distinctio molestias eum, quidem. Delectus impedit quidem laborum, fugit vel neque quo, ipsam, quasi aspernatur quas odio nihil? Veniam amet reiciendis blanditiis quis reprehenderit repudiandae neque, ab ducimus, odit excepturi voluptate saepe ipsam. Voluptatem eum error voluptas porro officiis, amet! Molestias, fugit, ut! Tempore non magnam, amet, facere ducimus accusantium eos veritatis neque.&lt;/p&gt;</span><br><span class="hljs-comment">  &lt;/div&gt;</span><br><span class="hljs-comment">  &lt;script&gt;</span><br><span class="hljs-comment">  &lt;/script&gt;</span><br><span class="hljs-comment">  &lt;style&gt;</span><br><span class="hljs-comment">    html &#123;</span><br><span class="hljs-comment">      box-sizing: border-box;</span><br>      background:#ffc<span class="hljs-number">600</span>;<br>      font-family:<span class="hljs-string">&#x27;helvetica neue&#x27;</span>;<br>      font-size: <span class="hljs-number">20</span>px;<br>      font-weight: <span class="hljs-number">200</span>;<br>    &#125;<br>    body &#123;<br>      margin: <span class="hljs-number">0</span>;<br>    &#125;<br>    *, *:before, *:after &#123;<br>      box-sizing: inherit;<br>    &#125;<br><br>    h<span class="hljs-number">1</span> &#123;<br>      margin-top: <span class="hljs-number">0</span>;<br>    &#125;<br><br>    .site-wrap &#123;<br>      max-width: <span class="hljs-number">700</span>px;<br>      margin: <span class="hljs-number">100</span>px auto;<br>      background:white;<br>      padding:<span class="hljs-number">40</span>px;<br>      text-align: justify;<br>    &#125;<br><br>    .align-left &#123;<br>      float:left;<br>      margin-right:<span class="hljs-number">20</span>px;<br>    &#125;<br><br>    .align-right &#123;<br>      float:right;<br>      margin-left:<span class="hljs-number">20</span>px;<br>    &#125;<br><br>    .slide-in &#123;<br>      opacity:<span class="hljs-number">0</span>;<br>      transition:all <span class="hljs-number">.5</span>s;<br>    &#125;<br><br>    .align-left.slide-in &#123;<br>      transform:translateX(<span class="hljs-number">-30</span>%) scale(<span class="hljs-number">0</span><span class="hljs-number">.95</span>);<br>    &#125;<br>    .align-right.slide-in &#123;<br>      transform:translateX(<span class="hljs-number">30</span>%) scale(<span class="hljs-number">0</span><span class="hljs-number">.95</span>);<br>    &#125;<br><br>    .slide-in.active &#123;<br>      opacity:<span class="hljs-number">1</span>;<br>      transform:translateX(<span class="hljs-number">0</span>%) scale(<span class="hljs-number">1</span>);<br>    &#125;<br><br>  &lt;/style&gt;<br><br>&lt;/body&gt;<br>&lt;/html&gt;<br><br></code></pre></td></tr></table></figure><h3 id="实例代码"><a href="#实例代码" class="headerlink" title="实例代码"></a>实例代码</h3><figure class="highlight tp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><code class="hljs tp">&lt;<span class="hljs-comment">!DOCTYPE html&gt;</span><br><span class="hljs-comment">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="hljs-comment">&lt;head&gt;</span><br><span class="hljs-comment">  &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="hljs-comment">  &lt;title&gt;Document&lt;/title&gt;</span><br><span class="hljs-comment">&lt;/head&gt;</span><br><span class="hljs-comment">&lt;body&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">  &lt;div class=&quot;site-wrap&quot;&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;h1&gt;Slide in on Scroll&lt;/h1&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;p&gt;滑动查看图片效果&lt;/p&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;p&gt;Consectetur adipisicing elit. Tempore tempora rerum, est autem cupiditate, corporis a qui libero ipsum delectus quidem dolor at nulla, adipisci veniam in reiciendis aut asperiores omnis blanditiis quod quas laborum nam! Fuga ad tempora in aspernatur pariaturlores sunt esse magni, ut, dignissimos.&lt;/p&gt;</span><br><span class="hljs-comment">    &lt;p&gt;Lorem ipsum cupiditate, corporis a qui libero ipsum delectus quidem dolor at nulla, adipisci veniam in reiciendis aut asperiores omnis blanditiis quod quas laborum nam! Fuga ad tempora in aspernatur pariatur fugit quibusdam dolores sunt esse magni, ut, dignissimos.&lt;/p&gt;</span><br><span class="hljs-comment">    &lt;p&gt;Adipisicing elit. Tempore tempora rerum..&lt;/p&gt;</span><br><span class="hljs-comment">    &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit. Tempore tempora rerum, est autem cupiditate, corporis a qui libero ipsum delectus quidem dolor at nulla, adipisci veniam in reiciendis aut asperiores omnis blanditiis quod quas laborum nam! Fuga ad tempora in aspernatur pariatur fugit quibusdam dolores sunt esse magni, ut, dignissimos.&lt;/p&gt;</span><br><span class="hljs-comment">    &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit. Tempore tempora rerum, est autem cupiditate, corporis a qui libero ipsum delectus quidem dolor at nulla, adipisci veniam in reiciendis aut asperiores omnis blanditiis quod quas laborum nam! Fuga ad tempora in aspernatur pariatur fugit quibusdam dolores sunt esse magni, ut, dignissimos.&lt;/p&gt;</span><br><span class="hljs-comment">    &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit. Tempore tempora rerum, est autem cupiditate, corporis a qui libero ipsum delectus quidem dolor at nulla, adipisci veniam in reiciendis aut asperiores omnis blanditiis quod quas laborum nam! Fuga ad tempora in aspernatur pariatur fugit quibusdam dolores sunt esse magni, ut, dignissimos.&lt;/p&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;img src=&quot;http://unsplash.it/400/402&quot; class=&quot;align-left slide-in&quot;&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit. Voluptates, deserunt facilis et iste corrupti omnis tenetur est. Iste ut est dicta dolor itaque adipisci, dolorum minima, veritatis earum provident error molestias. Ratione magni illo sint vel velit ut excepturi consectetur suscipit, earum modi accusamus voluptatem nostrum, praesentium numquam, reiciendis voluptas sit id quisquam. Consequatur in quis reprehenderit modi perspiciatis necessitatibus saepe, quidem, suscipit iure natus dignissimos ipsam, eligendi deleniti accusantium, rerum quibusdam fugit perferendis et optio recusandae sed ratione. Culpa, dolorum reprehenderit harum ab voluptas fuga, nisi eligendi natus maiores illum quas quos et aperiam aut doloremque optio maxime fugiat doloribus. Eum dolorum expedita quam, nesciunt&lt;/p&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;img src=&quot;http://unsplash.it/400/401&quot; class=&quot;align-right slide-in&quot;&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;p&gt; at provident praesentium atque quas rerum optio dignissimos repudiandae ullam illum quibusdam. Vel ad error quibusdam, illo ex totam placeat. Quos excepturi fuga, molestiae ea quisquam minus, ratione dicta consectetur officia omnis, doloribus voluptatibus? Veniam ipsum veritatis architecto, provident quas consequatur doloremque quam quidem earum expedita, ad delectus voluptatum, omnis praesentium nostrum qui aspernatur ea eaque adipisci et cumque ab? Ea voluptatum dolore itaque odio. Eius minima distinctio harum, officia ab nihil exercitationem. Tempora rem nemo nam temporibus molestias facilis minus ipsam quam doloribus consequatur debitis nesciunt tempore officiis aperiam quisquam, molestiae voluptates cum, fuga culpa. Distinctio accusamus quibusdam, tempore perspiciatis dolorum optio facere consequatur quidem ullam beatae architecto, ipsam sequi officiis dignissimos amet impedit natus necessitatibus tenetur repellendus dolor rem! Dicta dolorem, iure, facilis illo ex nihil ipsa amet officia, optio temporibus eum autem odit repellendus nisi. Possimus modi, corrupti error debitis doloribus dicta libero earum, sequi porro ut excepturi nostrum ea voluptatem nihil culpa? Ullam expedita eligendi obcaecati reiciendis velit provident omnis quas qui in corrupti est dolore facere ad hic, animi soluta assumenda consequuntur reprehenderit! Voluptate dolor nihil veniam laborum voluptas nisi pariatur sed optio accusantium quam consectetur, corrupti, sequi et consequuntur, excepturi doloremque. Tempore quis velit corporis neque fugit non sequi eaque rem hic. Facere, inventore, aspernatur. Accusantium modi atque, asperiores qui nobis soluta cumque suscipit excepturi possimus doloremque odit saepe perferendis temporibus molestiae nostrum voluptatum quis id sint quidem nesciunt culpa. Rerum labore dolor beatae blanditiis praesentium explicabo velit optio esse aperiam similique, voluptatem cum, maiores ipsa tempore. Reiciendis sed culpa atque inventore, nam ullam enim expedita consectetur id velit iusto alias vitae explicabo nemo neque odio reprehenderit soluta sint eaque. Aperiam, qui ut tenetur, voluptate doloremque officiis dicta quaerat voluptatem rerum natus magni. Eum amet autem dolor ullam.&lt;/p&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;img src=&quot;http://unsplash.it/200/500&quot; class=&quot;align-left slide-in&quot;&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio maiores adipisci quibusdam repudiandae dolor vero placeat esse sit! Quibusdam saepe aperiam explicabo placeat optio, consequuntur nihil voluptatibus expedita quia vero perferendis, deserunt et incidunt eveniet &lt;img src=&quot;http://unsplash.it/200/200&quot; class=&quot;align-right slide-in&quot;&gt; temporibus doloremque possimus facilis. Possimus labore, officia dolore! Eaque ratione saepe, alias harum laboriosam deserunt laudantium blanditiis eum explicabo placeat reiciendis labore iste sint. Consectetur expedita dignissimos, non quos distinctio, eos rerum facilis eligendi. Asperiores laudantium, rerum ratione consequatur, culpa consectetur possimus atque ab tempore illum non dolor nesciunt. Neque, rerum. A vel non incidunt, quod doloremque dignissimos necessitatibus aliquid laboriosam architecto at cupiditate commodi expedita in, quae blanditiis. Deserunt labore sequi, repellat laboriosam est, doloremque culpa reiciendis tempore excepturi. Enim nostrum fugit itaque vel corporis ullam sed tenetur ipsa qui rem quam error sint, libero. Laboriosam rem, ratione. Autem blanditiis&lt;/p&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;p&gt;laborum neque repudiandae quam, cumque, voluptate veritatis itaque, placeat veniam ad nisi. Expedita, laborum reprehenderit ratione soluta velit natus, odit mollitia. Corporis rerum minima fugiat in nostrum. Assumenda natus cupiditate hic quidem ex, quas, amet ipsum esse dolore facilis beatae maxime qui inventore, iste? Maiores dignissimos dolore culpa debitis voluptatem harum, excepturi enim reiciendis, tempora ab ipsam illum aspernatur quasi qui porro saepe iure sunt eligendi tenetur quaerat ducimus quas sequi omnis aperiam suscipit! Molestiae obcaecati officiis quo, ratione eveniet, provident pariatur. Veniam quasi expedita distinctio, itaque molestiae sequi, dolorum nisi repellendus quia facilis iusto dignissimos nam? Tenetur fugit quos autem nihil, perspiciatis expedita enim tempore, alias ab maiores quis necessitatibus distinctio molestias eum, quidem. Delectus impedit quidem laborum, fugit vel neque quo, ipsam, quasi aspernatur quas odio nihil? Veniam amet reiciendis blanditiis quis reprehenderit repudiandae neque, ab ducimus, odit excepturi voluptate saepe ipsam. Voluptatem eum error voluptas porro officiis, amet! Molestias, fugit, ut! Tempore non magnam, amet, facere ducimus accusantium eos veritatis neque.&lt;/p&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;img src=&quot;http://unsplash.it/400/400&quot; class=&quot;align-right slide-in&quot;&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio maiores adipisci quibusdam repudiandae dolor vero placeat esse sit! Quibusdam saepe aperiam explicabo placeat optio, consequuntur nihil voluptatibus expedita quia vero perferendis, deserunt et incidunt eveniet temporibus doloremque possimus facilis. Possimus labore, officia dolore! Eaque ratione saepe, alias harum laboriosam deserunt laudantium blanditiis eum explicabo placeat reiciendis labore iste sint. Consectetur expedita dignissimos, non quos distinctio, eos rerum facilis eligendi. Asperiores laudantium, rerum ratione consequatur, culpa consectetur possimus atque ab tempore illum non dolor nesciunt. Neque, rerum. A vel non incidunt, quod doloremque dignissimos necessitatibus aliquid laboriosam architecto at cupiditate commodi expedita in, quae blanditiis. Deserunt labore sequi, repellat laboriosam est, doloremque culpa reiciendis tempore excepturi. Enim nostrum fugit itaque vel corporis ullam sed tenetur ipsa qui rem quam error sint, libero. Laboriosam rem, ratione. Autem blanditiis laborum neque repudiandae quam, cumque, voluptate veritatis itaque, placeat veniam ad nisi. Expedita, laborum reprehenderit ratione soluta velit natus, odit mollitia. Corporis rerum minima fugiat in nostrum. Assumenda natus cupiditate hic quidem ex, quas, amet ipsum esse dolore facilis beatae maxime qui inventore, iste? Maiores dignissimos dolore culpa debitis voluptatem harum, excepturi enim reiciendis, tempora ab ipsam illum aspernatur quasi qui porro saepe iure sunt eligendi tenetur quaerat ducimus quas sequi omnis aperiam suscipit! Molestiae obcaecati officiis quo, ratione eveniet, provident pariatur. Veniam quasi expedita distinctio, itaque molestiae sequi, dolorum nisi repellendus quia facilis iusto dignissimos nam? Tenetur fugit quos autem nihil, perspiciatis expedita enim tempore, alias ab maiores quis necessitatibus distinctio molestias eum, quidem. Delectus impedit quidem laborum, fugit vel neque quo, ipsam, quasi aspernatur quas odio nihil? Veniam amet reiciendis blanditiis quis reprehenderit repudiandae neque, ab ducimus, odit excepturi voluptate saepe ipsam. Voluptatem eum error voluptas porro officiis, amet! Molestias, fugit, ut! Tempore non magnam, amet, facere ducimus accusantium eos veritatis neque.&lt;/p&gt;</span><br><span class="hljs-comment">    &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio maiores adipisci quibusdam repudiandae dolor vero placeat esse sit! Quibusdam saepe aperiam explicabo placeat optio, consequuntur nihil voluptatibus expedita quia vero perferendis, deserunt et incidunt eveniet temporibus doloremque possimus facilis. Possimus labore, officia dolore! Eaque ratione saepe, alias harum laboriosam deserunt laudantium blanditiis eum explicabo placeat reiciendis labore iste sint. Consectetur expedita dignissimos, non quos distinctio, eos rerum facilis eligendi. Asperiores laudantium, rerum ratione consequatur, culpa consectetur possimus atque ab tempore illum non dolor nesciunt. Neque, rerum. A vel non incidunt, quod doloremque dignissimos necessitatibus aliquid laboriosam architecto at cupiditate commodi expedita in, quae blanditiis. Deserunt labore sequi, repellat laboriosam est, doloremque culpa reiciendis tempore excepturi. Enim nostrum fugit itaque vel corporis ullam sed tenetur ipsa qui rem quam error sint, libero. Laboriosam rem, ratione. Autem blanditiis laborum neque repudiandae quam, cumque, voluptate veritatis itaque, placeat veniam ad nisi. Expedita, laborum reprehenderit ratione soluta velit natus, odit mollitia. Corporis rerum minima fugiat in nostrum. Assumenda natus cupiditate hic quidem ex, quas, amet ipsum esse dolore facilis beatae maxime qui inventore, iste? Maiores dignissimos dolore culpa debitis voluptatem harum, excepturi enim reiciendis, tempora ab ipsam illum aspernatur quasi qui porro saepe iure sunt eligendi tenetur quaerat ducimus quas sequi omnis aperiam suscipit! Molestiae obcaecati officiis quo, ratione eveniet, provident pariatur. Veniam quasi expedita distinctio, itaque molestiae sequi, dolorum nisi repellendus quia facilis iusto dignissimos nam? Tenetur fugit quos autem nihil, perspiciatis expedita enim tempore, alias ab maiores quis necessitatibus distinctio molestias eum, quidem. Delectus impedit quidem laborum, fugit vel neque quo, ipsam, quasi aspernatur quas odio nihil? Veniam amet reiciendis blanditiis quis reprehenderit repudiandae neque, ab ducimus, odit excepturi voluptate saepe ipsam. Voluptatem eum error voluptas porro officiis, amet! Molestias, fugit, ut! Tempore non magnam, amet, facere ducimus accusantium eos veritatis neque.&lt;/p&gt;</span><br><span class="hljs-comment">  &lt;/div&gt;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">  &lt;script&gt;</span><br><span class="hljs-comment">    // 减少功能消耗</span><br><span class="hljs-comment">    function debounce(func, wait = 20, immediate = true) &#123;</span><br><span class="hljs-comment">      var timeout;</span><br>      return function() &#123;<br>        var context = this, args = arguments;<br>        var later = function() &#123;<br>          timeout = null;<br>          if (<span class="hljs-comment">!immediate) func.apply(context, args);</span><br>        &#125;;<br>        var callNow = immediate &amp;&amp; <span class="hljs-comment">!timeout;</span><br>        clearTimeout(timeout);<br>        timeout = setTimeout(later, wait);<br>        if (callNow) func.apply(context, args);<br>      &#125;;<br>    &#125;<br>    <span class="hljs-comment">// 获取图片节点</span><br><span class="hljs-comment">    const slideImages = document.querySelectorAll(&#x27;.slide-in&#x27;);</span><br>    <span class="hljs-comment">// 定义处理事件</span><br><span class="hljs-comment">    function checkSlide(e) &#123;</span><br><span class="hljs-comment">        slideImages.forEach(img =&gt; &#123;</span><br><span class="hljs-comment">            const slideInAt = (window.scrollY + window.innerHeight) - img.height / 2;</span><br>            <span class="hljs-comment">// 图片底部</span><br><span class="hljs-comment">            const imgBottom = img.offsetTop + img.height;</span><br>            <span class="hljs-comment">// 已滑过了图片的一半</span><br><span class="hljs-comment">            const isHalfShow = slideInAt &gt; img.offsetTop;</span><br>            <span class="hljs-comment">// 未完全滑过图片</span><br><span class="hljs-comment">            const isNotScrollPast = window.scrollY &lt; imgBottom;</span><br>            if (isHalfShow &amp;&amp; isNotScrollPast) &#123;<br>                img.classList.add(<span class="hljs-string">&#x27;active&#x27;</span>);<br>            &#125; else &#123;<br>                img.classList.remove(<span class="hljs-string">&#x27;active&#x27;</span>);<br>            &#125;<br>     &#125;);<br>    &#125;<br>    注册scroll事件 进行监听<br>    window.addEventListener(<span class="hljs-string">&#x27;scroll&#x27;</span>, debounce(checkSlide));<br><br>  &lt;/script&gt;<br><br>  &lt;style&gt;<br>    html &#123;<br>      box-sizing: border-box;<br>      background:#ffc<span class="hljs-number">600</span>;<br>      font-family:<span class="hljs-string">&#x27;helvetica neue&#x27;</span>;<br>      font-size: <span class="hljs-number">20</span>px;<br>      font-weight: <span class="hljs-number">200</span>;<br>    &#125;<br>    body &#123;<br>      margin: <span class="hljs-number">0</span>;<br>    &#125;<br>    *, *:before, *:after &#123;<br>      box-sizing: inherit;<br>    &#125;<br><br>    h<span class="hljs-number">1</span> &#123;<br>      margin-top: <span class="hljs-number">0</span>;<br>    &#125;<br><br>    .site-wrap &#123;<br>      max-width: <span class="hljs-number">700</span>px;<br>      margin: <span class="hljs-number">100</span>px auto;<br>      background:white;<br>      padding:<span class="hljs-number">40</span>px;<br>      text-align: justify;<br>    &#125;<br><br>    .align-left &#123;<br>      float:left;<br>      margin-right:<span class="hljs-number">20</span>px;<br>    &#125;<br><br>    .align-right &#123;<br>      float:right;<br>      margin-left:<span class="hljs-number">20</span>px;<br>    &#125;<br><br>    .slide-in &#123;<br>      opacity:<span class="hljs-number">0</span>;<br>      transition:all <span class="hljs-number">.5</span>s;<br>    &#125;<br><br>    .align-left.slide-in &#123;<br>      transform:translateX(<span class="hljs-number">-30</span>%) scale(<span class="hljs-number">0</span><span class="hljs-number">.95</span>);<br>    &#125;<br>    .align-right.slide-in &#123;<br>      transform:translateX(<span class="hljs-number">30</span>%) scale(<span class="hljs-number">0</span><span class="hljs-number">.95</span>);<br>    &#125;<br><br>    .slide-in.active &#123;<br>      opacity:<span class="hljs-number">1</span>;<br>      transform:translateX(<span class="hljs-number">0</span>%) scale(<span class="hljs-number">1</span>);<br>    &#125;<br><br>  &lt;/style&gt;<br><br>&lt;/body&gt;<br>&lt;/html&gt;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原生</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>表单校验方式</title>
    <link href="/2021/07/15/2021/2021-07/07-15element%E6%A0%A1%E9%AA%8C/"/>
    <url>/2021/07/15/2021/2021-07/07-15element%E6%A0%A1%E9%AA%8C/</url>
    
    <content type="html"><![CDATA[<h2 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h2><blockquote><p>日常总结常规的表单校验方式总结，针对于 element ui 组件库</p></blockquote><h2 id="主要"><a href="#主要" class="headerlink" title="主要"></a>主要</h2><blockquote><p>form 表单内 form-item prop 校验</p></blockquote><ul><li>  required 必填</li><li>  trigger 触发条件</li><li>  message 警示语</li><li>  type 校验类型</li><li>  pattern 正则校验</li><li>  validator 自定义 校验规则</li></ul><h3 id="实例代码"><a href="#实例代码" class="headerlink" title="实例代码"></a>实例代码</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">validateDate</span> = (<span class="hljs-params">rule, value, callback</span>) =&gt; &#123;<br>      <span class="hljs-keyword">if</span> (value) &#123;<br>        <span class="hljs-keyword">let</span> selectTime = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(value).<span class="hljs-title function_">valueOf</span>();<br>        <span class="hljs-keyword">let</span> activeTime = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">valueOf</span>();<br>        <span class="hljs-keyword">if</span> (activeTime &gt; selectTime) &#123;<br>          <span class="hljs-title function_">callback</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`生效时间不能低于或等于当前时间`</span>));<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-title function_">callback</span>();<br>        &#125;<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-title function_">callback</span>();<br>      &#125;<br><br><span class="hljs-attr">productTitle</span>: [<br>          &#123; <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;请输入商品名称&quot;</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">&quot;blur&quot;</span> &#125;,<br>         &#123; <span class="hljs-attr">validator</span>: validateDate, <span class="hljs-attr">trigger</span>: [<span class="hljs-string">&quot;blur&quot;</span>, <span class="hljs-string">&quot;change&quot;</span>] &#125;,<br>         &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;number&quot;</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;类型应为数字值&quot;</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">&quot;blur&quot;</span> &#125;,<br>         &#123;<span class="hljs-attr">pattern</span>: <span class="hljs-regexp">/^\+?[1-9][0-9]*$/</span>,<span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;推荐顺序应为正整数&#x27;</span>,<span class="hljs-attr">trigger</span>: <span class="hljs-string">&#x27;blur&#x27;</span>,&#125;,<br>        ],<br></code></pre></td></tr></table></figure><h3 id="有依赖数据校验判断"><a href="#有依赖数据校验判断" class="headerlink" title="有依赖数据校验判断"></a>有依赖数据校验判断</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-attr">computed</span>: &#123;<br>        <span class="hljs-comment">// 表单校验规则 在计算属性中可将值进行判断</span><br>        <span class="hljs-title function_">rules</span>(<span class="hljs-params"></span>)&#123;<br>            <span class="hljs-keyword">return</span> &#123;<br>                <span class="hljs-attr">product</span>:[&#123; <span class="hljs-attr">required</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">form</span>.<span class="hljs-property">big</span> ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;请输入商品名称&quot;</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">&quot;blur&quot;</span> &#125;]<br>            &#125;;<br>        &#125;<br>    &#125;,<br></code></pre></td></tr></table></figure><h3 id="自定义正则方式修改输入内容"><a href="#自定义正则方式修改输入内容" class="headerlink" title="自定义正则方式修改输入内容"></a>自定义正则方式修改输入内容</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs javascript"> &lt;el-form-item v-<span class="hljs-keyword">if</span>=<span class="hljs-string">&quot;showPrice&quot;</span> prop=<span class="hljs-string">&quot;itemPrice&quot;</span> label=<span class="hljs-string">&quot;面值&quot;</span>&gt;<br>            <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">el-input</span></span></span><br><span class="hljs-tag"><span class="language-xml">              <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;addForm.itemPrice&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">              @<span class="hljs-attr">keyup.native</span>=<span class="hljs-string">&quot;InputNumber(&#x27;itemPrice&#x27;)&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">              <span class="hljs-attr">maxlength</span>=<span class="hljs-string">&quot;6&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">              <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;blur&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-input</span>&gt;</span></span><br>&lt;/el-form-item&gt;<br><br>  <span class="hljs-comment">// 验证只能输入数字</span><br>   limitInputNumber (val) &#123;<br>     <span class="hljs-keyword">if</span> (val) &#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-title class_">String</span>(val).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\D/g</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>     &#125;<br>     <span class="hljs-keyword">return</span> val<br>   &#125;,<br>    <span class="hljs-comment">// 限制只能输入数字(可以输入两位小数)</span><br>    <span class="hljs-title function_">limitInputPointNumber</span>(<span class="hljs-params">val, parent, property</span>) &#123;<br>      <span class="hljs-keyword">let</span> tmap = <span class="hljs-string">&#x27;&#x27;</span><br>      <span class="hljs-keyword">if</span> (val === <span class="hljs-number">0</span> || val === <span class="hljs-string">&#x27;0&#x27;</span> || val === <span class="hljs-string">&#x27;&#x27;</span>) &#123;<br>        tmap = <span class="hljs-string">&#x27;&#x27;</span><br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">let</span> value = <span class="hljs-literal">null</span><br>        value = <span class="hljs-title class_">String</span>(val).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[^\d.]/g</span>, <span class="hljs-string">&#x27;&#x27;</span>) <span class="hljs-comment">// 清除“数字”和“.”以外的字符</span><br>        value = value.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^\./g</span>, <span class="hljs-string">&#x27;0.&#x27;</span>) <span class="hljs-comment">// 第一个. 添加0.</span><br>        value = value.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\.&#123;2,&#125;/g</span>, <span class="hljs-string">&#x27;.&#x27;</span>) <span class="hljs-comment">// 只保留第一个. 清除多余的</span><br>        value = value<br>          .<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-string">&#x27;$#$&#x27;</span>)<br>          .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\./g</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>          .<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;$#$&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>)<br>        value = value.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^(-)*(\d+)\.(\d\d).*$/</span>, <span class="hljs-string">&#x27;$1$2.$3&#x27;</span>) <span class="hljs-comment">// 只能输入两个小数</span><br>        tmap = <span class="hljs-title class_">Number</span>(value)<br>      &#125;<br>      <span class="hljs-variable language_">this</span>[parent][property] = tmap<br>    &#125;,<br>    <span class="hljs-title class_">InputNumber</span>(property) &#123;<br>     <span class="hljs-variable language_">this</span>.<span class="hljs-property">addForm</span>[property] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">limitInputNumber</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">addForm</span>[property])<br>   &#125;,<br></code></pre></td></tr></table></figure><h3 id="嵌套验证-联动验证"><a href="#嵌套验证-联动验证" class="headerlink" title="嵌套验证(联动验证)"></a>嵌套验证(联动验证)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;!-- region是一个对象,国家和城市是它的属性 --&gt;<br>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">el-form-item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;活动区域&quot;</span> <span class="hljs-attr">prop</span>=<span class="hljs-string">&quot;region&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">el-select</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;registData.region.country&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;请选择国家&quot;</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">el-option</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;国家一&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;USA&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-option</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">el-option</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;国家二&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;China&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-option</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">el-select</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">el-select</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;registData.region.city&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;请选择城市&quot;</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">el-option</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;城市一&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;shanghai&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-option</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">el-option</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;城市二&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;beijing&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-option</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">el-select</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">el-form-item</span>&gt;</span></span><br><br>  <span class="hljs-attr">region</span>: [<br>    &#123;<br>      <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;object&#x27;</span>,<br>      <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,<br>      <span class="hljs-comment">// 这里有两种处理,一种是自定义验证,拿到值后自己对属性进行验证,比较麻烦</span><br>      <span class="hljs-comment">// validator: (rule, value, callback) =&gt; &#123;</span><br>      <span class="hljs-comment">//   console.log(55, value)</span><br>      <span class="hljs-comment">//   if (!value.country) &#123;</span><br>      <span class="hljs-comment">//     callback(new Error(&#x27;请选择国家&#x27;))</span><br>      <span class="hljs-comment">//   &#125; else if (!value.city) &#123;</span><br>      <span class="hljs-comment">//     callback(new Error(&#x27;请选择城市&#x27;))</span><br>      <span class="hljs-comment">//   &#125; else &#123;</span><br>      <span class="hljs-comment">//     callback()</span><br>      <span class="hljs-comment">//   &#125;</span><br>      <span class="hljs-comment">// &#125;,</span><br>      <span class="hljs-attr">trigger</span>: <span class="hljs-string">&#x27;change&#x27;</span>,<br>      <span class="hljs-comment">// 官网提供了对象的嵌套验证,只需要把需要验证的属性,放在fields对象里,就会按顺序进行验证</span><br>      <span class="hljs-attr">fields</span>: &#123;<br>        <span class="hljs-attr">country</span>: &#123;<span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;请选择国家&#x27;</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">&#x27;blur&#x27;</span>&#125;,<br>        <span class="hljs-attr">city</span>: &#123;<span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;请选择城市&#x27;</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">&#x27;blur&#x27;</span>&#125;<br>      &#125;<br>    &#125;<br>  ],<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Element UI</category>
      
    </categories>
    
    
    <tags>
      
      <tag>校验方式</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>混入mixins</title>
    <link href="/2021/07/13/2021/2021-07/07-13Vue-mixins/"/>
    <url>/2021/07/13/2021/2021-07/07-13Vue-mixins/</url>
    
    <content type="html"><![CDATA[<h3 id="混入（mixins）"><a href="#混入（mixins）" class="headerlink" title="混入（mixins）"></a><a href="https://cn.vuejs.org/v2/guide/mixins.html">混入（mixins）</a></h3><ul><li>  官网指出： 混入 (mixin) 提供了一种非常灵活的方式，来分发 Vue 组件中的可复用功能。一个混入对象可以包含任意组件选项。当组件使用混入对象时，所有混入对象的选项将被“混合”进入该组件本身的选项。</li><li>  当组件和混入对象含有同名选项时，这些选项将以恰当的方式进行“合并”。</li><li>  同名钩子函数将合并为一个数组，因此都将被调用。另外，混入对象的钩子将在组件自身钩子之前调用。</li></ul><h2 id="主要"><a href="#主要" class="headerlink" title="主要"></a>主要</h2><blockquote><p>定义看不懂</p></blockquote><h4 id="定义混入组件"><a href="#定义混入组件" class="headerlink" title="定义混入组件"></a>定义混入组件</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> &#123;<br>            num : <span class="hljs-number">0</span><br>        &#125;<br>    &#125;,<br>    <span class="hljs-attr">methods</span>: &#123;<br>        <span class="hljs-title function_">handleclick</span>(<span class="hljs-params"></span>)&#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">num</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">num</span> ++<br>        &#125;<br>    &#125;<br>&#125;<br><br><br></code></pre></td></tr></table></figure><h4 id="混入引用到组件（局部）"><a href="#混入引用到组件（局部）" class="headerlink" title="混入引用到组件（局部）"></a>混入引用到组件（局部）</h4><p>总的说是混入到这里面就是和所有的重合到一起，这样可以获取到混入组件的相关内容了</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">   <span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">num</span>&#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleclick&quot;</span>&gt;</span>点击每次加1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> minin <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./minxin/minxin&#x27;</span></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-attr">mixins</span>: [minin],</span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>)&#123;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;</span></span><br><span class="language-javascript"><span class="language-xml">  &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-attr">methods</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">  &#125;</span></span><br><span class="language-javascript"><span class="language-xml">&#125;</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h2 id="全局混入"><a href="#全局混入" class="headerlink" title="全局混入"></a>全局混入</h2><blockquote><p>定义全局混入,main.js 中引入。在需要的使用的页面直接使用，不需要再引入（使用方法同局部混入）</p></blockquote><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">Vue.<span class="hljs-keyword">mixin</span>(&#123;<br>    data () &#123;<br>        rerutn &#123;<br><br>        &#125;<br>    &#125;,<br>    create () &#123;&#125;,<br>    methods: &#123;<br>        clgFn()&#123;<br>            console.log(<span class="hljs-string">&#x27;混入的mixin方法&#x27;</span>)<br>        &#125;,<br>    &#125;,<br>&#125;)<br><br></code></pre></td></tr></table></figure><p><img src="/img/1.jpg" alt="BG图片"></p>]]></content>
    
    
    <categories>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WebSocket 基于实现</title>
    <link href="/2021/07/10/2021/2021-07/07-10websocket/"/>
    <url>/2021/07/10/2021/2021-07/07-10websocket/</url>
    
    <content type="html"><![CDATA[<h2 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h2><blockquote><p><a href="https://websocket.org/">webSocket</a>是一种在单个 TCP 连接上进行全双工通信的协议,可以使得客户端和服务器之间的数据交换变得更加简单，允许服务端主动向客户端推送数据。是基于 HTML5 的新协议，一个持久化的协议，相对于 HTTP 这种非持久的协议来说。</p></blockquote><h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3><p>应用提供多个用户相互交流，应用是展示服务器端经常变动的数据。涉及，社交订阅、流动数据、股票基金报价、天气更新、多媒体聊天、位置、视频…..</p><blockquote><p>主要用于客户端部分（HTML5 是一个很宽广的概念，是对大量新 API 的总称）</p></blockquote><h3 id="特点包括"><a href="#特点包括" class="headerlink" title="特点包括"></a>特点包括</h3><ul><li>  建立在 TCP 协议之上，服务器端的实现比较容易。</li><li>  与 HTTP 协议有着良好的兼容性。默认端口也是 80 和 443，并且握手阶段采用 HTTP 协议，因此握手时不容易屏蔽，能通过各种 HTTP 代理服务器。</li><li>  数据格式比较轻量，性能开销小，通信高效。</li><li>  可以发送文本，也可以发送二进制数据。</li><li>  没有同源限制，客户端可以与任意服务器通信。</li><li>  协议标识符是 ws（如果加密，则为 wss），服务器网址就是 URL。</li></ul><h2 id="主要"><a href="#主要" class="headerlink" title="主要"></a>主要</h2><p>详细参考于阮老师日志，便于细节了解 <a href="https://www.ruanyifeng.com/blog/2017/05/websocket.html">阮一峰的网络日志-websocket 教程</a></p><h3 id="实例代码"><a href="#实例代码" class="headerlink" title="实例代码"></a>实例代码</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">let that = <span class="hljs-literal">null</span>;<br>export default <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketClient</span> &#123;<br><br>    <span class="hljs-keyword">constructor</span>() &#123;<br>        <span class="hljs-keyword">this</span>.ws = <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">this</span>.url = <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">this</span>.from = <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">this</span>.to = <span class="hljs-literal">null</span>;<br>        that = <span class="hljs-keyword">this</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 获取WebSocket单例</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@returns</span> &#123;WebSocketClient&#125;</span><br><span class="hljs-comment">     */</span><br>    static getInstance() &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.instance) &#123;<br>            <span class="hljs-keyword">this</span>.instance = new WebSocketClient();<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.instance;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 初始化WebSocket</span><br><span class="hljs-comment">     */</span><br>    initWebSocket(url) &#123;<br>        <span class="hljs-keyword">if</span>(!url) <span class="hljs-keyword">return</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//timer为发送心跳的计时器</span><br>            <span class="hljs-keyword">this</span>.timer &amp;&amp; clearInterval(<span class="hljs-keyword">this</span>.timer);<br>            <span class="hljs-keyword">this</span>.ws = new WebSocket(url);<br>            <span class="hljs-keyword">this</span>.initWsEvent();<br><br>        &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>            console.log(<span class="hljs-string">&#x27;WebSocket err:&#x27;</span>, e);<br>            <span class="hljs-comment">//重连</span><br>            <span class="hljs-keyword">this</span>.reconnect();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * 初始化WebSocket相关事件</span><br><span class="hljs-comment">     */</span><br>    initWsEvent() &#123;<br>        <span class="hljs-comment">//建立WebSocket连接</span><br>        <span class="hljs-keyword">this</span>.ws.onopen = function () &#123;<br><br>            console.log(<span class="hljs-string">&#x27;WebSocket:&#x27;</span>, <span class="hljs-string">&#x27;连接成功了&#x27;</span>);<br>            <span class="hljs-comment">// 加载历史消息</span><br>            <span class="hljs-comment">// that.getMessageHistory(from,to);</span><br>        &#125;;<br><br>       <span class="hljs-comment">// 客户端接收服务端数据时触发</span><br>        <span class="hljs-keyword">this</span>.ws.onmessage = function (evt) &#123;<br>            <span class="hljs-comment">// console.log(&quot;websocket:&quot;,evt);</span><br>            <span class="hljs-keyword">if</span> (evt.<span class="hljs-keyword">data</span> !== <span class="hljs-string">&#x27;pong&#x27;</span>) &#123;<br>                <span class="hljs-comment">//不是心跳消息，消息处理逻辑</span><br>                <span class="hljs-comment">//接收到消息，处理逻辑...</span><br>                <span class="hljs-comment">// console.log(&quot;websocket response:&quot;,evt.data);</span><br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                console.log(<span class="hljs-string">&#x27;WebSocket: response pong msg=&#x27;</span>, evt.<span class="hljs-keyword">data</span>);<br>            &#125;<br>        &#125;;<br><br>        <span class="hljs-comment">// this.getMessage();</span><br>       <span class="hljs-comment">//连接错误</span><br>        <span class="hljs-keyword">this</span>.ws.onerror = function (err) &#123;<br>            <span class="hljs-comment">// console.log(&#x27;WebSocket:&#x27;, &#x27;connect to server error&#x27;);</span><br>            <span class="hljs-comment">//重连</span><br>            that.reconnect();<br>        &#125;;<br>        <span class="hljs-comment">//连接关闭</span><br>        <span class="hljs-keyword">this</span>.ws.onclose = function () &#123;<br>            <span class="hljs-comment">// console.log(&#x27;WebSocket:&#x27;, &#x27;connect close&#x27;);</span><br>            <span class="hljs-comment">//重连</span><br>            that.reconnect();<br>        &#125;;<br><br>        <span class="hljs-comment">//每隔15s向服务器发送一次心跳</span><br>        <span class="hljs-keyword">this</span>.timer = setInterval(() =&gt; &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.ws &amp;&amp; <span class="hljs-keyword">this</span>.ws.readyState === WebSocket.OPEN) &#123;<br>                console.log(<span class="hljs-string">&#x27;WebSocket:&#x27;</span>, <span class="hljs-string">&#x27;ping&#x27;</span>);<br>                <span class="hljs-keyword">this</span>.ws.send(<span class="hljs-string">&quot;ping&quot;</span>);<br>            &#125;<br>        &#125;, <span class="hljs-number">15000</span>);<br>    &#125;<br><br>    <span class="hljs-comment">//获取历史消息</span><br>    getMessageHistory(userId,shopId) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.ws &amp;&amp; <span class="hljs-keyword">this</span>.ws.readyState === WebSocket.OPEN) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                let params = &#123;<br>                    <span class="hljs-string">&quot;to &quot;</span>:shopId,<br>                    <span class="hljs-string">&quot;from &quot;</span>:userId<br>                &#125;;<br><br>                <span class="hljs-keyword">this</span>.ws.send(JSON.stringify(params));<br>                console.log(<span class="hljs-string">&quot;发送成功&quot;</span>)<br>            &#125; <span class="hljs-keyword">catch</span> (err) &#123;<br>                console.warn(<span class="hljs-string">&#x27;ws sendMessage&#x27;</span>, err.message);<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            console.log(<span class="hljs-string">&#x27;WebSocket:&#x27;</span>, <span class="hljs-string">&#x27;connect not open to send message&#x27;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">//发送消息</span><br>    sendMessage(msg,id) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.ws &amp;&amp; <span class="hljs-keyword">this</span>.ws.readyState === WebSocket.OPEN) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                let params = &#123;<br>                    <span class="hljs-string">&quot;cmd&quot;</span>:<span class="hljs-number">1</span>,<br>                    <span class="hljs-string">&quot;msgType&quot;</span>:msgType,<span class="hljs-comment">//0=文本 1=图片 3=视频 4=语音</span><br>                    <span class="hljs-string">&quot;to&quot;</span>:cusId,<br>                    <span class="hljs-string">&quot;from&quot;</span>:id,<br>                    <span class="hljs-string">&quot;msg&quot;</span>: msg<br>                &#125;;<br><br>                <span class="hljs-keyword">this</span>.ws.send(JSON.stringify(params));<br>            &#125; <span class="hljs-keyword">catch</span> (err) &#123;<br>                console.warn(<span class="hljs-string">&#x27;ws sendMessage&#x27;</span>, err.message);<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            console.log(<span class="hljs-string">&#x27;WebSocket:&#x27;</span>, <span class="hljs-string">&#x27;connect not open to send message&#x27;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">//重连</span><br>    reconnect() &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.timeout) &#123;<br>            clearTimeout(<span class="hljs-keyword">this</span>.timeout);<br>        &#125;<br>        <span class="hljs-keyword">this</span>.timeout = setTimeout(function () &#123;<br>            <span class="hljs-comment">//重新连接WebSocket</span><br>            that.initWebSocket(<span class="hljs-keyword">this</span>.url,<span class="hljs-keyword">this</span>.from,<span class="hljs-keyword">this</span>.to);<br>        &#125;, <span class="hljs-number">15000</span>);<br>    &#125;<br><br>    onClose()&#123;<br>       <span class="hljs-keyword">if</span>( <span class="hljs-keyword">this</span>.ws )&#123;<br>           <span class="hljs-keyword">this</span>.ws.close();<br>       &#125;<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>webSocket</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>原生js训练1</title>
    <link href="/2021/07/02/2021/2021-07/07-02%E5%8E%9F%E7%94%9F1/"/>
    <url>/2021/07/02/2021/2021-07/07-02%E5%8E%9F%E7%94%9F1/</url>
    
    <content type="html"><![CDATA[<h2 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h2><p>模拟一个打鼓的页面。用户在键盘上按下 ASDFGHJKL 这几个键时，页面上与字母对应的按钮变大变亮，对应的鼓点声音响起来。</p><h3 id="在线效果"><a href="#在线效果" class="headerlink" title="在线效果"></a>在线效果</h3><p><a href="http://soyaine.github.io/JavaScript30/01%20-%20JavaScript%20Drum%20Kit/index-SOYAINE.html">点击查看在线效果</a></p><h3 id="实列代码"><a href="#实列代码" class="headerlink" title="实列代码"></a>实列代码</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>JS Drum Kit<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;style.css&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;keys&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;65&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>A<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>clap<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;83&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>S<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>hihat<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;68&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>D<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>kick<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;70&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>F<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>openhat<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;71&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>G<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>boom<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;72&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>H<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>ride<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;74&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>J<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>snare<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;75&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>K<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>tom<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;76&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>L<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>tink<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;65&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/clap.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;83&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/hihat.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;68&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/kick.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;70&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/openhat.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;71&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/boom.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;72&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/ride.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;74&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/snare.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;75&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/tom.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;76&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/tink.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="关键要点"><a href="#关键要点" class="headerlink" title="关键要点"></a>关键要点</h2><ol><li>键盘事件</li><li>播放声音</li><li>改变样式</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>JS Drum Kit<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;style.css&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;keys&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;65&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>A<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>clap<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;83&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>S<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>hihat<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;68&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>D<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>kick<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;70&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>F<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>openhat<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;71&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>G<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>boom<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;72&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>H<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>ride<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;74&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>J<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>snare<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;75&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>K<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>tom<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;76&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;key&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">kbd</span>&gt;</span>L<span class="hljs-tag">&lt;/<span class="hljs-name">kbd</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sound&quot;</span>&gt;</span>tink<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;65&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/clap.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;83&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/hihat.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;68&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/kick.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;70&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/openhat.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;71&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/boom.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;72&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/ride.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;74&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/snare.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;75&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/tom.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">data-key</span>=<span class="hljs-string">&quot;76&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sounds/tink.wav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">removeTransition</span>(<span class="hljs-params">event</span>) &#123;</span><br><span class="language-javascript">      <span class="hljs-keyword">if</span> (event.<span class="hljs-property">propertyName</span> !== <span class="hljs-string">&#x27;transform&#x27;</span>) <span class="hljs-keyword">return</span>; <span class="hljs-comment">// 过滤其中一种事件</span></span><br><span class="language-javascript">      event.<span class="hljs-property">target</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;playing&#x27;</span>); <span class="hljs-comment">// 移除高亮的样式</span></span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">playSound</span>(<span class="hljs-params">event</span>) &#123;</span><br><span class="language-javascript">      <span class="hljs-keyword">const</span> audio = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">`audio[data-key=&quot;<span class="hljs-subst">$&#123;event.keyCode&#125;</span>&quot;]`</span>); <span class="hljs-comment">// 根据触发按键的键码，获取对应音频</span></span><br><span class="language-javascript">      <span class="hljs-keyword">const</span> key = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">`div[data-key=&quot;<span class="hljs-subst">$&#123;event.keyCode&#125;</span>&quot;]`</span>); <span class="hljs-comment">// 获取页面对应按钮 DIV 元素</span></span><br><span class="language-javascript">      <span class="hljs-keyword">if</span> (!audio) <span class="hljs-keyword">return</span>; <span class="hljs-comment">// 处理无效的按键事件</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">      key.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;playing&#x27;</span>); <span class="hljs-comment">// 改变样式</span></span><br><span class="language-javascript">      audio.<span class="hljs-property">currentTime</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// 每次播放之后都使音频播放进度归零</span></span><br><span class="language-javascript">      audio.<span class="hljs-title function_">play</span>(); <span class="hljs-comment">// 播放相应音效</span></span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;.key&#x27;</span>)); <span class="hljs-comment">// 获取页面所有按钮元素</span></span><br><span class="language-javascript">    keys.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> key.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;transitionend&#x27;</span>, removeTransition)); <span class="hljs-comment">// 添加 transition 事件监听</span></span><br><span class="language-javascript">    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;keydown&#x27;</span>, playSound);</span><br><span class="language-javascript">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原生</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>实现阅读器功能</title>
    <link href="/2021/06/16/2021/2021-06/06-16%E9%98%85%E8%AF%BB%E5%99%A8/"/>
    <url>/2021/06/16/2021/2021-06/06-16%E9%98%85%E8%AF%BB%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<h3 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h3><p>输入一段文字，将其播放。</p><ul><li>  使用相应的 WebAPI 接口获得浏览器支持的语言种类列表，并填充至页面的下拉菜单中，选择中文;</li><li>  在文本域中输入对应语言的文字，点击<code>speak</code>按钮后浏览器会阅读输入的文字；</li><li>  在浏览器阅读时，点击<code>stop</code>按钮，浏览器会停止阅读；</li><li>  拖动<code>rate</code>和<code>pitch</code>滑块可改变阅读速度和音高。</li></ul><h4 id="主要"><a href="#主要" class="headerlink" title="主要"></a>主要</h4><ul><li><code>SpeechSynthesisUtterance</code>接口<br>  本接口用于设置阅读器阅读的配置参数，包括语言，阅读速度，语调等，实例化<code>SpeechSynthesisUtterance</code>后，可以通过为其属性赋值来完成参数配置，详细信息请直接参考 MDN 中的<a href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechSynthesisUtterance">SpeechSynthesisUtterance 接口说明</a>。</li><li><code>SpeechSynthesis</code>接口<br>  本接口用于控制阅读器行为，包括获取浏览器支持的朗读语言，文本朗读，暂停，停止等，接口属性中定义有 paused,speaking 等只读属性来表明当前的状态,详细使用方式请参考 MDN 中的<a href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechSynthesis">SpeechSynthesis 接口说明</a>。</li></ul><h3 id="预览"><a href="#预览" class="headerlink" title="预览"></a>预览</h3><p><img src="/img/%E9%98%85%E8%AF%BB%E5%99%A8.png" alt="BG图片"></p><h3 id="初始代码"><a href="#初始代码" class="headerlink" title="初始代码"></a>初始代码</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Speech Synthesis<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;style.css&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;voiceinator&quot;</span>&gt;</span><br><br>      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>The Voiceinator 5000<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><br>      <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;voice&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;voices&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>Select A Voice<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br><br>      <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;rate&quot;</span>&gt;</span>Rate:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;rate&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;range&quot;</span> <span class="hljs-attr">min</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">max</span>=<span class="hljs-string">&quot;3&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">step</span>=<span class="hljs-string">&quot;0.1&quot;</span>&gt;</span><br><br>      <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;pitch&quot;</span>&gt;</span>Pitch:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br><br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;pitch&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;range&quot;</span> <span class="hljs-attr">min</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">max</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">step</span>=<span class="hljs-string">&quot;0.1&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;text&quot;</span>&gt;</span>Hello! I love JavaScript 馃憤<span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;stop&quot;</span>&gt;</span>Stop!<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;speak&quot;</span>&gt;</span>Speak<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="实例代码"><a href="#实例代码" class="headerlink" title="实例代码"></a>实例代码</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Speech Synthesis<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;style.css&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;voiceinator&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>听说 5000<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;voice&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;voices&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>Select A Voice<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;rate&quot;</span>&gt;</span>Rate:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;rate&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;range&quot;</span> <span class="hljs-attr">min</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">max</span>=<span class="hljs-string">&quot;3&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">step</span>=<span class="hljs-string">&quot;0.1&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;pitch&quot;</span>&gt;</span>Pitch:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;pitch&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;range&quot;</span> <span class="hljs-attr">min</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">max</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">step</span>=<span class="hljs-string">&quot;0.1&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;text&quot;</span>&gt;</span>Hello! I love JavaScript 👍<span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;stop&quot;</span>&gt;</span>Stop!<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;speak&quot;</span>&gt;</span>Speak<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">  <span class="hljs-keyword">const</span> synth = <span class="hljs-variable language_">window</span>.<span class="hljs-property">speechSynthesis</span>;</span><br><span class="language-javascript">  <span class="hljs-keyword">let</span> voices = [];</span><br><span class="language-javascript">  <span class="hljs-keyword">const</span> msg = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SpeechSynthesisUtterance</span>();</span><br><span class="language-javascript">  <span class="hljs-keyword">const</span> voicesDropdown = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;[name=&quot;voice&quot;]&#x27;</span>);</span><br><span class="language-javascript">  <span class="hljs-keyword">const</span> options = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;[type=&quot;range&quot;], [name=&quot;text&quot;]&#x27;</span>);</span><br><span class="language-javascript">  <span class="hljs-keyword">const</span> speakButton = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#speak&#x27;</span>);</span><br><span class="language-javascript">  <span class="hljs-keyword">const</span> stopButton = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#stop&#x27;</span>);</span><br><span class="language-javascript">  msg.<span class="hljs-property">text</span> = <span class="hljs-string">&#x27;你能说中文吗&#x27;</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">  <span class="hljs-comment">//获得浏览器支持的阅读语言并填充至下拉列表</span></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getSupportVoice</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">  voices = synth.<span class="hljs-title function_">getVoices</span>();</span><br><span class="language-javascript">  <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; voices.<span class="hljs-property">length</span> ; i++) &#123;</span><br><span class="language-javascript">    <span class="hljs-keyword">var</span> option = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;option&#x27;</span>);</span><br><span class="language-javascript">    option.<span class="hljs-property">textContent</span> = voices[i].<span class="hljs-property">name</span> + <span class="hljs-string">&#x27; (&#x27;</span> + voices[i].<span class="hljs-property">lang</span> + <span class="hljs-string">&#x27;)&#x27;</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">if</span>(voices[i].<span class="hljs-property">default</span>) &#123;</span><br><span class="language-javascript">      option.<span class="hljs-property">textContent</span> += <span class="hljs-string">&#x27; -- DEFAULT&#x27;</span>;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">    option.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;data-lang&#x27;</span>, voices[i].<span class="hljs-property">lang</span>);</span><br><span class="language-javascript">    option.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;data-name&#x27;</span>, voices[i].<span class="hljs-property">name</span>);</span><br><span class="language-javascript">    voicesDropdown.<span class="hljs-title function_">appendChild</span>(option);</span><br><span class="language-javascript">  &#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-comment">//点击speak按钮时阅读文字</span></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">speak</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(voicesDropdown.<span class="hljs-property">value</span>);</span><br><span class="language-javascript">  synth.<span class="hljs-title function_">speak</span>(msg);</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-comment">//阅读参数发生变化</span></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">paramChange</span>(<span class="hljs-params"></span>)&#123;</span><br><span class="language-javascript">  msg[<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;</span><br><span class="language-javascript">  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-comment">//停止阅读</span></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">stopSpeak</span>(<span class="hljs-params"></span>)&#123;</span><br><span class="language-javascript">  synth.<span class="hljs-title function_">cancel</span>();</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-comment">// 事件绑定</span></span><br><span class="language-javascript">options.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">opt</span> =&gt;</span> opt.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;change&#x27;</span>, paramChange));</span><br><span class="language-javascript">synth.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;voiceschanged&#x27;</span>, getSupportVoice);<span class="hljs-comment">//经测试直接执行无效，须由事件触发</span></span><br><span class="language-javascript">speakButton.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, speak);</span><br><span class="language-javascript">stopButton.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, stopSpeak);</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原生</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>防抖/节流</title>
    <link href="/2021/06/16/2021/2021-06/06-16%E9%98%B2%E6%8A%96%E8%8A%82%E6%B5%81/"/>
    <url>/2021/06/16/2021/2021-06/06-16%E9%98%B2%E6%8A%96%E8%8A%82%E6%B5%81/</url>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>防抖和节流是针对响应跟不上触发频率这类问题的两种解决方案。例如：滚动滚动条事件 onscroll，窗口大小改变事件 onresize onclick 防击穿，在实时检查输入时，如果我们绑定 onkeyup 事件发请求去服务端检查，用户输入过程中，事件的触发频率也会很高，会导致大量的请求发出，响应速度会大大跟不上触发等 这些应用场景 我们都可以用上。</p><h3 id="防抖"><a href="#防抖" class="headerlink" title="防抖"></a>防抖</h3><p>周期内多次触发事件，周期时间内动作只会执行一次，我们只是用最后一次的操作结果。使用定义 timeout 再次触发就清除之前的时间，取消之前的操作动作。 类似于，打游戏时的法师吟唱效果，有其他操作就会打断施法动作。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@desc</span> 函数防抖</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> func (function) 函数</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> wait (number) 延迟执行毫秒数</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> immediate (boolean) true 表立即执行，false 表非立即执行</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">debounce</span>(<span class="hljs-params">func, wait = <span class="hljs-number">1000</span>, immediate</span>) &#123;<br>    <span class="hljs-keyword">var</span> timeout<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">var</span> context = <span class="hljs-variable language_">this</span><br>        <span class="hljs-keyword">var</span> args = <span class="hljs-variable language_">arguments</span><br>        <span class="hljs-keyword">if</span> (timeout) <span class="hljs-built_in">clearTimeout</span>(timeout)<br>        <span class="hljs-keyword">if</span> (immediate) &#123;<br>            <span class="hljs-keyword">var</span> callNow = !timeout<br>            timeout = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>                timeout = <span class="hljs-literal">null</span><br>            &#125;, wait)<br>            <span class="hljs-keyword">if</span> (callNow) func.<span class="hljs-title function_">apply</span>(context, args)<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            timeout = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>                func.<span class="hljs-title function_">apply</span>(context, args)<br>            &#125;, wait)<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="节流"><a href="#节流" class="headerlink" title="节流"></a>节流</h3><p>连续高频触发事件时，动作会被定期执行，规定时间内，动作只执行一次，响应平滑。 类似于，打游戏时的普攻，无论我们点击再快，受到游戏数据影响，都只会规定的速度进行攻击</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs typescript"> * <span class="hljs-meta">@desc</span> 函数节流<br> * <span class="hljs-meta">@param</span> func (<span class="hljs-keyword">function</span>) 函数<br> * <span class="hljs-meta">@param</span> wait (<span class="hljs-built_in">number</span>) 延迟执行毫秒数<br> */<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">throttle</span>(<span class="hljs-params">func, wait</span>) &#123;<br>    <span class="hljs-keyword">var</span> timeout;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">var</span> context = <span class="hljs-variable language_">this</span>;<br>        <span class="hljs-keyword">var</span> args = <span class="hljs-variable language_">arguments</span>;<br>        <span class="hljs-keyword">if</span> (!timeout) &#123;<br>            timeout = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>                timeout = <span class="hljs-literal">null</span>;<br>                func.<span class="hljs-title function_">apply</span>(context, args)<br>            &#125;, wait)<br>        &#125;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>工具函数</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>顶</title>
    <link href="/2021/05/25/2021/2021-06/05-25%E9%A1%B6/"/>
    <url>/2021/05/25/2021/2021-06/05-25%E9%A1%B6/</url>
    
    <content type="html"><![CDATA[<h1 id="MD-上手指南"><a href="#MD-上手指南" class="headerlink" title="MD 上手指南"></a>MD 上手指南</h1><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs clean"># 一级标签 &gt; &lt;h1&gt;一级标签&lt;/h1&gt;<br>## 二级标签 &gt; &lt;h2&gt;一级标签&lt;/h2&gt;<br>### 三级标签 &gt; &lt;h3&gt;一级标签&lt;/h3&gt;<br>#### 四级标签 &gt; &lt;h4&gt;一级标签&lt;/h4&gt;<br>##### 五级标签 &gt; &lt;h5&gt;一级标签&lt;/h5&gt;<br></code></pre></td></tr></table></figure><h1 id="一级标签"><a href="#一级标签" class="headerlink" title="一级标签"></a>一级标签</h1><h2 id="二级标签"><a href="#二级标签" class="headerlink" title="二级标签"></a>二级标签</h2><h3 id="三级标签"><a href="#三级标签" class="headerlink" title="三级标签"></a>三级标签</h3><h4 id="四级标签"><a href="#四级标签" class="headerlink" title="四级标签"></a>四级标签</h4><h5 id="五级标签"><a href="#五级标签" class="headerlink" title="五级标签"></a>五级标签</h5><h3 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h3><h4 id="无序"><a href="#无序" class="headerlink" title="无序"></a>无序</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">*</span> 1                             · 1<br><span class="hljs-bullet">+</span> 1            &gt; 预览            · 1<br><span class="hljs-bullet">-</span> 1                             · 1<br></code></pre></td></tr></table></figure><h4 id="有序"><a href="#有序" class="headerlink" title="有序"></a>有序</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>. 列表                            <span class="hljs-number">1</span>. 列表<br><span class="hljs-attribute">2</span>. 列表            &gt; 预览          <span class="hljs-number">2</span>. 列表<br><span class="hljs-attribute">3</span>. 列表                            <span class="hljs-number">3</span>. 列表<br></code></pre></td></tr></table></figure><h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs node-repl"><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript">这是一段引用数据</span><br></code></pre></td></tr></table></figure><blockquote><p>这是一段引用数据</p></blockquote><h3 id="分割线"><a href="#分割线" class="headerlink" title="分割线"></a>分割线</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-section">***</span><br><span class="hljs-section">---</span><br></code></pre></td></tr></table></figure><h3 id="超链接-图片"><a href="#超链接-图片" class="headerlink" title="超链接/图片"></a>超链接/图片</h3><p><code>[BG 超链接](/img/default.jpg)</code><br><a href="/img/1.jpg">BG 超链接</a></p><p><code>![BG图片](/img/default.jpg)</code><br><img src="/img/1.jpg" alt="BG图片"></p><h3 id="表格"><a href="#表格" class="headerlink" title="表格"></a>表格</h3><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">|<span class="hljs-string"> 项目        </span>|<span class="hljs-string"> 价格    </span>|<span class="hljs-string">  数量   </span>|<br>|<span class="hljs-string"> --------    </span>|<span class="hljs-string"> -----: </span>|<span class="hljs-string"> :----:  </span>|<br>|<span class="hljs-string"> 掉闹        </span>|<span class="hljs-string"> \$1600  </span>|<span class="hljs-string">   5    </span>|<br>|<span class="hljs-string"> 手机        </span>|<span class="hljs-string">   \$12  </span>|<span class="hljs-string">   12   </span>|<br>|<span class="hljs-string"> 鼠标        </span>|<span class="hljs-string">    \$1  </span>|<span class="hljs-string">   34   </span>|<br><br>: 是对齐方向<br></code></pre></td></tr></table></figure><table><thead><tr><th>项目</th><th align="right">价格</th><th align="center">数量</th></tr></thead><tbody><tr><td>掉闹</td><td align="right">$1600</td><td align="center">5</td></tr><tr><td>手机</td><td align="right">$12</td><td align="center">12</td></tr><tr><td>鼠标</td><td align="right">$1</td><td align="center">34</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>MD</category>
      
    </categories>
    
    
    <tags>
      
      <tag>配置</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
