---
title: element表格简易封装
date: 2022-09-22 21:10:05
tags: vue
category: Element
---

### 实现效果

实现 table 表格的简单封装 带操作栏的（slot）、可多选的表格 [slot](https://v2.cn.vuejs.org/v2/api/#slot)
![](/img/2022_bg1.png)

#### 封装组件

```
<template>
    <div>
        <ez-table
            class="tab-ml-30"
            :header-cell-style="{ background: '#F8F8F8' }"
            :data="tabData"
            ref="tableData"
            style="width: 100%"
            max-height="400"
            @selection-change="handleSelectionChange"
        >
            >
            <ez-table-column
                v-if="indexShow"
                label="序号"
                type="index"
                width="50"
            >
            </ez-table-column>
            <ez-table-column
                v-if="selShow"
                type="selection"
                :selectable="selectTabFn"
                width="50"
            >
            </ez-table-column>
            <ez-table-column
                v-if="operateShow"
                label="操作"
                width="200"
                align="center"
            >

                <template slot-scope="scope">
				   //默认插槽展示operate
                    <slot v-bind="scope"></slot>
                </template>
            </ez-table-column>
            <template v-for="(item, index) in titles">
                <ez-table-column
                    v-if="item.stacks"
                    align="center"
                    :label="item.label"
                    :key="'GTba' + index"
                >
                    <template v-for="(child, childIndex) in item.stacks">
                        <ez-table-column
                            :prop="child.prop"
                            align="center"
                            show-overflow-tooltip
                            :width="child.width || ''"
                            :label="child.label"
                            :key="'GTbaChild' + childIndex"
                        ></ez-table-column>
                    </template>
                </ez-table-column>
                <ez-table-column
                    v-else
                    :prop="item.prop"
                    align="center"
                    show-overflow-tooltip
                    :width="item.width || ''"
                    :label="item.label"
                    :key="'GTba' + index"
                >
				   //具名插槽用来展示自定义项数据
                    <template slot-scope="scope">
                        <slot
                            v-if="item.deal"
                            :name="item.prop"
                            v-bind="scope"
                        ></slot>
                        <span v-else>{{ scope.row[item.prop] }}</span>
                    </template>
                </ez-table-column>
            </template>
        </ez-table>
        // 因为更利于复用组件 将页码进行了封装
        <Pagination
            v-if="pageInfo.totalCount && pageShow"
            @onPageChange="onPageChange"
            @onSizeChange="onSizeChange"
            :pageInfo="pageInfo"
        ></Pagination>
    </div>
</template>
<script>
export default {
    /**
     * pageInfo 页码 pageNum页数  pageSize 数量 totalCount 总数
     * pageShow  页码显示
     * tabData 表格数据
     * titles 表头依赖数据  label名字 prop显示源 stacks 二级表头数据
     * operateShow 是否需要操作栏 // 这边也可以用$slots.default 做判断
     * selShow 多选
     * selFnShow 是否添加 某项是否可选择
     * @selectTabFn  selections 过滤 需要在父组件配置 返回fasle/true
     *  默认插槽展示operate 具名插槽用来展示自定义项数据
     */
    data() {
        return {
        };
    },
    props: {
        pageInfo: {
            type: Object,
            default: () => {
                return {
                    pageNum: 1,
                    pageSize: 10,
                    totalCount: 0,
                };
            },
        },
        pageShow: {
            type: Boolean,
            default: true,
        },
        selShow: {
            type: Boolean,
            default: false,
        },
        selFnShow: {
            type: Boolean,
            default: false,
        },
        operateShow: {
            type: Boolean,
            default: false,
        },
        tabData: {
            type: Array,
            default: () => [],
        },
        titles: {
            type: Array,
            default: () => {},
        },
        indexShow: {
            type: Boolean,
            default: false,
        },
    },
    methods: {
        onPageChange(val) {
            this.$emit('onPageChange', val);
        },
        onSizeChange(val) {
            this.$emit('onSizeChange', val);
        },
        handleSelectionChange(val) {
            this.$emit('selectChange', val);
        },
        selectTabFn(row, index) {
            if (!this.selFnShow) return true;
			   // 需要父组件提供select方法对每一项数据做可选控制 false 不可选 true可选
            return this.$parent.selectTabFn(row, index);
        },
    },
};
</script>
<style lang="scss" scoped>
</style>
```

#### 父组件中调用

```
    <Gtable
        :titles="titles"
        :tabData="tabData"
        @onPageChange="onPageChange"
        @onSizeChange="onSizeChange"
        :pageInfo="pageInfo"
        operateShow
    >
        <template slot-scope="scope">
            <ez-button size="mini" @click="handleEdit(scope)"
                >Edit</ez-button
            >
            <ez-button
                size="mini"
                type="danger"
                @click="handleEdit(scope.$index, scope.row)"
                >Delete</ez-button
            >
        </template>
        <template slot="ysxmSf" slot-scope="scope">
            {{ scope.row.prop }}
        </template>
    </Gtable>
	// 提供data 数据
	  titles: [ //表头数据 stacks二级表头
	    { prop: 'xm', label: '姓名' },
	    { prop: 'zjhm', label: '身份证', width: '200' },
	    { prop: 'jgmc', label: '管理社区', width: '150' },
	    { prop: 'gldxlx', label: '病种', width: '120' },
	    { prop: 'sfrq', label: '随访日期' },
	    {prop: 'glztGlk', label: '管理卡状态', width: '100' },
	    { prop: 'glztSfk', label: '随访卡状态' },
	    { prop: 'ysxmZr', label: '责任医生' },
	    { prop: 'ysxmSf', deal: true, label: '随访医生' },
	    { prop: 'lczz', label: '糖尿病患者临床状态', width: '150' },
	    {
	        prop: 'sfrq',
	        label: '足背动脉搏动',
	        stacks: [
	            {prop: 'jcrq', label: '检查日期', width: '120' },
	            { prop: 'zbdmbdZ', label: '左足' },
	            { prop: 'zbdmbdY', label: '右足' },
	        ],
	    },
	    ],
	tabData:[],表格数据
	pageInfo: {//页码
	    totalCount: 0,
	    pageNum: 1,
	    pageSize: 10,
	},
```

##### 页码封装

```
        <ez-pagination
            @size-change="handleSizeChange"
            @current-change="handleCurrentPageChange"
            :current-page="pageInfo.pageNum"
            :page-sizes="[ 10, 20, 50, 200]"
            :page-size="pageInfo.pageSize"
            layout="total, sizes, prev, pager, next, jumper"
            :total="pageInfo.totalCount"
        >
        </ez-pagination>


props: {
    pageInfo: {
        type: Object,
        default: () => {
            return {
                pageNum: 1,
                pageSize: 10,
                totalCount: 0,
            };
        },
    },
},


methods: {
    handleCurrentPageChange(val) {
        this.$emit('onPageChange', val);
    },
    handleSizeChange(val) {
        this.$emit('onSizeChange', val);
    },
},
```

![BG图片](/img/1.jpg)
