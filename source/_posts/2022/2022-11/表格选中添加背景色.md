---
title: 表格选中添加背景色
date: 2022-11-28 19:17:18
tags: Element
category: vue
---

## 需求

       今天有个小伙伴问我一个需求，迭代需要给表格点击项单元格添加背景色功能。vue + element架构。
	   了解了一下，他的想法当是当点击某个单元格的时候，获取当前 dom ，添加样式。后来写了很多代码，实现效果不好，添加和移除的时候不太行。
	   听完他的设计方案，我想的是功能不难做，只是小伙伴掉入了他自己的思想误区。
		 
   
##  实现方案
   1. 首先 Vue MVVM设计模式，本身是以数据驱动视图的实现方式，我们只需要关心数据的逻辑处理，数据的变化就能够自然的通知页面进行页面的重新渲染。
   2. 那么功能就很好做了，element table 组件排列是有对应的 row/column数据，利用slot 获取信息 
   3. 单击某个单元格 。获取点击的对应单元格的 xy信息，与之比对，true/false 添加样式/移除
   
### 代码实现
```
<el-table
            :data="tableData"
            @cell-click="handler"
            border
            style="width: 100%"
        >
            <el-table-column prop="date" label="日期" width="180">
                <template slot-scope="scope">
                    <div
                        :class="
                            scope.$index === xIndex &&
                            scope.column.index === yIndex
                                ? 'bg'
                                : ''
                        "
                    >
                        {{ scope.row.date }}
                    </div>
                </template>
            </el-table-column>
            <el-table-column prop="name" label="姓名" width="180">
                <template slot-scope="scope">
                    <div
                        :class="
                            scope.$index === xIndex &&
                            scope.column.index === yIndex
                                ? 'bg'
                                : ''
                        "
                    >
                        {{ scope.row.name }}
                    </div>
                </template>
            </el-table-column>
            <el-table-column prop="address" label="地址">
                <template slot-scope="scope">
                    <div
                        :class="
                            scope.$index === xIndex &&
                            scope.column.index === yIndex
                                ? 'bg'
                                : ''
                        "
                    >
                        {{ scope.row.address }}
                    </div>
                </template>
            </el-table-column>
        </el-table>
		
 data() {
        return {
            tableData: [
                {
                    date: '2016-05-02',
                    name: '王小虎',
                    address: '上海市普陀区金沙江路 1518 弄',
                },
                {
                    date: '2016-05-04',
                    name: '王小虎',
                    address: '上海市普陀区金沙江路 1517 弄',
                },
                {
                    date: '2016-05-01',
                    name: '王小虎',
                    address: '上海市普陀区金沙江路 1519 弄',
                },
                {
                    date: '2016-05-03',
                    name: '王小虎',
                    address: '上海市普陀区金沙江路 1516 弄',
                },
            ],
            xIndex: '',
            yIndex: '',
        };
    },	
	methods: {
	        handler(row, column, cell, event) {
				   console.log(row[column.property], row);
				   console.log(row[column.property], column);
				   console.log(row[column.property], cell);
				   console.log(row[column.property], event);
	        },
	       
	    },
<style >

.bg {
    background-color: orange;
}
</style>
```
![bjs_2](/img/2022/bjs_1.png)
 ###### 打印的四个数据中后两个是节点信息 
![bjs_2](/img/2022/bjs_2.png)
![bjs_2](/img/2022/bjs_3.png)

 ###### 前两个是我们需要用的信息 并且有cloSpan/rowSpan 这是不是需要用的数据，仔细看并不难发现不是响应值，并且值都一样这里面好像没有用的数据
 
## 第三步，单击某个单元格 。获取点击的对应单元格的 xy信息 并不能直接获取到，
   1. 怎么获取table 索引 x/y数据 
   ![bjs_2](/img/2022/bjs_4.png)
   table提供了这个可以获取组件rowIndex/columnIndex 
  ```
  <el-table
      :data="tableData"
      @cell-click="handler"
      border
      style="width: 100%"
	   :cell-class-name="className"
  >
  
  
   handler(row, column, cell, event) {
              this.xIndex = row.index;
              this.yIndex = column.index;
          },
   className({ row, column, rowIndex, columnIndex }) {
              console.log(
                  row[column.property],
                  row,
                  column,
                  rowIndex,
                  columnIndex
              );
			  // 将获取到的x/y 数据信息存储
              row.index = rowIndex;
              column.index = columnIndex;
          },
  
  ```
![bjs_2](/img/2022/bjs_5.png)
## 点击背景色加上。功能实现
![bjs_2](/img/2022/bjs_6.png)

