---
title: 响应原理
date: 2021-08-27 21:10:28
tags: Vue
category: Vue
---

### 认识 Object.defineProperty()

Object.defineProperty() 方法会直接在一个对象上定义一个新属性，或者修改一个对象的现有属性，并返回此对象。

```
//语法
// Object.defineProperty('修改的对象','要修改的参数(key/index)','修改为的值')

Object.defineProperty(object1, 'property1', {
  value: '',
  writable: true, // 可更换，重写
  configurable:true, // 可配置，可删除
  enumerable:true, //可枚举
  get:fn, //函数 获取
  set:fn, //函数 设置
});

// 使用方式

let obj = {
    name: '张三',
};
  let _age = '';
Object.defineProperty(obj, 'age', {
    configurable: true,
    set(newVal) {
        _age = newVal
    },
    get() {
        return _age
    }
})

```

### VUE 中的使用场景

```
//简化的Vue defineReactive (只有一层data)
function defineReactive(target, key, value, enumerable) {
    //函数内部是一个局部作用域，这个value就是在函数内部使用（闭包）
    Object.defineProperty(target, key, {
        configurable: true,
        enumerable: !!enumerable,
        get() {
            console.log('获取对象' + key + '的值');
            return value;
        },
        set(newVal) {
            console.log(`设置对象${key},值为${newVal}`);
            value = newVal;
        },
    })
};
// 使用将对象转换为响应式
let keys = Object.keys(obj);
for (let i = 0; i < keys.length; i++) {
    defineProperty(obj, keys[i], obj[keys[i]], true)
}

```

(笔记)
![BG图片](/img/1.jpg)
